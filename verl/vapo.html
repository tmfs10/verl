<!DOCTYPE html>
<!-- saved from url=(0033)https://arxiv.org/html/2504.05118 -->
<html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks</title>
<!--Generated on Fri Apr 11 02:56:42 2025 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on April 11, 2025.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<link href="./vapo_files/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="./vapo_files/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="./vapo_files/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css">
<link href="./vapo_files/latexml_styles.css" rel="stylesheet" type="text/css">
<script src="./vapo_files/bootstrap.bundle.min.js"></script>
<script src="./vapo_files/html2canvas.min.js"></script>
<script src="./vapo_files/addons_new.js"></script>
<script src="./vapo_files/feedbackOverlay.js"></script>
<!--<base href="/html/2504.05118v3/">--><base href="."><link rel="stylesheet" href="./vapo_files/utz6mli.css"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="https://static.arxiv.org/static/browse/0.3.4/images/icons/favicon-32x32.png" sizes="32x32"></head>
<body><header class="mob_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
        <img alt="logo" class="logomark" role="presentation" width="100" src="./vapo_files/arxiv-logomark-small-white.svg">
        <span class="sr-only">Back to arXiv</span>
      </a>
    </div>

    <!--TOC, dark mode, links-->
    <div class="html-header-nav">
      <!--back to abstract-->
      
        <a class="nav-link ar5iv-footer-button hover-effect" aria-label="Back to abstract page" href="https://arxiv.org/abs/2504.05118">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 512 512" fill="#ffffff" aria-hidden="true">
            <path d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"></path>
        </svg>
        </a>
      <!--dark mode-->
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode" aria-label="System preference">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        <label id="light-tog" class="toggle-icon" title="Switch to dark mode" for="__palette_1" hidden="">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
        </label>
        <label id="dark-tog" class="toggle-icon" title="Switch to system preference" for="__palette_2" hidden="">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
        </label>
      </a>
      <!--nav-->
      <button class="navbar-toggler ar5iv-footer-button" type="button" data-bs-theme="dark" data-bs-toggle="collapse" aria-expanded="false" data-bs-target=".ltx_page_main &gt;.ltx_TOC.mobile" aria-controls="navbarSupportedContent" aria-label="Toggle navigation" style="border:none; margin-right: 0em;">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.25em" viewBox="0 0 448 512" aria-hidden="true" role="img" fill="#ffffff"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg>
      </button>
    </div>
    </header><header class="desktop_header">
    <div class="html-header-logo">
      <a href="https://arxiv.org/">
          <img alt="logo" class="logo" role="presentation" width="100" src="./vapo_files/arxiv-logo-one-color-white.svg">
          <span class="sr-only">Back to arXiv</span>
      </a>
    </div>
    <div class="html-header-message" role="banner">
        <p>This is <strong>experimental HTML</strong> to improve accessibility. We invite you to report rendering errors. <span class="sr-only">Use Alt+Y to toggle on accessible reporting links and Alt+Shift+Y to toggle off.</span> Learn more <a href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">about this project</a> and <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">help improve conversions</a>.
        </p>
    </div>
    <nav class="html-header-nav">
      <a class="ar5iv-footer-button hover-effect" href="https://info.arxiv.org/about/accessible_HTML.html" target="_blank">Why HTML?</a>
      <a class="ar5iv-footer-button hover-effect" target="_blank" href="https://arxiv.org/html/2504.05118v3/#myForm" onclick="event.preventDefault(); var modal = document.getElementById(&#39;myForm&#39;); modal.style.display = &#39;block&#39;; bugReportState.setInitiateWay(&#39;Header&#39;);">Report Issue</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/abs/2504.05118v3">Back to Abstract</a>
      <a class="ar5iv-footer-button hover-effect" href="https://arxiv.org/pdf/2504.05118v3" target="_blank">Download PDF</a>
      <a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle dark/light mode">
        <label id="automatic-tog" class="toggle-icon" title="Switch to light mode" for="__palette_3">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
        </label>
        <label id="light-tog" class="toggle-icon" title="Switch to dark mode" for="__palette_1" hidden="">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
        </label>
        <label id="dark-tog" class="toggle-icon" title="Switch to system preference" for="__palette_2" hidden="">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
        </label>
      </a>
    </nav></header>

<div class="ltx_page_main" id="main">
<nav class="ltx_TOC active" aria-labelledby="toc_header"><h2 id="toc_header" class="sr-only">Table of Contents</h2>

      <div id="listIcon" type="button" class="hide">
          <svg width="17px" height="17px" viewBox="0 0 512 512" style="pointer-events: none;">
          <path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"></path>
          </svg>
      </div>
      <div id="arrowIcon" type="button">
          <svg width="17px" height="17px" viewBox="0 0 448 512" style="pointer-events: none;">
          <path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path>
          </svg>
      </div><ol class="ltx_toclist"><li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2504.05118#abstract" title="Abstract">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        Abstract
      </span>
    </a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S1" title="In VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S2" title="In VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S2.SS1" title="In 2 Preliminaries ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Modeling Language Generation as Token-Level MDP</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S2.SS2" title="In 2 Preliminaries ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>RLHF Learning Objective</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S2.SS3" title="In 2 Preliminaries ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Proximal Policy Optimization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S3" title="In VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Challenges in Long-CoT RL for Reasoning Tasks</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S3.SS1" title="In 3 Challenges in Long-CoT RL for Reasoning Tasks ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Value Model Bias over Long Sequences</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S3.SS2" title="In 3 Challenges in Long-CoT RL for Reasoning Tasks ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Heterogeneous Sequence Lengths during Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S3.SS3" title="In 3 Challenges in Long-CoT RL for Reasoning Tasks ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Sparsity of Reward Signal in Verifier-based Tasks</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S4" title="In VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>VAPO: Addressing the Challenges in Long-CoT RL</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S4.SS1" title="In 4 VAPO: Addressing the Challenges in Long-CoT RL ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Mitigating Value Model Bias over Long Sequences</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S4.SS2" title="In 4 VAPO: Addressing the Challenges in Long-CoT RL ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Managing Heterogeneous Sequence Lengths during Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S4.SS3" title="In 4 VAPO: Addressing the Challenges in Long-CoT RL ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Dealing with Sparsity of Reward Signal in Verifier-based Tasks</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S5" title="In VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S5.SS1" title="In 5 Experiments ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Training Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S5.SS2" title="In 5 Experiments ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Ablation Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S5.SS3" title="In 5 Experiments ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Training Dynamics</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S6" title="In VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S7" title="In VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
    <a class="ltx_ref" href="https://arxiv.org/html/2504.05118#bib" title="References">
      <span class="ltx_text ltx_ref_title">
        <span class="ltx_tag ltx_tag_ref"></span>
        References
      </span>
    </a></li></ol></nav>

<div class="ltx_page_content"><div class="package-alerts ltx_document" role="status" aria-label="Conversion errors have been found">
      <button aria-label="Dismiss alert" onclick="closePopup()">
          <span aria-hidden="true"><svg role="presentation" width="20" height="20" viewBox="0 0 44 44" aria-hidden="true" focusable="false">
          <path d="M0.549989 4.44999L4.44999 0.549988L43.45 39.55L39.55 43.45L0.549989 4.44999Z"></path>
          <path d="M39.55 0.549988L43.45 4.44999L4.44999 43.45L0.549988 39.55L39.55 0.549988Z"></path>
          </svg></span>
      </button>
      <p>HTML conversions <a href="https://info.dev.arxiv.org/about/accessibility_html_error_messages.html" target="_blank">sometimes display errors</a> due to content that did not convert correctly from the source. This paper uses the following packages that are not yet supported by the HTML conversion tool. Feedback on these issues are not necessary; they are known and are being worked on.</p>
          <ul arial-label="Unsupported packages used in this paper">
              <li>failed: minitoc</li>
          </ul>
      <p>Authors: achieve the best HTML results from your LaTeX submissions by following these <a href="https://info.arxiv.org/help/submit_latex_best_practices.html" target="_blank">best practices</a>.</p>
    </div><div id="target-section" class="section"><a id="license-tr" href="https://info.arxiv.org/help/license/index.html#licenses-available">License: arXiv.org perpetual non-exclusive license</a><div id="watermark-tr">arXiv:2504.05118v3 [cs.AI] 11 Apr 2025</div></div>
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">]ByteDance Seed
<span class="ltx_ERROR undefined" id="p1.1.1">\contribution</span>Full author list in Contributions</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<h1 class="ltx_title ltx_title_document">VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks </h1><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_dates">(April 11, 2025)</div>
<div class="ltx_abstract" id="abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<p class="ltx_p" id="id1.1">We present VAPO, <span class="ltx_text ltx_font_bold" id="id1.1.1">V</span>alue-model-based <span class="ltx_text ltx_font_bold" id="id1.1.2">A</span>ugmented Proximal <span class="ltx_text ltx_font_bold" id="id1.1.3">P</span>olicy <span class="ltx_text ltx_font_bold" id="id1.1.4">O</span>ptimization framework for reasoning models., a novel framework tailored for reasoning models within the value-model-based paradigm. Benchmarked the AIME 2024 dataset, VAPO, built on the Qwen 32B pre-trained model, attains a state-of-the-art score of <math alttext="\mathbf{60.4}" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mn class="ltx_mathvariant_bold" id="id1.1.m1.1.1" mathvariant="bold" xref="id1.1.m1.1.1.cmml">60.4</mn><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><cn id="id1.1.m1.1.1.cmml" type="float" xref="id1.1.m1.1.1">60.4</cn></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">\mathbf{60.4}</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">bold_60.4</annotation></semantics></math>. In direct comparison under identical experimental settings, VAPO outperforms the previously reported results of DeepSeek-R1-Zero-Qwen-32B and DAPO by more than 10 points. The training process of VAPO stands out for its stability and efficiency. It reaches state-of-the-art performance within a mere 5,000 steps. Moreover, across multiple independent runs, no training crashes occur, underscoring its reliability. This research delves into long chain-of-thought (long-CoT) reasoning using a value-model-based reinforcement learning framework. We pinpoint three key challenges that plague value-model-based methods: value model bias, the presence of heterogeneous sequence lengths, and the sparsity of reward signals. Through systematic design, VAPO offers an integrated solution that effectively alleviates these challenges, enabling enhanced performance in long-CoT reasoning tasks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">\correspondence</span>
<p class="ltx_p" id="p2.2">Yu Yue at 
<span class="ltx_text" id="p2.2.1" lang="en"></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<figure class="ltx_figure" id="S0.F1" lang="en"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="204" id="S0.F1.g1" src="./vapo_files/score.png" width="509">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S0.F1.3.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S0.F1.4.2" style="font-size:90%;">AIME 2024 scores of <span class="ltx_text ltx_font_bold" id="S0.F1.4.2.1">VAPO</span> on the Qwen2.5-32B base model, demonstrates significant superiority over the previous state-of-the-art (SOTA) method DAPO, achieving this with notably fewer training steps. The x-axis denotes the gradient update steps.
</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_section" id="S1" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Reasoning models&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib26" title="">26</a>]</cite> such as OpenAI O1 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib16" title="">16</a>]</cite> and DeepSeek R1 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib6" title="">6</a>]</cite> have significantly advanced artificial intelligence by exhibiting remarkable performance in complex tasks such as mathematical reasoning, which demand step-by-step analysis and problem-solving through long chain-of-thought (CoT)&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib27" title="">27</a>]</cite> at test time.
Reinforcement learning (RL) plays a pivotal role in the success of these models&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib24" title="">24</a>]</cite>. It gradually enhances the model’s performance by continuously exploring reasoning paths toward correct answers on verifiable problems, achieving unprecedented reasoning capabilities.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In the Large Language Models (LLM)&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib4" title="">4</a>]</cite> RL training, value-model-free methods like GRPO&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib22" title="">22</a>]</cite> and DAPO&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib29" title="">29</a>]</cite> have demonstrated remarkable effectiveness. These approaches eliminate the computational overhead of learning a value model, instead computing advantage solely based on the final reward of the entire trajectory. The trajectory-level advantage is then directly assigned as the token-level advantage for each position in the sequence. When training a reliable value model is particularly challenging, value-model-free methods deliver an accurate and stable baseline for advantage calculation by averaging the rewards across multiple trajectories within a group. This group-based reward aggregation mitigates the need for explicit value estimation, which often suffers from instability in complex tasks. Consequently, value-model-free methods have gained significant traction in addressing difficult problems such as long-CoT reasoning, with substantial research efforts focused on optimizing their frameworks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Despite the notable success achieved by the value-model-free methods, we argue that value-model-based approaches possess a higher performance ceiling if the challenges in training value models can be addressed. First, value models enable more precise credit assignment by accurately tracing the impact of each action on subsequent returns, facilitating finer-grained optimization&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib21" title="">21</a>]</cite>. This is particularly critical for complex reasoning tasks, where subtle errors in individual steps often lead to catastrophic failures, and it remains challenging for model optimizing under value-model-free frameworks&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib30" title="">30</a>]</cite>. Secondly, in contrast to the advantage estimates derived from Monte Carlo methods in value-model-free approaches, value models can provide lower-variance value estimates for each token, thereby enhancing training stability. Furthermore, a well-trained value model exhibits inherent generalization capabilities, enabling more efficient utilization of samples encountered during online exploration. This significantly elevates the optimization ceiling of reinforcement learning algorithms. Consequently, despite the formidable challenges in training value models for complex problems, the potential benefits of overcoming these difficulties are substantial.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">However, training a perfect value model in Long COT tasks presents significant challenges.
First, learning a low-bias value model is non-trivial given the long trajectory and the instability of learning value in a bootstrapped way. Second, handling both short and long responses simultaneously is also challenging, as they might exhibit very distinct preferences towards the bias-variance trade-off during optimization. Last but not least, the sparsity of the reward signal from verifiers is further exacerbated by the long CoT pattern, which intrinsically requires better mechanisms to balance exploration and exploitation. To address the aforementioned challenges and fully unleash the potential of value-model-based methods in reasoning tasks, we present <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">V</span>alue <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">A</span>ugmented proximal <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">P</span>olicy <span class="ltx_text ltx_font_bold" id="S1.p4.1.4">O</span>ptimization (<span class="ltx_text ltx_font_bold" id="S1.p4.1.5">VAPO</span>), a value-model-based RL training framework. VAPO draws inspiration from prior research works such as VC-PPO&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib30" title="">30</a>]</cite> and DAPO&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib29" title="">29</a>]</cite>, and further extends their concepts.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We summarize our key contributions as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduce VAPO, the first value-model-based RL training framework to outperform value-model-free methods on long COT tasks significantly. VAPO not only demonstrates remarkable superiority in terms of performance but also showcases enhanced training efficiency, streamlining the learning process and underscoring its potential as a new benchmark in the field.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose Length-adaptive GAE, which adaptively adjusts the <math alttext="\lambda" class="ltx_Math" display="inline" id="S1.I1.i2.p1.1.m1.1"><semantics id="S1.I1.i2.p1.1.m1.1a"><mi id="S1.I1.i2.p1.1.m1.1.1" xref="S1.I1.i2.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.1.m1.1b"><ci id="S1.I1.i2.p1.1.m1.1.1.cmml" xref="S1.I1.i2.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.1.m1.1d">italic_λ</annotation></semantics></math> parameter in GAE computation based on response lengths. By doing so, it effectively caters to the distinct bias-variance trade-off requirements associated with responses of highly variable lengths. As a result, it optimizes the accuracy and stability of the advantage estimation process, particularly in scenarios where the length of the data sequences varies widely.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We systematically integrate techniques from prior work, such as Clip-Higher and Token-level Loss from DAPO <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib29" title="">29</a>]</cite>, Value-Pretraining and Decoupled-GAE from VC-PPO <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib30" title="">30</a>]</cite>, self-imitation learning from SIL <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib14" title="">14</a>]</cite>, and Group-Sampling from GRPO <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib22" title="">22</a>]</cite>. Additionally, we further validate their necessity through ablation studies.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
<p class="ltx_p" id="S1.p5.2"><span class="ltx_text ltx_font_bold" id="S1.p5.2.1">VAPO</span> is an effective reinforcement learning system that brings together these improvements. These enhancements work together smoothly, leading to a combined result that’s better than the sum of the individual parts.
We conduct experiments using the Qwen2.5-32B pre-trained model, ensuring no SFT data is introduced in any of the experiments, to maintain comparability with related works (DAPO and DeepSeek-R1-Zero-Qwen-32B).
The performance of <span class="ltx_text ltx_font_bold" id="S1.p5.2.2">VAPO</span> improves from vanilla PPO a score of 5 to 60, surpassing the previous SOTA value-model-free methods DAPO&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib29" title="">29</a>]</cite> by 10 points. More importantly, <span class="ltx_text ltx_font_bold" id="S1.p5.2.3">VAPO</span> is highly stable — we don’t observe any crashes during training, and the results across multiple runs are consistently similar.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S2" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">This section presents the fundamental concepts and notations that serve as the basis for our proposed algorithm. We first explore the basic framework of representing language generation as a reinforcement learning task. Subsequently, we introduce Proximal Policy Optimization and Generalized Advantage Estimation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Modeling Language Generation as Token-Level MDP</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Reinforcement learning centers around the learning of a policy that maximizes the cumulative reward for an agent as it interacts with an environment. In this study, we cast language generation tasks within the framework of a Markov Decision Process (MDP) <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib17" title="">17</a>]</cite>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.7">Let the prompt be denoted as <math alttext="x" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_x</annotation></semantics></math>, and the response to this prompt as <math alttext="y" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">italic_y</annotation></semantics></math>. Both <math alttext="x" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_y</annotation></semantics></math> can be decomposed into sequences of tokens. For example, the prompt <math alttext="x" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_x</annotation></semantics></math> can be expressed as <math alttext="x=(x_{0},\dots,x_{m})" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.3"><semantics id="S2.SS1.p2.6.m6.3a"><mrow id="S2.SS1.p2.6.m6.3.3" xref="S2.SS1.p2.6.m6.3.3.cmml"><mi id="S2.SS1.p2.6.m6.3.3.4" xref="S2.SS1.p2.6.m6.3.3.4.cmml">x</mi><mo id="S2.SS1.p2.6.m6.3.3.3" xref="S2.SS1.p2.6.m6.3.3.3.cmml">=</mo><mrow id="S2.SS1.p2.6.m6.3.3.2.2" xref="S2.SS1.p2.6.m6.3.3.2.3.cmml"><mo id="S2.SS1.p2.6.m6.3.3.2.2.3" stretchy="false" xref="S2.SS1.p2.6.m6.3.3.2.3.cmml">(</mo><msub id="S2.SS1.p2.6.m6.2.2.1.1.1" xref="S2.SS1.p2.6.m6.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.6.m6.2.2.1.1.1.2" xref="S2.SS1.p2.6.m6.2.2.1.1.1.2.cmml">x</mi><mn id="S2.SS1.p2.6.m6.2.2.1.1.1.3" xref="S2.SS1.p2.6.m6.2.2.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS1.p2.6.m6.3.3.2.2.4" xref="S2.SS1.p2.6.m6.3.3.2.3.cmml">,</mo><mi id="S2.SS1.p2.6.m6.1.1" mathvariant="normal" xref="S2.SS1.p2.6.m6.1.1.cmml">…</mi><mo id="S2.SS1.p2.6.m6.3.3.2.2.5" xref="S2.SS1.p2.6.m6.3.3.2.3.cmml">,</mo><msub id="S2.SS1.p2.6.m6.3.3.2.2.2" xref="S2.SS1.p2.6.m6.3.3.2.2.2.cmml"><mi id="S2.SS1.p2.6.m6.3.3.2.2.2.2" xref="S2.SS1.p2.6.m6.3.3.2.2.2.2.cmml">x</mi><mi id="S2.SS1.p2.6.m6.3.3.2.2.2.3" xref="S2.SS1.p2.6.m6.3.3.2.2.2.3.cmml">m</mi></msub><mo id="S2.SS1.p2.6.m6.3.3.2.2.6" stretchy="false" xref="S2.SS1.p2.6.m6.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.3b"><apply id="S2.SS1.p2.6.m6.3.3.cmml" xref="S2.SS1.p2.6.m6.3.3"><eq id="S2.SS1.p2.6.m6.3.3.3.cmml" xref="S2.SS1.p2.6.m6.3.3.3"></eq><ci id="S2.SS1.p2.6.m6.3.3.4.cmml" xref="S2.SS1.p2.6.m6.3.3.4">𝑥</ci><vector id="S2.SS1.p2.6.m6.3.3.2.3.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2"><apply id="S2.SS1.p2.6.m6.2.2.1.1.1.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1.2">𝑥</ci><cn id="S2.SS1.p2.6.m6.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS1.p2.6.m6.2.2.1.1.1.3">0</cn></apply><ci id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">…</ci><apply id="S2.SS1.p2.6.m6.3.3.2.2.2.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.3.3.2.2.2.1.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p2.6.m6.3.3.2.2.2.2.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2.2">𝑥</ci><ci id="S2.SS1.p2.6.m6.3.3.2.2.2.3.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2.3">𝑚</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.3c">x=(x_{0},\dots,x_{m})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.3d">italic_x = ( italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>, where the tokens are drawn from a fixed discrete vocabulary <math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m7.1"><semantics id="S2.SS1.p2.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><ci id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m7.1d">caligraphic_A</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">We define the token-level MDP as the tuple <math alttext="\mathcal{M}=(\mathcal{S},\mathcal{A},\mathbb{P},R,d_{0},\omega)" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.6"><semantics id="S2.SS1.p3.1.m1.6a"><mrow id="S2.SS1.p3.1.m1.6.6" xref="S2.SS1.p3.1.m1.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.1.m1.6.6.3" xref="S2.SS1.p3.1.m1.6.6.3.cmml">ℳ</mi><mo id="S2.SS1.p3.1.m1.6.6.2" xref="S2.SS1.p3.1.m1.6.6.2.cmml">=</mo><mrow id="S2.SS1.p3.1.m1.6.6.1.1" xref="S2.SS1.p3.1.m1.6.6.1.2.cmml"><mo id="S2.SS1.p3.1.m1.6.6.1.1.2" stretchy="false" xref="S2.SS1.p3.1.m1.6.6.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml">𝒮</mi><mo id="S2.SS1.p3.1.m1.6.6.1.1.3" xref="S2.SS1.p3.1.m1.6.6.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.1.m1.2.2" xref="S2.SS1.p3.1.m1.2.2.cmml">𝒜</mi><mo id="S2.SS1.p3.1.m1.6.6.1.1.4" xref="S2.SS1.p3.1.m1.6.6.1.2.cmml">,</mo><mi id="S2.SS1.p3.1.m1.3.3" xref="S2.SS1.p3.1.m1.3.3.cmml">ℙ</mi><mo id="S2.SS1.p3.1.m1.6.6.1.1.5" xref="S2.SS1.p3.1.m1.6.6.1.2.cmml">,</mo><mi id="S2.SS1.p3.1.m1.4.4" xref="S2.SS1.p3.1.m1.4.4.cmml">R</mi><mo id="S2.SS1.p3.1.m1.6.6.1.1.6" xref="S2.SS1.p3.1.m1.6.6.1.2.cmml">,</mo><msub id="S2.SS1.p3.1.m1.6.6.1.1.1" xref="S2.SS1.p3.1.m1.6.6.1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.6.6.1.1.1.2" xref="S2.SS1.p3.1.m1.6.6.1.1.1.2.cmml">d</mi><mn id="S2.SS1.p3.1.m1.6.6.1.1.1.3" xref="S2.SS1.p3.1.m1.6.6.1.1.1.3.cmml">0</mn></msub><mo id="S2.SS1.p3.1.m1.6.6.1.1.7" xref="S2.SS1.p3.1.m1.6.6.1.2.cmml">,</mo><mi id="S2.SS1.p3.1.m1.5.5" xref="S2.SS1.p3.1.m1.5.5.cmml">ω</mi><mo id="S2.SS1.p3.1.m1.6.6.1.1.8" stretchy="false" xref="S2.SS1.p3.1.m1.6.6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.6b"><apply id="S2.SS1.p3.1.m1.6.6.cmml" xref="S2.SS1.p3.1.m1.6.6"><eq id="S2.SS1.p3.1.m1.6.6.2.cmml" xref="S2.SS1.p3.1.m1.6.6.2"></eq><ci id="S2.SS1.p3.1.m1.6.6.3.cmml" xref="S2.SS1.p3.1.m1.6.6.3">ℳ</ci><vector id="S2.SS1.p3.1.m1.6.6.1.2.cmml" xref="S2.SS1.p3.1.m1.6.6.1.1"><ci id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">𝒮</ci><ci id="S2.SS1.p3.1.m1.2.2.cmml" xref="S2.SS1.p3.1.m1.2.2">𝒜</ci><ci id="S2.SS1.p3.1.m1.3.3.cmml" xref="S2.SS1.p3.1.m1.3.3">ℙ</ci><ci id="S2.SS1.p3.1.m1.4.4.cmml" xref="S2.SS1.p3.1.m1.4.4">𝑅</ci><apply id="S2.SS1.p3.1.m1.6.6.1.1.1.cmml" xref="S2.SS1.p3.1.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.6.6.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.6.6.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.1.m1.6.6.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.6.6.1.1.1.2">𝑑</ci><cn id="S2.SS1.p3.1.m1.6.6.1.1.1.3.cmml" type="integer" xref="S2.SS1.p3.1.m1.6.6.1.1.1.3">0</cn></apply><ci id="S2.SS1.p3.1.m1.5.5.cmml" xref="S2.SS1.p3.1.m1.5.5">𝜔</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.6c">\mathcal{M}=(\mathcal{S},\mathcal{A},\mathbb{P},R,d_{0},\omega)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.6d">caligraphic_M = ( caligraphic_S , caligraphic_A , blackboard_P , italic_R , italic_d start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_ω )</annotation></semantics></math>. Here is a detailed breakdown of each component:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.4"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.1.1">State Space (<math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.1.m1.1"><semantics id="S2.I1.i1.p1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i1.p1.1.1.m1.1.1" xref="S2.I1.i1.p1.1.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.1.m1.1b"><ci id="S2.I1.i1.p1.1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.1.m1.1d">caligraphic_S</annotation></semantics></math>)</span>: This space encompasses all possible states formed by the tokens generated up to a given time step. At time step <math alttext="t" class="ltx_Math" display="inline" id="S2.I1.i1.p1.2.m1.1"><semantics id="S2.I1.i1.p1.2.m1.1a"><mi id="S2.I1.i1.p1.2.m1.1.1" xref="S2.I1.i1.p1.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m1.1b"><ci id="S2.I1.i1.p1.2.m1.1.1.cmml" xref="S2.I1.i1.p1.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.2.m1.1d">italic_t</annotation></semantics></math>, the state <math alttext="s_{t}" class="ltx_Math" display="inline" id="S2.I1.i1.p1.3.m2.1"><semantics id="S2.I1.i1.p1.3.m2.1a"><msub id="S2.I1.i1.p1.3.m2.1.1" xref="S2.I1.i1.p1.3.m2.1.1.cmml"><mi id="S2.I1.i1.p1.3.m2.1.1.2" xref="S2.I1.i1.p1.3.m2.1.1.2.cmml">s</mi><mi id="S2.I1.i1.p1.3.m2.1.1.3" xref="S2.I1.i1.p1.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.3.m2.1b"><apply id="S2.I1.i1.p1.3.m2.1.1.cmml" xref="S2.I1.i1.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.3.m2.1.1.1.cmml" xref="S2.I1.i1.p1.3.m2.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.3.m2.1.1.2.cmml" xref="S2.I1.i1.p1.3.m2.1.1.2">𝑠</ci><ci id="S2.I1.i1.p1.3.m2.1.1.3.cmml" xref="S2.I1.i1.p1.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.3.m2.1c">s_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.3.m2.1d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is defined as <math alttext="s_{t}=(x_{0},\dots,x_{m},y_{0},\dots,y_{t})" class="ltx_Math" display="inline" id="S2.I1.i1.p1.4.m3.6"><semantics id="S2.I1.i1.p1.4.m3.6a"><mrow id="S2.I1.i1.p1.4.m3.6.6" xref="S2.I1.i1.p1.4.m3.6.6.cmml"><msub id="S2.I1.i1.p1.4.m3.6.6.6" xref="S2.I1.i1.p1.4.m3.6.6.6.cmml"><mi id="S2.I1.i1.p1.4.m3.6.6.6.2" xref="S2.I1.i1.p1.4.m3.6.6.6.2.cmml">s</mi><mi id="S2.I1.i1.p1.4.m3.6.6.6.3" xref="S2.I1.i1.p1.4.m3.6.6.6.3.cmml">t</mi></msub><mo id="S2.I1.i1.p1.4.m3.6.6.5" xref="S2.I1.i1.p1.4.m3.6.6.5.cmml">=</mo><mrow id="S2.I1.i1.p1.4.m3.6.6.4.4" xref="S2.I1.i1.p1.4.m3.6.6.4.5.cmml"><mo id="S2.I1.i1.p1.4.m3.6.6.4.4.5" stretchy="false" xref="S2.I1.i1.p1.4.m3.6.6.4.5.cmml">(</mo><msub id="S2.I1.i1.p1.4.m3.3.3.1.1.1" xref="S2.I1.i1.p1.4.m3.3.3.1.1.1.cmml"><mi id="S2.I1.i1.p1.4.m3.3.3.1.1.1.2" xref="S2.I1.i1.p1.4.m3.3.3.1.1.1.2.cmml">x</mi><mn id="S2.I1.i1.p1.4.m3.3.3.1.1.1.3" xref="S2.I1.i1.p1.4.m3.3.3.1.1.1.3.cmml">0</mn></msub><mo id="S2.I1.i1.p1.4.m3.6.6.4.4.6" xref="S2.I1.i1.p1.4.m3.6.6.4.5.cmml">,</mo><mi id="S2.I1.i1.p1.4.m3.1.1" mathvariant="normal" xref="S2.I1.i1.p1.4.m3.1.1.cmml">…</mi><mo id="S2.I1.i1.p1.4.m3.6.6.4.4.7" xref="S2.I1.i1.p1.4.m3.6.6.4.5.cmml">,</mo><msub id="S2.I1.i1.p1.4.m3.4.4.2.2.2" xref="S2.I1.i1.p1.4.m3.4.4.2.2.2.cmml"><mi id="S2.I1.i1.p1.4.m3.4.4.2.2.2.2" xref="S2.I1.i1.p1.4.m3.4.4.2.2.2.2.cmml">x</mi><mi id="S2.I1.i1.p1.4.m3.4.4.2.2.2.3" xref="S2.I1.i1.p1.4.m3.4.4.2.2.2.3.cmml">m</mi></msub><mo id="S2.I1.i1.p1.4.m3.6.6.4.4.8" xref="S2.I1.i1.p1.4.m3.6.6.4.5.cmml">,</mo><msub id="S2.I1.i1.p1.4.m3.5.5.3.3.3" xref="S2.I1.i1.p1.4.m3.5.5.3.3.3.cmml"><mi id="S2.I1.i1.p1.4.m3.5.5.3.3.3.2" xref="S2.I1.i1.p1.4.m3.5.5.3.3.3.2.cmml">y</mi><mn id="S2.I1.i1.p1.4.m3.5.5.3.3.3.3" xref="S2.I1.i1.p1.4.m3.5.5.3.3.3.3.cmml">0</mn></msub><mo id="S2.I1.i1.p1.4.m3.6.6.4.4.9" xref="S2.I1.i1.p1.4.m3.6.6.4.5.cmml">,</mo><mi id="S2.I1.i1.p1.4.m3.2.2" mathvariant="normal" xref="S2.I1.i1.p1.4.m3.2.2.cmml">…</mi><mo id="S2.I1.i1.p1.4.m3.6.6.4.4.10" xref="S2.I1.i1.p1.4.m3.6.6.4.5.cmml">,</mo><msub id="S2.I1.i1.p1.4.m3.6.6.4.4.4" xref="S2.I1.i1.p1.4.m3.6.6.4.4.4.cmml"><mi id="S2.I1.i1.p1.4.m3.6.6.4.4.4.2" xref="S2.I1.i1.p1.4.m3.6.6.4.4.4.2.cmml">y</mi><mi id="S2.I1.i1.p1.4.m3.6.6.4.4.4.3" xref="S2.I1.i1.p1.4.m3.6.6.4.4.4.3.cmml">t</mi></msub><mo id="S2.I1.i1.p1.4.m3.6.6.4.4.11" stretchy="false" xref="S2.I1.i1.p1.4.m3.6.6.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.4.m3.6b"><apply id="S2.I1.i1.p1.4.m3.6.6.cmml" xref="S2.I1.i1.p1.4.m3.6.6"><eq id="S2.I1.i1.p1.4.m3.6.6.5.cmml" xref="S2.I1.i1.p1.4.m3.6.6.5"></eq><apply id="S2.I1.i1.p1.4.m3.6.6.6.cmml" xref="S2.I1.i1.p1.4.m3.6.6.6"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m3.6.6.6.1.cmml" xref="S2.I1.i1.p1.4.m3.6.6.6">subscript</csymbol><ci id="S2.I1.i1.p1.4.m3.6.6.6.2.cmml" xref="S2.I1.i1.p1.4.m3.6.6.6.2">𝑠</ci><ci id="S2.I1.i1.p1.4.m3.6.6.6.3.cmml" xref="S2.I1.i1.p1.4.m3.6.6.6.3">𝑡</ci></apply><vector id="S2.I1.i1.p1.4.m3.6.6.4.5.cmml" xref="S2.I1.i1.p1.4.m3.6.6.4.4"><apply id="S2.I1.i1.p1.4.m3.3.3.1.1.1.cmml" xref="S2.I1.i1.p1.4.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m3.3.3.1.1.1.1.cmml" xref="S2.I1.i1.p1.4.m3.3.3.1.1.1">subscript</csymbol><ci id="S2.I1.i1.p1.4.m3.3.3.1.1.1.2.cmml" xref="S2.I1.i1.p1.4.m3.3.3.1.1.1.2">𝑥</ci><cn id="S2.I1.i1.p1.4.m3.3.3.1.1.1.3.cmml" type="integer" xref="S2.I1.i1.p1.4.m3.3.3.1.1.1.3">0</cn></apply><ci id="S2.I1.i1.p1.4.m3.1.1.cmml" xref="S2.I1.i1.p1.4.m3.1.1">…</ci><apply id="S2.I1.i1.p1.4.m3.4.4.2.2.2.cmml" xref="S2.I1.i1.p1.4.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m3.4.4.2.2.2.1.cmml" xref="S2.I1.i1.p1.4.m3.4.4.2.2.2">subscript</csymbol><ci id="S2.I1.i1.p1.4.m3.4.4.2.2.2.2.cmml" xref="S2.I1.i1.p1.4.m3.4.4.2.2.2.2">𝑥</ci><ci id="S2.I1.i1.p1.4.m3.4.4.2.2.2.3.cmml" xref="S2.I1.i1.p1.4.m3.4.4.2.2.2.3">𝑚</ci></apply><apply id="S2.I1.i1.p1.4.m3.5.5.3.3.3.cmml" xref="S2.I1.i1.p1.4.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m3.5.5.3.3.3.1.cmml" xref="S2.I1.i1.p1.4.m3.5.5.3.3.3">subscript</csymbol><ci id="S2.I1.i1.p1.4.m3.5.5.3.3.3.2.cmml" xref="S2.I1.i1.p1.4.m3.5.5.3.3.3.2">𝑦</ci><cn id="S2.I1.i1.p1.4.m3.5.5.3.3.3.3.cmml" type="integer" xref="S2.I1.i1.p1.4.m3.5.5.3.3.3.3">0</cn></apply><ci id="S2.I1.i1.p1.4.m3.2.2.cmml" xref="S2.I1.i1.p1.4.m3.2.2">…</ci><apply id="S2.I1.i1.p1.4.m3.6.6.4.4.4.cmml" xref="S2.I1.i1.p1.4.m3.6.6.4.4.4"><csymbol cd="ambiguous" id="S2.I1.i1.p1.4.m3.6.6.4.4.4.1.cmml" xref="S2.I1.i1.p1.4.m3.6.6.4.4.4">subscript</csymbol><ci id="S2.I1.i1.p1.4.m3.6.6.4.4.4.2.cmml" xref="S2.I1.i1.p1.4.m3.6.6.4.4.4.2">𝑦</ci><ci id="S2.I1.i1.p1.4.m3.6.6.4.4.4.3.cmml" xref="S2.I1.i1.p1.4.m3.6.6.4.4.4.3">𝑡</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.4.m3.6c">s_{t}=(x_{0},\dots,x_{m},y_{0},\dots,y_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.4.m3.6d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.1.1">Action Space (<math alttext="\mathcal{A}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.1.m1.1"><semantics id="S2.I1.i2.p1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i2.p1.1.1.m1.1.1" xref="S2.I1.i2.p1.1.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.1.m1.1b"><ci id="S2.I1.i2.p1.1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.1.m1.1c">\mathcal{A}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.1.m1.1d">caligraphic_A</annotation></semantics></math>)</span>: It corresponds to the fixed discrete vocabulary, from which tokens are selected during the generation process.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.5"><span class="ltx_text ltx_font_bold" id="S2.I1.i3.p1.1.1">Dynamics (<math alttext="\mathbb{P}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.1.1.m1.1"><semantics id="S2.I1.i3.p1.1.1.m1.1a"><mi id="S2.I1.i3.p1.1.1.m1.1.1" xref="S2.I1.i3.p1.1.1.m1.1.1.cmml">ℙ</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.1.m1.1b"><ci id="S2.I1.i3.p1.1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.1.m1.1.1">ℙ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.1.m1.1c">\mathbb{P}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.1.1.m1.1d">blackboard_P</annotation></semantics></math>)</span>: These represent a deterministic transition model between tokens. Given a state <math alttext="s_{t}=(x_{0},\dots,x_{m},y_{0},\dots,y_{t})" class="ltx_Math" display="inline" id="S2.I1.i3.p1.2.m1.6"><semantics id="S2.I1.i3.p1.2.m1.6a"><mrow id="S2.I1.i3.p1.2.m1.6.6" xref="S2.I1.i3.p1.2.m1.6.6.cmml"><msub id="S2.I1.i3.p1.2.m1.6.6.6" xref="S2.I1.i3.p1.2.m1.6.6.6.cmml"><mi id="S2.I1.i3.p1.2.m1.6.6.6.2" xref="S2.I1.i3.p1.2.m1.6.6.6.2.cmml">s</mi><mi id="S2.I1.i3.p1.2.m1.6.6.6.3" xref="S2.I1.i3.p1.2.m1.6.6.6.3.cmml">t</mi></msub><mo id="S2.I1.i3.p1.2.m1.6.6.5" xref="S2.I1.i3.p1.2.m1.6.6.5.cmml">=</mo><mrow id="S2.I1.i3.p1.2.m1.6.6.4.4" xref="S2.I1.i3.p1.2.m1.6.6.4.5.cmml"><mo id="S2.I1.i3.p1.2.m1.6.6.4.4.5" stretchy="false" xref="S2.I1.i3.p1.2.m1.6.6.4.5.cmml">(</mo><msub id="S2.I1.i3.p1.2.m1.3.3.1.1.1" xref="S2.I1.i3.p1.2.m1.3.3.1.1.1.cmml"><mi id="S2.I1.i3.p1.2.m1.3.3.1.1.1.2" xref="S2.I1.i3.p1.2.m1.3.3.1.1.1.2.cmml">x</mi><mn id="S2.I1.i3.p1.2.m1.3.3.1.1.1.3" xref="S2.I1.i3.p1.2.m1.3.3.1.1.1.3.cmml">0</mn></msub><mo id="S2.I1.i3.p1.2.m1.6.6.4.4.6" xref="S2.I1.i3.p1.2.m1.6.6.4.5.cmml">,</mo><mi id="S2.I1.i3.p1.2.m1.1.1" mathvariant="normal" xref="S2.I1.i3.p1.2.m1.1.1.cmml">…</mi><mo id="S2.I1.i3.p1.2.m1.6.6.4.4.7" xref="S2.I1.i3.p1.2.m1.6.6.4.5.cmml">,</mo><msub id="S2.I1.i3.p1.2.m1.4.4.2.2.2" xref="S2.I1.i3.p1.2.m1.4.4.2.2.2.cmml"><mi id="S2.I1.i3.p1.2.m1.4.4.2.2.2.2" xref="S2.I1.i3.p1.2.m1.4.4.2.2.2.2.cmml">x</mi><mi id="S2.I1.i3.p1.2.m1.4.4.2.2.2.3" xref="S2.I1.i3.p1.2.m1.4.4.2.2.2.3.cmml">m</mi></msub><mo id="S2.I1.i3.p1.2.m1.6.6.4.4.8" xref="S2.I1.i3.p1.2.m1.6.6.4.5.cmml">,</mo><msub id="S2.I1.i3.p1.2.m1.5.5.3.3.3" xref="S2.I1.i3.p1.2.m1.5.5.3.3.3.cmml"><mi id="S2.I1.i3.p1.2.m1.5.5.3.3.3.2" xref="S2.I1.i3.p1.2.m1.5.5.3.3.3.2.cmml">y</mi><mn id="S2.I1.i3.p1.2.m1.5.5.3.3.3.3" xref="S2.I1.i3.p1.2.m1.5.5.3.3.3.3.cmml">0</mn></msub><mo id="S2.I1.i3.p1.2.m1.6.6.4.4.9" xref="S2.I1.i3.p1.2.m1.6.6.4.5.cmml">,</mo><mi id="S2.I1.i3.p1.2.m1.2.2" mathvariant="normal" xref="S2.I1.i3.p1.2.m1.2.2.cmml">…</mi><mo id="S2.I1.i3.p1.2.m1.6.6.4.4.10" xref="S2.I1.i3.p1.2.m1.6.6.4.5.cmml">,</mo><msub id="S2.I1.i3.p1.2.m1.6.6.4.4.4" xref="S2.I1.i3.p1.2.m1.6.6.4.4.4.cmml"><mi id="S2.I1.i3.p1.2.m1.6.6.4.4.4.2" xref="S2.I1.i3.p1.2.m1.6.6.4.4.4.2.cmml">y</mi><mi id="S2.I1.i3.p1.2.m1.6.6.4.4.4.3" xref="S2.I1.i3.p1.2.m1.6.6.4.4.4.3.cmml">t</mi></msub><mo id="S2.I1.i3.p1.2.m1.6.6.4.4.11" stretchy="false" xref="S2.I1.i3.p1.2.m1.6.6.4.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.2.m1.6b"><apply id="S2.I1.i3.p1.2.m1.6.6.cmml" xref="S2.I1.i3.p1.2.m1.6.6"><eq id="S2.I1.i3.p1.2.m1.6.6.5.cmml" xref="S2.I1.i3.p1.2.m1.6.6.5"></eq><apply id="S2.I1.i3.p1.2.m1.6.6.6.cmml" xref="S2.I1.i3.p1.2.m1.6.6.6"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m1.6.6.6.1.cmml" xref="S2.I1.i3.p1.2.m1.6.6.6">subscript</csymbol><ci id="S2.I1.i3.p1.2.m1.6.6.6.2.cmml" xref="S2.I1.i3.p1.2.m1.6.6.6.2">𝑠</ci><ci id="S2.I1.i3.p1.2.m1.6.6.6.3.cmml" xref="S2.I1.i3.p1.2.m1.6.6.6.3">𝑡</ci></apply><vector id="S2.I1.i3.p1.2.m1.6.6.4.5.cmml" xref="S2.I1.i3.p1.2.m1.6.6.4.4"><apply id="S2.I1.i3.p1.2.m1.3.3.1.1.1.cmml" xref="S2.I1.i3.p1.2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m1.3.3.1.1.1.1.cmml" xref="S2.I1.i3.p1.2.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.2.m1.3.3.1.1.1.2.cmml" xref="S2.I1.i3.p1.2.m1.3.3.1.1.1.2">𝑥</ci><cn id="S2.I1.i3.p1.2.m1.3.3.1.1.1.3.cmml" type="integer" xref="S2.I1.i3.p1.2.m1.3.3.1.1.1.3">0</cn></apply><ci id="S2.I1.i3.p1.2.m1.1.1.cmml" xref="S2.I1.i3.p1.2.m1.1.1">…</ci><apply id="S2.I1.i3.p1.2.m1.4.4.2.2.2.cmml" xref="S2.I1.i3.p1.2.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m1.4.4.2.2.2.1.cmml" xref="S2.I1.i3.p1.2.m1.4.4.2.2.2">subscript</csymbol><ci id="S2.I1.i3.p1.2.m1.4.4.2.2.2.2.cmml" xref="S2.I1.i3.p1.2.m1.4.4.2.2.2.2">𝑥</ci><ci id="S2.I1.i3.p1.2.m1.4.4.2.2.2.3.cmml" xref="S2.I1.i3.p1.2.m1.4.4.2.2.2.3">𝑚</ci></apply><apply id="S2.I1.i3.p1.2.m1.5.5.3.3.3.cmml" xref="S2.I1.i3.p1.2.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m1.5.5.3.3.3.1.cmml" xref="S2.I1.i3.p1.2.m1.5.5.3.3.3">subscript</csymbol><ci id="S2.I1.i3.p1.2.m1.5.5.3.3.3.2.cmml" xref="S2.I1.i3.p1.2.m1.5.5.3.3.3.2">𝑦</ci><cn id="S2.I1.i3.p1.2.m1.5.5.3.3.3.3.cmml" type="integer" xref="S2.I1.i3.p1.2.m1.5.5.3.3.3.3">0</cn></apply><ci id="S2.I1.i3.p1.2.m1.2.2.cmml" xref="S2.I1.i3.p1.2.m1.2.2">…</ci><apply id="S2.I1.i3.p1.2.m1.6.6.4.4.4.cmml" xref="S2.I1.i3.p1.2.m1.6.6.4.4.4"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m1.6.6.4.4.4.1.cmml" xref="S2.I1.i3.p1.2.m1.6.6.4.4.4">subscript</csymbol><ci id="S2.I1.i3.p1.2.m1.6.6.4.4.4.2.cmml" xref="S2.I1.i3.p1.2.m1.6.6.4.4.4.2">𝑦</ci><ci id="S2.I1.i3.p1.2.m1.6.6.4.4.4.3.cmml" xref="S2.I1.i3.p1.2.m1.6.6.4.4.4.3">𝑡</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.2.m1.6c">s_{t}=(x_{0},\dots,x_{m},y_{0},\dots,y_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.2.m1.6d">italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ( italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, an action <math alttext="a=y_{t+1}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.3.m2.1"><semantics id="S2.I1.i3.p1.3.m2.1a"><mrow id="S2.I1.i3.p1.3.m2.1.1" xref="S2.I1.i3.p1.3.m2.1.1.cmml"><mi id="S2.I1.i3.p1.3.m2.1.1.2" xref="S2.I1.i3.p1.3.m2.1.1.2.cmml">a</mi><mo id="S2.I1.i3.p1.3.m2.1.1.1" xref="S2.I1.i3.p1.3.m2.1.1.1.cmml">=</mo><msub id="S2.I1.i3.p1.3.m2.1.1.3" xref="S2.I1.i3.p1.3.m2.1.1.3.cmml"><mi id="S2.I1.i3.p1.3.m2.1.1.3.2" xref="S2.I1.i3.p1.3.m2.1.1.3.2.cmml">y</mi><mrow id="S2.I1.i3.p1.3.m2.1.1.3.3" xref="S2.I1.i3.p1.3.m2.1.1.3.3.cmml"><mi id="S2.I1.i3.p1.3.m2.1.1.3.3.2" xref="S2.I1.i3.p1.3.m2.1.1.3.3.2.cmml">t</mi><mo id="S2.I1.i3.p1.3.m2.1.1.3.3.1" xref="S2.I1.i3.p1.3.m2.1.1.3.3.1.cmml">+</mo><mn id="S2.I1.i3.p1.3.m2.1.1.3.3.3" xref="S2.I1.i3.p1.3.m2.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.3.m2.1b"><apply id="S2.I1.i3.p1.3.m2.1.1.cmml" xref="S2.I1.i3.p1.3.m2.1.1"><eq id="S2.I1.i3.p1.3.m2.1.1.1.cmml" xref="S2.I1.i3.p1.3.m2.1.1.1"></eq><ci id="S2.I1.i3.p1.3.m2.1.1.2.cmml" xref="S2.I1.i3.p1.3.m2.1.1.2">𝑎</ci><apply id="S2.I1.i3.p1.3.m2.1.1.3.cmml" xref="S2.I1.i3.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.3.m2.1.1.3.1.cmml" xref="S2.I1.i3.p1.3.m2.1.1.3">subscript</csymbol><ci id="S2.I1.i3.p1.3.m2.1.1.3.2.cmml" xref="S2.I1.i3.p1.3.m2.1.1.3.2">𝑦</ci><apply id="S2.I1.i3.p1.3.m2.1.1.3.3.cmml" xref="S2.I1.i3.p1.3.m2.1.1.3.3"><plus id="S2.I1.i3.p1.3.m2.1.1.3.3.1.cmml" xref="S2.I1.i3.p1.3.m2.1.1.3.3.1"></plus><ci id="S2.I1.i3.p1.3.m2.1.1.3.3.2.cmml" xref="S2.I1.i3.p1.3.m2.1.1.3.3.2">𝑡</ci><cn id="S2.I1.i3.p1.3.m2.1.1.3.3.3.cmml" type="integer" xref="S2.I1.i3.p1.3.m2.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.3.m2.1c">a=y_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.3.m2.1d">italic_a = italic_y start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, and the subsequent state <math alttext="s_{t+1}=(x_{0},\dots,x_{m},y_{0},\dots,y_{t},y_{t+1})" class="ltx_Math" display="inline" id="S2.I1.i3.p1.4.m3.7"><semantics id="S2.I1.i3.p1.4.m3.7a"><mrow id="S2.I1.i3.p1.4.m3.7.7" xref="S2.I1.i3.p1.4.m3.7.7.cmml"><msub id="S2.I1.i3.p1.4.m3.7.7.7" xref="S2.I1.i3.p1.4.m3.7.7.7.cmml"><mi id="S2.I1.i3.p1.4.m3.7.7.7.2" xref="S2.I1.i3.p1.4.m3.7.7.7.2.cmml">s</mi><mrow id="S2.I1.i3.p1.4.m3.7.7.7.3" xref="S2.I1.i3.p1.4.m3.7.7.7.3.cmml"><mi id="S2.I1.i3.p1.4.m3.7.7.7.3.2" xref="S2.I1.i3.p1.4.m3.7.7.7.3.2.cmml">t</mi><mo id="S2.I1.i3.p1.4.m3.7.7.7.3.1" xref="S2.I1.i3.p1.4.m3.7.7.7.3.1.cmml">+</mo><mn id="S2.I1.i3.p1.4.m3.7.7.7.3.3" xref="S2.I1.i3.p1.4.m3.7.7.7.3.3.cmml">1</mn></mrow></msub><mo id="S2.I1.i3.p1.4.m3.7.7.6" xref="S2.I1.i3.p1.4.m3.7.7.6.cmml">=</mo><mrow id="S2.I1.i3.p1.4.m3.7.7.5.5" xref="S2.I1.i3.p1.4.m3.7.7.5.6.cmml"><mo id="S2.I1.i3.p1.4.m3.7.7.5.5.6" stretchy="false" xref="S2.I1.i3.p1.4.m3.7.7.5.6.cmml">(</mo><msub id="S2.I1.i3.p1.4.m3.3.3.1.1.1" xref="S2.I1.i3.p1.4.m3.3.3.1.1.1.cmml"><mi id="S2.I1.i3.p1.4.m3.3.3.1.1.1.2" xref="S2.I1.i3.p1.4.m3.3.3.1.1.1.2.cmml">x</mi><mn id="S2.I1.i3.p1.4.m3.3.3.1.1.1.3" xref="S2.I1.i3.p1.4.m3.3.3.1.1.1.3.cmml">0</mn></msub><mo id="S2.I1.i3.p1.4.m3.7.7.5.5.7" xref="S2.I1.i3.p1.4.m3.7.7.5.6.cmml">,</mo><mi id="S2.I1.i3.p1.4.m3.1.1" mathvariant="normal" xref="S2.I1.i3.p1.4.m3.1.1.cmml">…</mi><mo id="S2.I1.i3.p1.4.m3.7.7.5.5.8" xref="S2.I1.i3.p1.4.m3.7.7.5.6.cmml">,</mo><msub id="S2.I1.i3.p1.4.m3.4.4.2.2.2" xref="S2.I1.i3.p1.4.m3.4.4.2.2.2.cmml"><mi id="S2.I1.i3.p1.4.m3.4.4.2.2.2.2" xref="S2.I1.i3.p1.4.m3.4.4.2.2.2.2.cmml">x</mi><mi id="S2.I1.i3.p1.4.m3.4.4.2.2.2.3" xref="S2.I1.i3.p1.4.m3.4.4.2.2.2.3.cmml">m</mi></msub><mo id="S2.I1.i3.p1.4.m3.7.7.5.5.9" xref="S2.I1.i3.p1.4.m3.7.7.5.6.cmml">,</mo><msub id="S2.I1.i3.p1.4.m3.5.5.3.3.3" xref="S2.I1.i3.p1.4.m3.5.5.3.3.3.cmml"><mi id="S2.I1.i3.p1.4.m3.5.5.3.3.3.2" xref="S2.I1.i3.p1.4.m3.5.5.3.3.3.2.cmml">y</mi><mn id="S2.I1.i3.p1.4.m3.5.5.3.3.3.3" xref="S2.I1.i3.p1.4.m3.5.5.3.3.3.3.cmml">0</mn></msub><mo id="S2.I1.i3.p1.4.m3.7.7.5.5.10" xref="S2.I1.i3.p1.4.m3.7.7.5.6.cmml">,</mo><mi id="S2.I1.i3.p1.4.m3.2.2" mathvariant="normal" xref="S2.I1.i3.p1.4.m3.2.2.cmml">…</mi><mo id="S2.I1.i3.p1.4.m3.7.7.5.5.11" xref="S2.I1.i3.p1.4.m3.7.7.5.6.cmml">,</mo><msub id="S2.I1.i3.p1.4.m3.6.6.4.4.4" xref="S2.I1.i3.p1.4.m3.6.6.4.4.4.cmml"><mi id="S2.I1.i3.p1.4.m3.6.6.4.4.4.2" xref="S2.I1.i3.p1.4.m3.6.6.4.4.4.2.cmml">y</mi><mi id="S2.I1.i3.p1.4.m3.6.6.4.4.4.3" xref="S2.I1.i3.p1.4.m3.6.6.4.4.4.3.cmml">t</mi></msub><mo id="S2.I1.i3.p1.4.m3.7.7.5.5.12" xref="S2.I1.i3.p1.4.m3.7.7.5.6.cmml">,</mo><msub id="S2.I1.i3.p1.4.m3.7.7.5.5.5" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.cmml"><mi id="S2.I1.i3.p1.4.m3.7.7.5.5.5.2" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.2.cmml">y</mi><mrow id="S2.I1.i3.p1.4.m3.7.7.5.5.5.3" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.cmml"><mi id="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.2" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.2.cmml">t</mi><mo id="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.1" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.1.cmml">+</mo><mn id="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.3" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.3.cmml">1</mn></mrow></msub><mo id="S2.I1.i3.p1.4.m3.7.7.5.5.13" stretchy="false" xref="S2.I1.i3.p1.4.m3.7.7.5.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.4.m3.7b"><apply id="S2.I1.i3.p1.4.m3.7.7.cmml" xref="S2.I1.i3.p1.4.m3.7.7"><eq id="S2.I1.i3.p1.4.m3.7.7.6.cmml" xref="S2.I1.i3.p1.4.m3.7.7.6"></eq><apply id="S2.I1.i3.p1.4.m3.7.7.7.cmml" xref="S2.I1.i3.p1.4.m3.7.7.7"><csymbol cd="ambiguous" id="S2.I1.i3.p1.4.m3.7.7.7.1.cmml" xref="S2.I1.i3.p1.4.m3.7.7.7">subscript</csymbol><ci id="S2.I1.i3.p1.4.m3.7.7.7.2.cmml" xref="S2.I1.i3.p1.4.m3.7.7.7.2">𝑠</ci><apply id="S2.I1.i3.p1.4.m3.7.7.7.3.cmml" xref="S2.I1.i3.p1.4.m3.7.7.7.3"><plus id="S2.I1.i3.p1.4.m3.7.7.7.3.1.cmml" xref="S2.I1.i3.p1.4.m3.7.7.7.3.1"></plus><ci id="S2.I1.i3.p1.4.m3.7.7.7.3.2.cmml" xref="S2.I1.i3.p1.4.m3.7.7.7.3.2">𝑡</ci><cn id="S2.I1.i3.p1.4.m3.7.7.7.3.3.cmml" type="integer" xref="S2.I1.i3.p1.4.m3.7.7.7.3.3">1</cn></apply></apply><vector id="S2.I1.i3.p1.4.m3.7.7.5.6.cmml" xref="S2.I1.i3.p1.4.m3.7.7.5.5"><apply id="S2.I1.i3.p1.4.m3.3.3.1.1.1.cmml" xref="S2.I1.i3.p1.4.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.4.m3.3.3.1.1.1.1.cmml" xref="S2.I1.i3.p1.4.m3.3.3.1.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.4.m3.3.3.1.1.1.2.cmml" xref="S2.I1.i3.p1.4.m3.3.3.1.1.1.2">𝑥</ci><cn id="S2.I1.i3.p1.4.m3.3.3.1.1.1.3.cmml" type="integer" xref="S2.I1.i3.p1.4.m3.3.3.1.1.1.3">0</cn></apply><ci id="S2.I1.i3.p1.4.m3.1.1.cmml" xref="S2.I1.i3.p1.4.m3.1.1">…</ci><apply id="S2.I1.i3.p1.4.m3.4.4.2.2.2.cmml" xref="S2.I1.i3.p1.4.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i3.p1.4.m3.4.4.2.2.2.1.cmml" xref="S2.I1.i3.p1.4.m3.4.4.2.2.2">subscript</csymbol><ci id="S2.I1.i3.p1.4.m3.4.4.2.2.2.2.cmml" xref="S2.I1.i3.p1.4.m3.4.4.2.2.2.2">𝑥</ci><ci id="S2.I1.i3.p1.4.m3.4.4.2.2.2.3.cmml" xref="S2.I1.i3.p1.4.m3.4.4.2.2.2.3">𝑚</ci></apply><apply id="S2.I1.i3.p1.4.m3.5.5.3.3.3.cmml" xref="S2.I1.i3.p1.4.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.4.m3.5.5.3.3.3.1.cmml" xref="S2.I1.i3.p1.4.m3.5.5.3.3.3">subscript</csymbol><ci id="S2.I1.i3.p1.4.m3.5.5.3.3.3.2.cmml" xref="S2.I1.i3.p1.4.m3.5.5.3.3.3.2">𝑦</ci><cn id="S2.I1.i3.p1.4.m3.5.5.3.3.3.3.cmml" type="integer" xref="S2.I1.i3.p1.4.m3.5.5.3.3.3.3">0</cn></apply><ci id="S2.I1.i3.p1.4.m3.2.2.cmml" xref="S2.I1.i3.p1.4.m3.2.2">…</ci><apply id="S2.I1.i3.p1.4.m3.6.6.4.4.4.cmml" xref="S2.I1.i3.p1.4.m3.6.6.4.4.4"><csymbol cd="ambiguous" id="S2.I1.i3.p1.4.m3.6.6.4.4.4.1.cmml" xref="S2.I1.i3.p1.4.m3.6.6.4.4.4">subscript</csymbol><ci id="S2.I1.i3.p1.4.m3.6.6.4.4.4.2.cmml" xref="S2.I1.i3.p1.4.m3.6.6.4.4.4.2">𝑦</ci><ci id="S2.I1.i3.p1.4.m3.6.6.4.4.4.3.cmml" xref="S2.I1.i3.p1.4.m3.6.6.4.4.4.3">𝑡</ci></apply><apply id="S2.I1.i3.p1.4.m3.7.7.5.5.5.cmml" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5"><csymbol cd="ambiguous" id="S2.I1.i3.p1.4.m3.7.7.5.5.5.1.cmml" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5">subscript</csymbol><ci id="S2.I1.i3.p1.4.m3.7.7.5.5.5.2.cmml" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.2">𝑦</ci><apply id="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.cmml" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.3"><plus id="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.1.cmml" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.1"></plus><ci id="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.2.cmml" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.2">𝑡</ci><cn id="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.3.cmml" type="integer" xref="S2.I1.i3.p1.4.m3.7.7.5.5.5.3.3">1</cn></apply></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.4.m3.7c">s_{t+1}=(x_{0},\dots,x_{m},y_{0},\dots,y_{t},y_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.4.m3.7d">italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT = ( italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , … , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math>, the probability <math alttext="\mathbb{P}(s_{t+1}|s_{t},a)=1" class="ltx_Math" display="inline" id="S2.I1.i3.p1.5.m4.2"><semantics id="S2.I1.i3.p1.5.m4.2a"><mrow id="S2.I1.i3.p1.5.m4.2.2" xref="S2.I1.i3.p1.5.m4.2.2.cmml"><mrow id="S2.I1.i3.p1.5.m4.2.2.1" xref="S2.I1.i3.p1.5.m4.2.2.1.cmml"><mi id="S2.I1.i3.p1.5.m4.2.2.1.3" xref="S2.I1.i3.p1.5.m4.2.2.1.3.cmml">ℙ</mi><mo id="S2.I1.i3.p1.5.m4.2.2.1.2" xref="S2.I1.i3.p1.5.m4.2.2.1.2.cmml">⁢</mo><mrow id="S2.I1.i3.p1.5.m4.2.2.1.1.1" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.cmml"><mo id="S2.I1.i3.p1.5.m4.2.2.1.1.1.2" stretchy="false" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.cmml"><msub id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.cmml"><mi id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.2" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.2.cmml">s</mi><mrow id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.cmml"><mi id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.2" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.1" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.1.cmml">+</mo><mn id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.3" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.2" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.2.cmml">|</mo><mrow id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.2.cmml"><msub id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.2" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.3" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.2" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="S2.I1.i3.p1.5.m4.1.1" xref="S2.I1.i3.p1.5.m4.1.1.cmml">a</mi></mrow></mrow><mo id="S2.I1.i3.p1.5.m4.2.2.1.1.1.3" stretchy="false" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.I1.i3.p1.5.m4.2.2.2" xref="S2.I1.i3.p1.5.m4.2.2.2.cmml">=</mo><mn id="S2.I1.i3.p1.5.m4.2.2.3" xref="S2.I1.i3.p1.5.m4.2.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.5.m4.2b"><apply id="S2.I1.i3.p1.5.m4.2.2.cmml" xref="S2.I1.i3.p1.5.m4.2.2"><eq id="S2.I1.i3.p1.5.m4.2.2.2.cmml" xref="S2.I1.i3.p1.5.m4.2.2.2"></eq><apply id="S2.I1.i3.p1.5.m4.2.2.1.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1"><times id="S2.I1.i3.p1.5.m4.2.2.1.2.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.2"></times><ci id="S2.I1.i3.p1.5.m4.2.2.1.3.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.3">ℙ</ci><apply id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1"><csymbol cd="latexml" id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.2.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.2">conditional</csymbol><apply id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.1.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.2.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.2">𝑠</ci><apply id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3"><plus id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.1.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.1"></plus><ci id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.2.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.2">𝑡</ci><cn id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.3.3.3">1</cn></apply></apply><list id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.2.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1"><apply id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.I1.i3.p1.5.m4.2.2.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S2.I1.i3.p1.5.m4.1.1.cmml" xref="S2.I1.i3.p1.5.m4.1.1">𝑎</ci></list></apply></apply><cn id="S2.I1.i3.p1.5.m4.2.2.3.cmml" type="integer" xref="S2.I1.i3.p1.5.m4.2.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.5.m4.2c">\mathbb{P}(s_{t+1}|s_{t},a)=1</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.5.m4.2d">blackboard_P ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a ) = 1</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i4.p1">
<p class="ltx_p" id="S2.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i4.p1.1.1">Termination Condition</span>: The language generation process concludes when the terminal action <math alttext="\omega" class="ltx_Math" display="inline" id="S2.I1.i4.p1.1.m1.1"><semantics id="S2.I1.i4.p1.1.m1.1a"><mi id="S2.I1.i4.p1.1.m1.1.1" xref="S2.I1.i4.p1.1.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i4.p1.1.m1.1b"><ci id="S2.I1.i4.p1.1.m1.1.1.cmml" xref="S2.I1.i4.p1.1.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i4.p1.1.m1.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i4.p1.1.m1.1d">italic_ω</annotation></semantics></math>, typically the end-of-sentence token, is executed.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S2.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i5.p1">
<p class="ltx_p" id="S2.I1.i5.p1.3"><span class="ltx_text ltx_font_bold" id="S2.I1.i5.p1.1.1">Reward Function (<math alttext="R(s,a)" class="ltx_Math" display="inline" id="S2.I1.i5.p1.1.1.m1.2"><semantics id="S2.I1.i5.p1.1.1.m1.2a"><mrow id="S2.I1.i5.p1.1.1.m1.2.3" xref="S2.I1.i5.p1.1.1.m1.2.3.cmml"><mi id="S2.I1.i5.p1.1.1.m1.2.3.2" xref="S2.I1.i5.p1.1.1.m1.2.3.2.cmml">R</mi><mo id="S2.I1.i5.p1.1.1.m1.2.3.1" xref="S2.I1.i5.p1.1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.I1.i5.p1.1.1.m1.2.3.3.2" xref="S2.I1.i5.p1.1.1.m1.2.3.3.1.cmml"><mo id="S2.I1.i5.p1.1.1.m1.2.3.3.2.1" stretchy="false" xref="S2.I1.i5.p1.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.I1.i5.p1.1.1.m1.1.1" xref="S2.I1.i5.p1.1.1.m1.1.1.cmml">s</mi><mo id="S2.I1.i5.p1.1.1.m1.2.3.3.2.2" xref="S2.I1.i5.p1.1.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.I1.i5.p1.1.1.m1.2.2" xref="S2.I1.i5.p1.1.1.m1.2.2.cmml">a</mi><mo id="S2.I1.i5.p1.1.1.m1.2.3.3.2.3" stretchy="false" xref="S2.I1.i5.p1.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.1.1.m1.2b"><apply id="S2.I1.i5.p1.1.1.m1.2.3.cmml" xref="S2.I1.i5.p1.1.1.m1.2.3"><times id="S2.I1.i5.p1.1.1.m1.2.3.1.cmml" xref="S2.I1.i5.p1.1.1.m1.2.3.1"></times><ci id="S2.I1.i5.p1.1.1.m1.2.3.2.cmml" xref="S2.I1.i5.p1.1.1.m1.2.3.2">𝑅</ci><interval closure="open" id="S2.I1.i5.p1.1.1.m1.2.3.3.1.cmml" xref="S2.I1.i5.p1.1.1.m1.2.3.3.2"><ci id="S2.I1.i5.p1.1.1.m1.1.1.cmml" xref="S2.I1.i5.p1.1.1.m1.1.1">𝑠</ci><ci id="S2.I1.i5.p1.1.1.m1.2.2.cmml" xref="S2.I1.i5.p1.1.1.m1.2.2">𝑎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.1.1.m1.2c">R(s,a)</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i5.p1.1.1.m1.2d">italic_R ( italic_s , italic_a )</annotation></semantics></math>)</span>: This function offers scalar feedback to evaluate the agent’s performance after taking action <math alttext="a" class="ltx_Math" display="inline" id="S2.I1.i5.p1.2.m1.1"><semantics id="S2.I1.i5.p1.2.m1.1a"><mi id="S2.I1.i5.p1.2.m1.1.1" xref="S2.I1.i5.p1.2.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.2.m1.1b"><ci id="S2.I1.i5.p1.2.m1.1.1.cmml" xref="S2.I1.i5.p1.2.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.2.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i5.p1.2.m1.1d">italic_a</annotation></semantics></math> in state <math alttext="s" class="ltx_Math" display="inline" id="S2.I1.i5.p1.3.m2.1"><semantics id="S2.I1.i5.p1.3.m2.1a"><mi id="S2.I1.i5.p1.3.m2.1.1" xref="S2.I1.i5.p1.3.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i5.p1.3.m2.1b"><ci id="S2.I1.i5.p1.3.m2.1.1.cmml" xref="S2.I1.i5.p1.3.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i5.p1.3.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i5.p1.3.m2.1d">italic_s</annotation></semantics></math>. In the context of Reinforcement Learning from Human Feedback (RLHF)&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib23" title="">23</a>]</cite>, the reward function can be learned from human preferences or defined by a set of rules specific to the task.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S2.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i6.p1">
<p class="ltx_p" id="S2.I1.i6.p1.4"><span class="ltx_text ltx_font_bold" id="S2.I1.i6.p1.1.1">Initial State Distribution (<math alttext="d_{0}" class="ltx_Math" display="inline" id="S2.I1.i6.p1.1.1.m1.1"><semantics id="S2.I1.i6.p1.1.1.m1.1a"><msub id="S2.I1.i6.p1.1.1.m1.1.1" xref="S2.I1.i6.p1.1.1.m1.1.1.cmml"><mi id="S2.I1.i6.p1.1.1.m1.1.1.2" xref="S2.I1.i6.p1.1.1.m1.1.1.2.cmml">d</mi><mn id="S2.I1.i6.p1.1.1.m1.1.1.3" xref="S2.I1.i6.p1.1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i6.p1.1.1.m1.1b"><apply id="S2.I1.i6.p1.1.1.m1.1.1.cmml" xref="S2.I1.i6.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i6.p1.1.1.m1.1.1.1.cmml" xref="S2.I1.i6.p1.1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i6.p1.1.1.m1.1.1.2.cmml" xref="S2.I1.i6.p1.1.1.m1.1.1.2">𝑑</ci><cn id="S2.I1.i6.p1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.I1.i6.p1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i6.p1.1.1.m1.1c">d_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i6.p1.1.1.m1.1d">italic_d start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>)</span>: It is a probability distribution over prompts <math alttext="x" class="ltx_Math" display="inline" id="S2.I1.i6.p1.2.m1.1"><semantics id="S2.I1.i6.p1.2.m1.1a"><mi id="S2.I1.i6.p1.2.m1.1.1" xref="S2.I1.i6.p1.2.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i6.p1.2.m1.1b"><ci id="S2.I1.i6.p1.2.m1.1.1.cmml" xref="S2.I1.i6.p1.2.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i6.p1.2.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i6.p1.2.m1.1d">italic_x</annotation></semantics></math>. An initial state <math alttext="s_{0}" class="ltx_Math" display="inline" id="S2.I1.i6.p1.3.m2.1"><semantics id="S2.I1.i6.p1.3.m2.1a"><msub id="S2.I1.i6.p1.3.m2.1.1" xref="S2.I1.i6.p1.3.m2.1.1.cmml"><mi id="S2.I1.i6.p1.3.m2.1.1.2" xref="S2.I1.i6.p1.3.m2.1.1.2.cmml">s</mi><mn id="S2.I1.i6.p1.3.m2.1.1.3" xref="S2.I1.i6.p1.3.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i6.p1.3.m2.1b"><apply id="S2.I1.i6.p1.3.m2.1.1.cmml" xref="S2.I1.i6.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i6.p1.3.m2.1.1.1.cmml" xref="S2.I1.i6.p1.3.m2.1.1">subscript</csymbol><ci id="S2.I1.i6.p1.3.m2.1.1.2.cmml" xref="S2.I1.i6.p1.3.m2.1.1.2">𝑠</ci><cn id="S2.I1.i6.p1.3.m2.1.1.3.cmml" type="integer" xref="S2.I1.i6.p1.3.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i6.p1.3.m2.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i6.p1.3.m2.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> consists of the tokens within the prompt <math alttext="x" class="ltx_Math" display="inline" id="S2.I1.i6.p1.4.m3.1"><semantics id="S2.I1.i6.p1.4.m3.1a"><mi id="S2.I1.i6.p1.4.m3.1.1" xref="S2.I1.i6.p1.4.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i6.p1.4.m3.1b"><ci id="S2.I1.i6.p1.4.m3.1.1.cmml" xref="S2.I1.i6.p1.4.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i6.p1.4.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i6.p1.4.m3.1d">italic_x</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>RLHF Learning Objective</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.6">We formulate the optimization problem as a KL-regularized RL task. Our objective is to approximate the optimal KL-regularized policy, which is given by:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx1">
<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\pi^{*}=\arg\max_{\pi}\mathbb{E}_{\pi,s_{0}\sim d_{0}}\left[\sum_%
{t=0}^{H}\left(R(s_{t},a_{t})-\beta\text{KL}\big{(}\pi(\cdot|s_{t})\|\pi_{%
\text{ref}}(\cdot|s_{t})\big{)}\right)\right]" class="ltx_math_unparsed" display="inline" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2b"><msup id="S2.E1.m1.2.3"><mi id="S2.E1.m1.2.3.2">π</mi><mo id="S2.E1.m1.2.3.3">∗</mo></msup><mo id="S2.E1.m1.2.4">=</mo><mi id="S2.E1.m1.2.5">arg</mi><munder id="S2.E1.m1.2.6"><mi id="S2.E1.m1.2.6.2">max</mi><mi id="S2.E1.m1.2.6.3">π</mi></munder><msub id="S2.E1.m1.2.7"><mi id="S2.E1.m1.2.7.2">𝔼</mi><mrow id="S2.E1.m1.2.2.2"><mrow id="S2.E1.m1.2.2.2.2.1"><mi id="S2.E1.m1.1.1.1.1">π</mi><mo id="S2.E1.m1.2.2.2.2.1.2">,</mo><msub id="S2.E1.m1.2.2.2.2.1.1"><mi id="S2.E1.m1.2.2.2.2.1.1.2">s</mi><mn id="S2.E1.m1.2.2.2.2.1.1.3">0</mn></msub></mrow><mo id="S2.E1.m1.2.2.2.3">∼</mo><msub id="S2.E1.m1.2.2.2.4"><mi id="S2.E1.m1.2.2.2.4.2">d</mi><mn id="S2.E1.m1.2.2.2.4.3">0</mn></msub></mrow></msub><mrow id="S2.E1.m1.2.8"><mo id="S2.E1.m1.2.8.1">[</mo><mstyle displaystyle="true" id="S2.E1.m1.2.8.2"><munderover id="S2.E1.m1.2.8.2a"><mo id="S2.E1.m1.2.8.2.2.2" movablelimits="false">∑</mo><mrow id="S2.E1.m1.2.8.2.2.3"><mi id="S2.E1.m1.2.8.2.2.3.2">t</mi><mo id="S2.E1.m1.2.8.2.2.3.1">=</mo><mn id="S2.E1.m1.2.8.2.2.3.3">0</mn></mrow><mi id="S2.E1.m1.2.8.2.3">H</mi></munderover></mstyle><mrow id="S2.E1.m1.2.8.3"><mo id="S2.E1.m1.2.8.3.1">(</mo><mi id="S2.E1.m1.2.8.3.2">R</mi><mrow id="S2.E1.m1.2.8.3.3"><mo id="S2.E1.m1.2.8.3.3.1" stretchy="false">(</mo><msub id="S2.E1.m1.2.8.3.3.2"><mi id="S2.E1.m1.2.8.3.3.2.2">s</mi><mi id="S2.E1.m1.2.8.3.3.2.3">t</mi></msub><mo id="S2.E1.m1.2.8.3.3.3">,</mo><msub id="S2.E1.m1.2.8.3.3.4"><mi id="S2.E1.m1.2.8.3.3.4.2">a</mi><mi id="S2.E1.m1.2.8.3.3.4.3">t</mi></msub><mo id="S2.E1.m1.2.8.3.3.5" stretchy="false">)</mo></mrow><mo id="S2.E1.m1.2.8.3.4">−</mo><mi id="S2.E1.m1.2.8.3.5">β</mi><mtext id="S2.E1.m1.2.8.3.6">KL</mtext><mrow id="S2.E1.m1.2.8.3.7"><mo id="S2.E1.m1.2.8.3.7.1" maxsize="120%" minsize="120%">(</mo><mi id="S2.E1.m1.2.8.3.7.2">π</mi><mrow id="S2.E1.m1.2.8.3.7.3"><mo id="S2.E1.m1.2.8.3.7.3.1" stretchy="false">(</mo><mo id="S2.E1.m1.2.8.3.7.3.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S2.E1.m1.2.8.3.7.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="S2.E1.m1.2.8.3.7.3.4"><mi id="S2.E1.m1.2.8.3.7.3.4.2">s</mi><mi id="S2.E1.m1.2.8.3.7.3.4.3">t</mi></msub><mo id="S2.E1.m1.2.8.3.7.3.5" stretchy="false">)</mo></mrow><mo id="S2.E1.m1.2.8.3.7.4" lspace="0em" rspace="0.167em">∥</mo><msub id="S2.E1.m1.2.8.3.7.5"><mi id="S2.E1.m1.2.8.3.7.5.2">π</mi><mtext id="S2.E1.m1.2.8.3.7.5.3">ref</mtext></msub><mrow id="S2.E1.m1.2.8.3.7.6"><mo id="S2.E1.m1.2.8.3.7.6.1" stretchy="false">(</mo><mo id="S2.E1.m1.2.8.3.7.6.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S2.E1.m1.2.8.3.7.6.3" rspace="0.167em" stretchy="false">|</mo><msub id="S2.E1.m1.2.8.3.7.6.4"><mi id="S2.E1.m1.2.8.3.7.6.4.2">s</mi><mi id="S2.E1.m1.2.8.3.7.6.4.3">t</mi></msub><mo id="S2.E1.m1.2.8.3.7.6.5" stretchy="false">)</mo></mrow><mo id="S2.E1.m1.2.8.3.7.7" maxsize="120%" minsize="120%">)</mo></mrow><mo id="S2.E1.m1.2.8.3.8">)</mo></mrow><mo id="S2.E1.m1.2.8.4">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\displaystyle\pi^{*}=\arg\max_{\pi}\mathbb{E}_{\pi,s_{0}\sim d_{0}}\left[\sum_%
{t=0}^{H}\left(R(s_{t},a_{t})-\beta\text{KL}\big{(}\pi(\cdot|s_{t})\|\pi_{%
\text{ref}}(\cdot|s_{t})\big{)}\right)\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">italic_π start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT italic_π end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_π , italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∼ italic_d start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_H end_POSTSUPERSCRIPT ( italic_R ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) - italic_β KL ( italic_π ( ⋅ | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ∥ italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( ⋅ | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.5">In this equation, <math alttext="H" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_H</annotation></semantics></math> represents the total number of decision steps, <math alttext="s_{0}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">s</mi><mn id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝑠</ci><cn id="S2.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">s_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is a prompt sampled from the dataset, <math alttext="R(s_{t},a_{t})" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.2"><semantics id="S2.SS2.p1.3.m3.2a"><mrow id="S2.SS2.p1.3.m3.2.2" xref="S2.SS2.p1.3.m3.2.2.cmml"><mi id="S2.SS2.p1.3.m3.2.2.4" xref="S2.SS2.p1.3.m3.2.2.4.cmml">R</mi><mo id="S2.SS2.p1.3.m3.2.2.3" xref="S2.SS2.p1.3.m3.2.2.3.cmml">⁢</mo><mrow id="S2.SS2.p1.3.m3.2.2.2.2" xref="S2.SS2.p1.3.m3.2.2.2.3.cmml"><mo id="S2.SS2.p1.3.m3.2.2.2.2.3" stretchy="false" xref="S2.SS2.p1.3.m3.2.2.2.3.cmml">(</mo><msub id="S2.SS2.p1.3.m3.1.1.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.2" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.3.m3.1.1.1.1.1.3" xref="S2.SS2.p1.3.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS2.p1.3.m3.2.2.2.2.4" xref="S2.SS2.p1.3.m3.2.2.2.3.cmml">,</mo><msub id="S2.SS2.p1.3.m3.2.2.2.2.2" xref="S2.SS2.p1.3.m3.2.2.2.2.2.cmml"><mi id="S2.SS2.p1.3.m3.2.2.2.2.2.2" xref="S2.SS2.p1.3.m3.2.2.2.2.2.2.cmml">a</mi><mi id="S2.SS2.p1.3.m3.2.2.2.2.2.3" xref="S2.SS2.p1.3.m3.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS2.p1.3.m3.2.2.2.2.5" stretchy="false" xref="S2.SS2.p1.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.2b"><apply id="S2.SS2.p1.3.m3.2.2.cmml" xref="S2.SS2.p1.3.m3.2.2"><times id="S2.SS2.p1.3.m3.2.2.3.cmml" xref="S2.SS2.p1.3.m3.2.2.3"></times><ci id="S2.SS2.p1.3.m3.2.2.4.cmml" xref="S2.SS2.p1.3.m3.2.2.4">𝑅</ci><interval closure="open" id="S2.SS2.p1.3.m3.2.2.2.3.cmml" xref="S2.SS2.p1.3.m3.2.2.2.2"><apply id="S2.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.2">𝑠</ci><ci id="S2.SS2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS2.p1.3.m3.2.2.2.2.2.cmml" xref="S2.SS2.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.2.2.2.2.2.1.cmml" xref="S2.SS2.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.3.m3.2.2.2.2.2.2.cmml" xref="S2.SS2.p1.3.m3.2.2.2.2.2.2">𝑎</ci><ci id="S2.SS2.p1.3.m3.2.2.2.2.2.3.cmml" xref="S2.SS2.p1.3.m3.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.2c">R(s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.2d">italic_R ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is the token-level reward obtained from the reward function, <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><mi id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_β</annotation></semantics></math> is a coefficient that controls the strength of the KL-regularization, and <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><msub id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">π</mi><mtext id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">𝜋</ci><ci id="S2.SS2.p1.5.m5.1.1.3a.cmml" xref="S2.SS2.p1.5.m5.1.1.3"><mtext id="S2.SS2.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="S2.SS2.p1.5.m5.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> is the initialization policy.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">In traditional RLHF and most tasks related to LLMs, the reward is sparse and is only assigned at the terminal action <math alttext="\omega" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\omega</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_ω</annotation></semantics></math>, that is, the end-of-sentence token <span class="ltx_text ltx_font_typewriter" id="S2.SS2.p2.1.1">&lt;eos&gt;</span>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Proximal Policy Optimization</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">PPO <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib21" title="">21</a>]</cite> uses a clipped surrogate objective to update the policy. The key idea is to limit the change in the policy during each update step, preventing large policy updates that could lead to instability.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.3">Let <math alttext="\pi_{\theta}(a|s)" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><mrow id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><msub id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml"><mi id="S2.SS3.p2.1.m1.1.1.3.2" xref="S2.SS3.p2.1.m1.1.1.3.2.cmml">π</mi><mi id="S2.SS3.p2.1.m1.1.1.3.3" xref="S2.SS3.p2.1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS3.p2.1.m1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS3.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS3.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p2.1.m1.1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.SS3.p2.1.m1.1.1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS3.p2.1.m1.1.1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S2.SS3.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><times id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2"></times><apply id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.3.1.cmml" xref="S2.SS3.p2.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.3.2.cmml" xref="S2.SS3.p2.1.m1.1.1.3.2">𝜋</ci><ci id="S2.SS3.p2.1.m1.1.1.3.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S2.SS3.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.2">𝑎</ci><ci id="S2.SS3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\pi_{\theta}(a|s)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | italic_s )</annotation></semantics></math> be the policy parameterized by <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><mi id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_θ</annotation></semantics></math>, and <math alttext="\pi_{\theta_{\text{old}}}(a|s)" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.1"><semantics id="S2.SS3.p2.3.m3.1a"><mrow id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><msub id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml"><mi id="S2.SS3.p2.3.m3.1.1.3.2" xref="S2.SS3.p2.3.m3.1.1.3.2.cmml">π</mi><msub id="S2.SS3.p2.3.m3.1.1.3.3" xref="S2.SS3.p2.3.m3.1.1.3.3.cmml"><mi id="S2.SS3.p2.3.m3.1.1.3.3.2" xref="S2.SS3.p2.3.m3.1.1.3.3.2.cmml">θ</mi><mtext id="S2.SS3.p2.3.m3.1.1.3.3.3" xref="S2.SS3.p2.3.m3.1.1.3.3.3a.cmml">old</mtext></msub></msub><mo id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS3.p2.3.m3.1.1.1.1" xref="S2.SS3.p2.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS3.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS3.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p2.3.m3.1.1.1.1.1" xref="S2.SS3.p2.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1.1.1.1.2" xref="S2.SS3.p2.3.m3.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S2.SS3.p2.3.m3.1.1.1.1.1.1" xref="S2.SS3.p2.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS3.p2.3.m3.1.1.1.1.1.3" xref="S2.SS3.p2.3.m3.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S2.SS3.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS3.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><times id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2"></times><apply id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.3.1.cmml" xref="S2.SS3.p2.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.3.2.cmml" xref="S2.SS3.p2.3.m3.1.1.3.2">𝜋</ci><apply id="S2.SS3.p2.3.m3.1.1.3.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.3.3.1.cmml" xref="S2.SS3.p2.3.m3.1.1.3.3">subscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.3.3.2.cmml" xref="S2.SS3.p2.3.m3.1.1.3.3.2">𝜃</ci><ci id="S2.SS3.p2.3.m3.1.1.3.3.3a.cmml" xref="S2.SS3.p2.3.m3.1.1.3.3.3"><mtext id="S2.SS3.p2.3.m3.1.1.3.3.3.cmml" mathsize="50%" xref="S2.SS3.p2.3.m3.1.1.3.3.3">old</mtext></ci></apply></apply><apply id="S2.SS3.p2.3.m3.1.1.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS3.p2.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1.1.2">𝑎</ci><ci id="S2.SS3.p2.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">\pi_{\theta_{\text{old}}}(a|s)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT old end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_a | italic_s )</annotation></semantics></math> be the old policy from the previous iteration. The surrogate objective function for PPO is defined as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}^{CLIP}(\theta)=\hat{\mathbb{E}}_{t}\left[\min\left(r_{t}(\theta)%
\hat{A}_{t},\text{clip}(r_{t}(\theta),1-\epsilon,1+\epsilon)\hat{A}_{t}\right)\right]" class="ltx_Math" display="block" id="S2.E2.m1.5"><semantics id="S2.E2.m1.5a"><mrow id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml"><mrow id="S2.E2.m1.5.5.3" xref="S2.E2.m1.5.5.3.cmml"><msup id="S2.E2.m1.5.5.3.2" xref="S2.E2.m1.5.5.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.5.5.3.2.2" xref="S2.E2.m1.5.5.3.2.2.cmml">ℒ</mi><mrow id="S2.E2.m1.5.5.3.2.3" xref="S2.E2.m1.5.5.3.2.3.cmml"><mi id="S2.E2.m1.5.5.3.2.3.2" xref="S2.E2.m1.5.5.3.2.3.2.cmml">C</mi><mo id="S2.E2.m1.5.5.3.2.3.1" xref="S2.E2.m1.5.5.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.5.5.3.2.3.3" xref="S2.E2.m1.5.5.3.2.3.3.cmml">L</mi><mo id="S2.E2.m1.5.5.3.2.3.1a" xref="S2.E2.m1.5.5.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.5.5.3.2.3.4" xref="S2.E2.m1.5.5.3.2.3.4.cmml">I</mi><mo id="S2.E2.m1.5.5.3.2.3.1b" xref="S2.E2.m1.5.5.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.5.5.3.2.3.5" xref="S2.E2.m1.5.5.3.2.3.5.cmml">P</mi></mrow></msup><mo id="S2.E2.m1.5.5.3.1" xref="S2.E2.m1.5.5.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.3.3.2" xref="S2.E2.m1.5.5.3.cmml"><mo id="S2.E2.m1.5.5.3.3.2.1" stretchy="false" xref="S2.E2.m1.5.5.3.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">θ</mi><mo id="S2.E2.m1.5.5.3.3.2.2" stretchy="false" xref="S2.E2.m1.5.5.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.5.5.2" xref="S2.E2.m1.5.5.2.cmml">=</mo><mrow id="S2.E2.m1.5.5.1" xref="S2.E2.m1.5.5.1.cmml"><msub id="S2.E2.m1.5.5.1.3" xref="S2.E2.m1.5.5.1.3.cmml"><mover accent="true" id="S2.E2.m1.5.5.1.3.2" xref="S2.E2.m1.5.5.1.3.2.cmml"><mi id="S2.E2.m1.5.5.1.3.2.2" xref="S2.E2.m1.5.5.1.3.2.2.cmml">𝔼</mi><mo id="S2.E2.m1.5.5.1.3.2.1" xref="S2.E2.m1.5.5.1.3.2.1.cmml">^</mo></mover><mi id="S2.E2.m1.5.5.1.3.3" xref="S2.E2.m1.5.5.1.3.3.cmml">t</mi></msub><mo id="S2.E2.m1.5.5.1.2" xref="S2.E2.m1.5.5.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.1" xref="S2.E2.m1.5.5.1.1.2.cmml"><mo id="S2.E2.m1.5.5.1.1.1.2" xref="S2.E2.m1.5.5.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.3.cmml"><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">min</mi><mo id="S2.E2.m1.5.5.1.1.1.1.2a" xref="S2.E2.m1.5.5.1.1.1.1.3.cmml">⁡</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.2.2" xref="S2.E2.m1.5.5.1.1.1.1.3.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.3" xref="S2.E2.m1.5.5.1.1.1.1.3.cmml">(</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.2.cmml">r</mi><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">θ</mi><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1a" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2.2.cmml">A</mi><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.3.cmml">t</mi></msub></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.4" xref="S2.E2.m1.5.5.1.1.1.1.3.cmml">,</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.2.2.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.cmml"><mtext id="S2.E2.m1.5.5.1.1.1.1.2.2.2.5" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.5a.cmml">clip</mtext><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.4" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.4.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.4.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.4" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.4.cmml">(</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.cmml"><msub id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.2.cmml">r</mi><mi id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.3" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.3.cmml">t</mi></msub><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.3.2.1" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">θ</mi><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.3.2.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.5" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.4.cmml">,</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.cmml"><mn id="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.2.cmml">1</mn><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.1" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.1.cmml">−</mo><mi id="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.3" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.3.cmml">ϵ</mi></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.6" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.4.cmml">,</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.cmml"><mn id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.2.cmml">1</mn><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.1" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.1.cmml">+</mo><mi id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.3" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.3.cmml">ϵ</mi></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.7" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.4.cmml">)</mo></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.4a" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.4.cmml">⁢</mo><msub id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.cmml"><mover accent="true" id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2.2.cmml">A</mi><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2.1" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2.1.cmml">^</mo></mover><mi id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.3" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.3.cmml">t</mi></msub></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.5" xref="S2.E2.m1.5.5.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.5.5.1.1.1.3" xref="S2.E2.m1.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.5b"><apply id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5"><eq id="S2.E2.m1.5.5.2.cmml" xref="S2.E2.m1.5.5.2"></eq><apply id="S2.E2.m1.5.5.3.cmml" xref="S2.E2.m1.5.5.3"><times id="S2.E2.m1.5.5.3.1.cmml" xref="S2.E2.m1.5.5.3.1"></times><apply id="S2.E2.m1.5.5.3.2.cmml" xref="S2.E2.m1.5.5.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.3.2.1.cmml" xref="S2.E2.m1.5.5.3.2">superscript</csymbol><ci id="S2.E2.m1.5.5.3.2.2.cmml" xref="S2.E2.m1.5.5.3.2.2">ℒ</ci><apply id="S2.E2.m1.5.5.3.2.3.cmml" xref="S2.E2.m1.5.5.3.2.3"><times id="S2.E2.m1.5.5.3.2.3.1.cmml" xref="S2.E2.m1.5.5.3.2.3.1"></times><ci id="S2.E2.m1.5.5.3.2.3.2.cmml" xref="S2.E2.m1.5.5.3.2.3.2">𝐶</ci><ci id="S2.E2.m1.5.5.3.2.3.3.cmml" xref="S2.E2.m1.5.5.3.2.3.3">𝐿</ci><ci id="S2.E2.m1.5.5.3.2.3.4.cmml" xref="S2.E2.m1.5.5.3.2.3.4">𝐼</ci><ci id="S2.E2.m1.5.5.3.2.3.5.cmml" xref="S2.E2.m1.5.5.3.2.3.5">𝑃</ci></apply></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝜃</ci></apply><apply id="S2.E2.m1.5.5.1.cmml" xref="S2.E2.m1.5.5.1"><times id="S2.E2.m1.5.5.1.2.cmml" xref="S2.E2.m1.5.5.1.2"></times><apply id="S2.E2.m1.5.5.1.3.cmml" xref="S2.E2.m1.5.5.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.3.1.cmml" xref="S2.E2.m1.5.5.1.3">subscript</csymbol><apply id="S2.E2.m1.5.5.1.3.2.cmml" xref="S2.E2.m1.5.5.1.3.2"><ci id="S2.E2.m1.5.5.1.3.2.1.cmml" xref="S2.E2.m1.5.5.1.3.2.1">^</ci><ci id="S2.E2.m1.5.5.1.3.2.2.cmml" xref="S2.E2.m1.5.5.1.3.2.2">𝔼</ci></apply><ci id="S2.E2.m1.5.5.1.3.3.cmml" xref="S2.E2.m1.5.5.1.3.3">𝑡</ci></apply><apply id="S2.E2.m1.5.5.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2"><min id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"></min><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1"><times id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1"></times><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.2">𝑟</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝜃</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2"><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2.1">^</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.2.2">𝐴</ci></apply><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.4.3">𝑡</ci></apply></apply><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2"><times id="S2.E2.m1.5.5.1.1.1.1.2.2.2.4.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.4"></times><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.2.5a.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.5"><mtext id="S2.E2.m1.5.5.1.1.1.1.2.2.2.5.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.5">clip</mtext></ci><vector id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.4.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3"><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1"><times id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.1"></times><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.2">𝑟</ci><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.1.1.1.2.3">𝑡</ci></apply><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝜃</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2"><minus id="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.1"></minus><cn id="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.2.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.2">1</cn><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.2.2.2.3">italic-ϵ</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3"><plus id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.1"></plus><cn id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.2.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.2">1</cn><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.3.3.3.3">italic-ϵ</ci></apply></vector><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6">subscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2"><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2.1">^</ci><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.2.2">𝐴</ci></apply><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.6.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.5c">\mathcal{L}^{CLIP}(\theta)=\hat{\mathbb{E}}_{t}\left[\min\left(r_{t}(\theta)%
\hat{A}_{t},\text{clip}(r_{t}(\theta),1-\epsilon,1+\epsilon)\hat{A}_{t}\right)\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.5d">caligraphic_L start_POSTSUPERSCRIPT italic_C italic_L italic_I italic_P end_POSTSUPERSCRIPT ( italic_θ ) = over^ start_ARG blackboard_E end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT [ roman_min ( italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_θ ) over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , clip ( italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_θ ) , 1 - italic_ϵ , 1 + italic_ϵ ) over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.p4">
<p class="ltx_p" id="S2.SS3.p4.4">where <math alttext="r_{t}(\theta)=\frac{\pi_{\theta}(a_{t}|s_{t})}{\pi_{\theta_{\text{old}}}(a_{t}%
|s_{t})}" class="ltx_Math" display="inline" id="S2.SS3.p4.1.m1.3"><semantics id="S2.SS3.p4.1.m1.3a"><mrow id="S2.SS3.p4.1.m1.3.4" xref="S2.SS3.p4.1.m1.3.4.cmml"><mrow id="S2.SS3.p4.1.m1.3.4.2" xref="S2.SS3.p4.1.m1.3.4.2.cmml"><msub id="S2.SS3.p4.1.m1.3.4.2.2" xref="S2.SS3.p4.1.m1.3.4.2.2.cmml"><mi id="S2.SS3.p4.1.m1.3.4.2.2.2" xref="S2.SS3.p4.1.m1.3.4.2.2.2.cmml">r</mi><mi id="S2.SS3.p4.1.m1.3.4.2.2.3" xref="S2.SS3.p4.1.m1.3.4.2.2.3.cmml">t</mi></msub><mo id="S2.SS3.p4.1.m1.3.4.2.1" xref="S2.SS3.p4.1.m1.3.4.2.1.cmml">⁢</mo><mrow id="S2.SS3.p4.1.m1.3.4.2.3.2" xref="S2.SS3.p4.1.m1.3.4.2.cmml"><mo id="S2.SS3.p4.1.m1.3.4.2.3.2.1" stretchy="false" xref="S2.SS3.p4.1.m1.3.4.2.cmml">(</mo><mi id="S2.SS3.p4.1.m1.3.3" xref="S2.SS3.p4.1.m1.3.3.cmml">θ</mi><mo id="S2.SS3.p4.1.m1.3.4.2.3.2.2" stretchy="false" xref="S2.SS3.p4.1.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p4.1.m1.3.4.1" xref="S2.SS3.p4.1.m1.3.4.1.cmml">=</mo><mfrac id="S2.SS3.p4.1.m1.2.2" xref="S2.SS3.p4.1.m1.2.2.cmml"><mrow id="S2.SS3.p4.1.m1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.cmml"><msub id="S2.SS3.p4.1.m1.1.1.1.3" xref="S2.SS3.p4.1.m1.1.1.1.3.cmml"><mi id="S2.SS3.p4.1.m1.1.1.1.3.2" xref="S2.SS3.p4.1.m1.1.1.1.3.2.cmml">π</mi><mi id="S2.SS3.p4.1.m1.1.1.1.3.3" xref="S2.SS3.p4.1.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S2.SS3.p4.1.m1.1.1.1.2" xref="S2.SS3.p4.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS3.p4.1.m1.1.1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.cmml"><mo id="S2.SS3.p4.1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.p4.1.m1.1.1.1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.cmml"><msub id="S2.SS3.p4.1.m1.1.1.1.1.1.1.2" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.2" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.3" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.SS3.p4.1.m1.1.1.1.1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.SS3.p4.1.m1.1.1.1.1.1.1.3" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.2" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.3" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.SS3.p4.1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.SS3.p4.1.m1.2.2.2" xref="S2.SS3.p4.1.m1.2.2.2.cmml"><msub id="S2.SS3.p4.1.m1.2.2.2.3" xref="S2.SS3.p4.1.m1.2.2.2.3.cmml"><mi id="S2.SS3.p4.1.m1.2.2.2.3.2" xref="S2.SS3.p4.1.m1.2.2.2.3.2.cmml">π</mi><msub id="S2.SS3.p4.1.m1.2.2.2.3.3" xref="S2.SS3.p4.1.m1.2.2.2.3.3.cmml"><mi id="S2.SS3.p4.1.m1.2.2.2.3.3.2" xref="S2.SS3.p4.1.m1.2.2.2.3.3.2.cmml">θ</mi><mtext id="S2.SS3.p4.1.m1.2.2.2.3.3.3" xref="S2.SS3.p4.1.m1.2.2.2.3.3.3a.cmml">old</mtext></msub></msub><mo id="S2.SS3.p4.1.m1.2.2.2.2" xref="S2.SS3.p4.1.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.SS3.p4.1.m1.2.2.2.1.1" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.cmml"><mo id="S2.SS3.p4.1.m1.2.2.2.1.1.2" stretchy="false" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS3.p4.1.m1.2.2.2.1.1.1" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.cmml"><msub id="S2.SS3.p4.1.m1.2.2.2.1.1.1.2" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.cmml"><mi id="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.2" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.2.cmml">a</mi><mi id="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.3" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.cmml">|</mo><msub id="S2.SS3.p4.1.m1.2.2.2.1.1.1.3" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.cmml"><mi id="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.2" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.2.cmml">s</mi><mi id="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.3" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.SS3.p4.1.m1.2.2.2.1.1.3" stretchy="false" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.1.m1.3b"><apply id="S2.SS3.p4.1.m1.3.4.cmml" xref="S2.SS3.p4.1.m1.3.4"><eq id="S2.SS3.p4.1.m1.3.4.1.cmml" xref="S2.SS3.p4.1.m1.3.4.1"></eq><apply id="S2.SS3.p4.1.m1.3.4.2.cmml" xref="S2.SS3.p4.1.m1.3.4.2"><times id="S2.SS3.p4.1.m1.3.4.2.1.cmml" xref="S2.SS3.p4.1.m1.3.4.2.1"></times><apply id="S2.SS3.p4.1.m1.3.4.2.2.cmml" xref="S2.SS3.p4.1.m1.3.4.2.2"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.3.4.2.2.1.cmml" xref="S2.SS3.p4.1.m1.3.4.2.2">subscript</csymbol><ci id="S2.SS3.p4.1.m1.3.4.2.2.2.cmml" xref="S2.SS3.p4.1.m1.3.4.2.2.2">𝑟</ci><ci id="S2.SS3.p4.1.m1.3.4.2.2.3.cmml" xref="S2.SS3.p4.1.m1.3.4.2.2.3">𝑡</ci></apply><ci id="S2.SS3.p4.1.m1.3.3.cmml" xref="S2.SS3.p4.1.m1.3.3">𝜃</ci></apply><apply id="S2.SS3.p4.1.m1.2.2.cmml" xref="S2.SS3.p4.1.m1.2.2"><divide id="S2.SS3.p4.1.m1.2.2.3.cmml" xref="S2.SS3.p4.1.m1.2.2"></divide><apply id="S2.SS3.p4.1.m1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1"><times id="S2.SS3.p4.1.m1.1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.1.1.2"></times><apply id="S2.SS3.p4.1.m1.1.1.1.3.cmml" xref="S2.SS3.p4.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.1.1.1.3.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1.3">subscript</csymbol><ci id="S2.SS3.p4.1.m1.1.1.1.3.2.cmml" xref="S2.SS3.p4.1.m1.1.1.1.3.2">𝜋</ci><ci id="S2.SS3.p4.1.m1.1.1.1.3.3.cmml" xref="S2.SS3.p4.1.m1.1.1.1.3.3">𝜃</ci></apply><apply id="S2.SS3.p4.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS3.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S2.SS3.p4.1.m1.2.2.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2"><times id="S2.SS3.p4.1.m1.2.2.2.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.2"></times><apply id="S2.SS3.p4.1.m1.2.2.2.3.cmml" xref="S2.SS3.p4.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.2.2.2.3.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.3">subscript</csymbol><ci id="S2.SS3.p4.1.m1.2.2.2.3.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.3.2">𝜋</ci><apply id="S2.SS3.p4.1.m1.2.2.2.3.3.cmml" xref="S2.SS3.p4.1.m1.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.2.2.2.3.3.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.3.3">subscript</csymbol><ci id="S2.SS3.p4.1.m1.2.2.2.3.3.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.3.3.2">𝜃</ci><ci id="S2.SS3.p4.1.m1.2.2.2.3.3.3a.cmml" xref="S2.SS3.p4.1.m1.2.2.2.3.3.3"><mtext id="S2.SS3.p4.1.m1.2.2.2.3.3.3.cmml" mathsize="50%" xref="S2.SS3.p4.1.m1.2.2.2.3.3.3">old</mtext></ci></apply></apply><apply id="S2.SS3.p4.1.m1.2.2.2.1.1.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1"><csymbol cd="latexml" id="S2.SS3.p4.1.m1.2.2.2.1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.1">conditional</csymbol><apply id="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.2">subscript</csymbol><ci id="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.2">𝑎</ci><ci id="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.3.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.1.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.2.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.2">𝑠</ci><ci id="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.3.cmml" xref="S2.SS3.p4.1.m1.2.2.2.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.1.m1.3c">r_{t}(\theta)=\frac{\pi_{\theta}(a_{t}|s_{t})}{\pi_{\theta_{\text{old}}}(a_{t}%
|s_{t})}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.1.m1.3d">italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_θ ) = divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT old end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math> is the probability ratio, <math alttext="\hat{A}_{t}" class="ltx_Math" display="inline" id="S2.SS3.p4.2.m2.1"><semantics id="S2.SS3.p4.2.m2.1a"><msub id="S2.SS3.p4.2.m2.1.1" xref="S2.SS3.p4.2.m2.1.1.cmml"><mover accent="true" id="S2.SS3.p4.2.m2.1.1.2" xref="S2.SS3.p4.2.m2.1.1.2.cmml"><mi id="S2.SS3.p4.2.m2.1.1.2.2" xref="S2.SS3.p4.2.m2.1.1.2.2.cmml">A</mi><mo id="S2.SS3.p4.2.m2.1.1.2.1" xref="S2.SS3.p4.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.p4.2.m2.1.1.3" xref="S2.SS3.p4.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.2.m2.1b"><apply id="S2.SS3.p4.2.m2.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.2.m2.1.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1">subscript</csymbol><apply id="S2.SS3.p4.2.m2.1.1.2.cmml" xref="S2.SS3.p4.2.m2.1.1.2"><ci id="S2.SS3.p4.2.m2.1.1.2.1.cmml" xref="S2.SS3.p4.2.m2.1.1.2.1">^</ci><ci id="S2.SS3.p4.2.m2.1.1.2.2.cmml" xref="S2.SS3.p4.2.m2.1.1.2.2">𝐴</ci></apply><ci id="S2.SS3.p4.2.m2.1.1.3.cmml" xref="S2.SS3.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.2.m2.1c">\hat{A}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.2.m2.1d">over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the estimated advantage at time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.p4.3.m3.1"><semantics id="S2.SS3.p4.3.m3.1a"><mi id="S2.SS3.p4.3.m3.1.1" xref="S2.SS3.p4.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.3.m3.1b"><ci id="S2.SS3.p4.3.m3.1.1.cmml" xref="S2.SS3.p4.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.3.m3.1d">italic_t</annotation></semantics></math>, and <math alttext="\epsilon" class="ltx_Math" display="inline" id="S2.SS3.p4.4.m4.1"><semantics id="S2.SS3.p4.4.m4.1a"><mi id="S2.SS3.p4.4.m4.1.1" xref="S2.SS3.p4.4.m4.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.4.m4.1b"><ci id="S2.SS3.p4.4.m4.1.1.cmml" xref="S2.SS3.p4.4.m4.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.4.m4.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.4.m4.1d">italic_ϵ</annotation></semantics></math> is a hyperparameter that controls the clipping range.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S2.SS3.p5">
<p class="ltx_p" id="S2.SS3.p5.3">Generalized Advantage Estimation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib20" title="">20</a>]</cite> is a technique used to estimate the advantage function more accurately in PPO. It combines multiple-step bootstrapping to reduce the variance of the advantage estimates. For a trajectory of length <math alttext="T" class="ltx_Math" display="inline" id="S2.SS3.p5.1.m1.1"><semantics id="S2.SS3.p5.1.m1.1a"><mi id="S2.SS3.p5.1.m1.1.1" xref="S2.SS3.p5.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.1.m1.1b"><ci id="S2.SS3.p5.1.m1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.1.m1.1d">italic_T</annotation></semantics></math>, the advantage estimate <math alttext="\hat{A}_{t}" class="ltx_Math" display="inline" id="S2.SS3.p5.2.m2.1"><semantics id="S2.SS3.p5.2.m2.1a"><msub id="S2.SS3.p5.2.m2.1.1" xref="S2.SS3.p5.2.m2.1.1.cmml"><mover accent="true" id="S2.SS3.p5.2.m2.1.1.2" xref="S2.SS3.p5.2.m2.1.1.2.cmml"><mi id="S2.SS3.p5.2.m2.1.1.2.2" xref="S2.SS3.p5.2.m2.1.1.2.2.cmml">A</mi><mo id="S2.SS3.p5.2.m2.1.1.2.1" xref="S2.SS3.p5.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS3.p5.2.m2.1.1.3" xref="S2.SS3.p5.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.2.m2.1b"><apply id="S2.SS3.p5.2.m2.1.1.cmml" xref="S2.SS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p5.2.m2.1.1.1.cmml" xref="S2.SS3.p5.2.m2.1.1">subscript</csymbol><apply id="S2.SS3.p5.2.m2.1.1.2.cmml" xref="S2.SS3.p5.2.m2.1.1.2"><ci id="S2.SS3.p5.2.m2.1.1.2.1.cmml" xref="S2.SS3.p5.2.m2.1.1.2.1">^</ci><ci id="S2.SS3.p5.2.m2.1.1.2.2.cmml" xref="S2.SS3.p5.2.m2.1.1.2.2">𝐴</ci></apply><ci id="S2.SS3.p5.2.m2.1.1.3.cmml" xref="S2.SS3.p5.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.2.m2.1c">\hat{A}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.2.m2.1d">over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.p5.3.m3.1"><semantics id="S2.SS3.p5.3.m3.1a"><mi id="S2.SS3.p5.3.m3.1.1" xref="S2.SS3.p5.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.3.m3.1b"><ci id="S2.SS3.p5.3.m3.1.1.cmml" xref="S2.SS3.p5.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.3.m3.1d">italic_t</annotation></semantics></math> is computed as:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S2.SS3.p6">
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{A}_{t}=\sum_{l=0}^{T-t-1}(\gamma\lambda)^{l}\delta_{t+l}" class="ltx_Math" display="block" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><msub id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml"><mover accent="true" id="S2.E3.m1.1.1.3.2" xref="S2.E3.m1.1.1.3.2.cmml"><mi id="S2.E3.m1.1.1.3.2.2" xref="S2.E3.m1.1.1.3.2.2.cmml">A</mi><mo id="S2.E3.m1.1.1.3.2.1" xref="S2.E3.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.E3.m1.1.1.3.3" xref="S2.E3.m1.1.1.3.3.cmml">t</mi></msub><mo id="S2.E3.m1.1.1.2" rspace="0.111em" xref="S2.E3.m1.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><munderover id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.cmml"><mo id="S2.E3.m1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S2.E3.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.1.1.1.2.2.3" xref="S2.E3.m1.1.1.1.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.2.2.3.2" xref="S2.E3.m1.1.1.1.2.2.3.2.cmml">l</mi><mo id="S2.E3.m1.1.1.1.2.2.3.1" xref="S2.E3.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.1.1.1.2.2.3.3" xref="S2.E3.m1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="S2.E3.m1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.2.3.cmml"><mi id="S2.E3.m1.1.1.1.2.3.2" xref="S2.E3.m1.1.1.1.2.3.2.cmml">T</mi><mo id="S2.E3.m1.1.1.1.2.3.1" xref="S2.E3.m1.1.1.1.2.3.1.cmml">−</mo><mi id="S2.E3.m1.1.1.1.2.3.3" xref="S2.E3.m1.1.1.1.2.3.3.cmml">t</mi><mo id="S2.E3.m1.1.1.1.2.3.1a" xref="S2.E3.m1.1.1.1.2.3.1.cmml">−</mo><mn id="S2.E3.m1.1.1.1.2.3.4" xref="S2.E3.m1.1.1.1.2.3.4.cmml">1</mn></mrow></munderover><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><msup id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml">γ</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml">⁢</mo><msub id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml">δ</mi><mrow id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.3.2" xref="S2.E3.m1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.E3.m1.1.1.1.1.3.3.1" xref="S2.E3.m1.1.1.1.1.3.3.1.cmml">+</mo><mi id="S2.E3.m1.1.1.1.1.3.3.3" xref="S2.E3.m1.1.1.1.1.3.3.3.cmml">l</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><eq id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2"></eq><apply id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.3">subscript</csymbol><apply id="S2.E3.m1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.3.2"><ci id="S2.E3.m1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.3.2.1">^</ci><ci id="S2.E3.m1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.3.2.2">𝐴</ci></apply><ci id="S2.E3.m1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.3.3">𝑡</ci></apply><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><apply id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.1.1.1.2.2.2"></sum><apply id="S2.E3.m1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.1.2.2.3"><eq id="S2.E3.m1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m1.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m1.1.1.1.2.2.3.2.cmml" xref="S2.E3.m1.1.1.1.2.2.3.2">𝑙</ci><cn id="S2.E3.m1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="S2.E3.m1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.2.3"><minus id="S2.E3.m1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.1.1.1.2.3.1"></minus><ci id="S2.E3.m1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.1.1.1.2.3.2">𝑇</ci><ci id="S2.E3.m1.1.1.1.2.3.3.cmml" xref="S2.E3.m1.1.1.1.2.3.3">𝑡</ci><cn id="S2.E3.m1.1.1.1.2.3.4.cmml" type="integer" xref="S2.E3.m1.1.1.1.2.3.4">1</cn></apply></apply><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2"></times><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2">𝛾</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3">𝜆</ci></apply><ci id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2">𝛿</ci><apply id="S2.E3.m1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3"><plus id="S2.E3.m1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3.3.1"></plus><ci id="S2.E3.m1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.3.2">𝑡</ci><ci id="S2.E3.m1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\hat{A}_{t}=\sum_{l=0}^{T-t-1}(\gamma\lambda)^{l}\delta_{t+l}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_l = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T - italic_t - 1 end_POSTSUPERSCRIPT ( italic_γ italic_λ ) start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_δ start_POSTSUBSCRIPT italic_t + italic_l end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.p7">
<p class="ltx_p" id="S2.SS3.p7.8">where <math alttext="\gamma" class="ltx_Math" display="inline" id="S2.SS3.p7.1.m1.1"><semantics id="S2.SS3.p7.1.m1.1a"><mi id="S2.SS3.p7.1.m1.1.1" xref="S2.SS3.p7.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.1.m1.1b"><ci id="S2.SS3.p7.1.m1.1.1.cmml" xref="S2.SS3.p7.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.1.m1.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.1.m1.1d">italic_γ</annotation></semantics></math> is the discount factor, <math alttext="\lambda\in[0,1]" class="ltx_Math" display="inline" id="S2.SS3.p7.2.m2.2"><semantics id="S2.SS3.p7.2.m2.2a"><mrow id="S2.SS3.p7.2.m2.2.3" xref="S2.SS3.p7.2.m2.2.3.cmml"><mi id="S2.SS3.p7.2.m2.2.3.2" xref="S2.SS3.p7.2.m2.2.3.2.cmml">λ</mi><mo id="S2.SS3.p7.2.m2.2.3.1" xref="S2.SS3.p7.2.m2.2.3.1.cmml">∈</mo><mrow id="S2.SS3.p7.2.m2.2.3.3.2" xref="S2.SS3.p7.2.m2.2.3.3.1.cmml"><mo id="S2.SS3.p7.2.m2.2.3.3.2.1" stretchy="false" xref="S2.SS3.p7.2.m2.2.3.3.1.cmml">[</mo><mn id="S2.SS3.p7.2.m2.1.1" xref="S2.SS3.p7.2.m2.1.1.cmml">0</mn><mo id="S2.SS3.p7.2.m2.2.3.3.2.2" xref="S2.SS3.p7.2.m2.2.3.3.1.cmml">,</mo><mn id="S2.SS3.p7.2.m2.2.2" xref="S2.SS3.p7.2.m2.2.2.cmml">1</mn><mo id="S2.SS3.p7.2.m2.2.3.3.2.3" stretchy="false" xref="S2.SS3.p7.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.2.m2.2b"><apply id="S2.SS3.p7.2.m2.2.3.cmml" xref="S2.SS3.p7.2.m2.2.3"><in id="S2.SS3.p7.2.m2.2.3.1.cmml" xref="S2.SS3.p7.2.m2.2.3.1"></in><ci id="S2.SS3.p7.2.m2.2.3.2.cmml" xref="S2.SS3.p7.2.m2.2.3.2">𝜆</ci><interval closure="closed" id="S2.SS3.p7.2.m2.2.3.3.1.cmml" xref="S2.SS3.p7.2.m2.2.3.3.2"><cn id="S2.SS3.p7.2.m2.1.1.cmml" type="integer" xref="S2.SS3.p7.2.m2.1.1">0</cn><cn id="S2.SS3.p7.2.m2.2.2.cmml" type="integer" xref="S2.SS3.p7.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.2.m2.2c">\lambda\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.2.m2.2d">italic_λ ∈ [ 0 , 1 ]</annotation></semantics></math> is the GAE parameter, and <math alttext="\delta_{t}=R(s_{t},a_{t})+\gamma V(s_{t+1})-V(s_{t})" class="ltx_Math" display="inline" id="S2.SS3.p7.3.m3.4"><semantics id="S2.SS3.p7.3.m3.4a"><mrow id="S2.SS3.p7.3.m3.4.4" xref="S2.SS3.p7.3.m3.4.4.cmml"><msub id="S2.SS3.p7.3.m3.4.4.6" xref="S2.SS3.p7.3.m3.4.4.6.cmml"><mi id="S2.SS3.p7.3.m3.4.4.6.2" xref="S2.SS3.p7.3.m3.4.4.6.2.cmml">δ</mi><mi id="S2.SS3.p7.3.m3.4.4.6.3" xref="S2.SS3.p7.3.m3.4.4.6.3.cmml">t</mi></msub><mo id="S2.SS3.p7.3.m3.4.4.5" xref="S2.SS3.p7.3.m3.4.4.5.cmml">=</mo><mrow id="S2.SS3.p7.3.m3.4.4.4" xref="S2.SS3.p7.3.m3.4.4.4.cmml"><mrow id="S2.SS3.p7.3.m3.3.3.3.3" xref="S2.SS3.p7.3.m3.3.3.3.3.cmml"><mrow id="S2.SS3.p7.3.m3.2.2.2.2.2" xref="S2.SS3.p7.3.m3.2.2.2.2.2.cmml"><mi id="S2.SS3.p7.3.m3.2.2.2.2.2.4" xref="S2.SS3.p7.3.m3.2.2.2.2.2.4.cmml">R</mi><mo id="S2.SS3.p7.3.m3.2.2.2.2.2.3" xref="S2.SS3.p7.3.m3.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.3.cmml"><mo id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.3" stretchy="false" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.3.cmml">(</mo><msub id="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1" xref="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.2" xref="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.3" xref="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.4" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.3.cmml">,</mo><msub id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.cmml"><mi id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.2" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.2.cmml">a</mi><mi id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.3" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.5" stretchy="false" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p7.3.m3.3.3.3.3.4" xref="S2.SS3.p7.3.m3.3.3.3.3.4.cmml">+</mo><mrow id="S2.SS3.p7.3.m3.3.3.3.3.3" xref="S2.SS3.p7.3.m3.3.3.3.3.3.cmml"><mi id="S2.SS3.p7.3.m3.3.3.3.3.3.3" xref="S2.SS3.p7.3.m3.3.3.3.3.3.3.cmml">γ</mi><mo id="S2.SS3.p7.3.m3.3.3.3.3.3.2" xref="S2.SS3.p7.3.m3.3.3.3.3.3.2.cmml">⁢</mo><mi id="S2.SS3.p7.3.m3.3.3.3.3.3.4" xref="S2.SS3.p7.3.m3.3.3.3.3.3.4.cmml">V</mi><mo id="S2.SS3.p7.3.m3.3.3.3.3.3.2a" xref="S2.SS3.p7.3.m3.3.3.3.3.3.2.cmml">⁢</mo><mrow id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.cmml"><mo id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.2" stretchy="false" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.cmml">(</mo><msub id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.cmml"><mi id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.2" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.2.cmml">s</mi><mrow id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.cmml"><mi id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.2" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.2.cmml">t</mi><mo id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.1" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.1.cmml">+</mo><mn id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.3" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.3" stretchy="false" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS3.p7.3.m3.4.4.4.5" xref="S2.SS3.p7.3.m3.4.4.4.5.cmml">−</mo><mrow id="S2.SS3.p7.3.m3.4.4.4.4" xref="S2.SS3.p7.3.m3.4.4.4.4.cmml"><mi id="S2.SS3.p7.3.m3.4.4.4.4.3" xref="S2.SS3.p7.3.m3.4.4.4.4.3.cmml">V</mi><mo id="S2.SS3.p7.3.m3.4.4.4.4.2" xref="S2.SS3.p7.3.m3.4.4.4.4.2.cmml">⁢</mo><mrow id="S2.SS3.p7.3.m3.4.4.4.4.1.1" xref="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.cmml"><mo id="S2.SS3.p7.3.m3.4.4.4.4.1.1.2" stretchy="false" xref="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.cmml">(</mo><msub id="S2.SS3.p7.3.m3.4.4.4.4.1.1.1" xref="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.cmml"><mi id="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.2" xref="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.2.cmml">s</mi><mi id="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.3" xref="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS3.p7.3.m3.4.4.4.4.1.1.3" stretchy="false" xref="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.3.m3.4b"><apply id="S2.SS3.p7.3.m3.4.4.cmml" xref="S2.SS3.p7.3.m3.4.4"><eq id="S2.SS3.p7.3.m3.4.4.5.cmml" xref="S2.SS3.p7.3.m3.4.4.5"></eq><apply id="S2.SS3.p7.3.m3.4.4.6.cmml" xref="S2.SS3.p7.3.m3.4.4.6"><csymbol cd="ambiguous" id="S2.SS3.p7.3.m3.4.4.6.1.cmml" xref="S2.SS3.p7.3.m3.4.4.6">subscript</csymbol><ci id="S2.SS3.p7.3.m3.4.4.6.2.cmml" xref="S2.SS3.p7.3.m3.4.4.6.2">𝛿</ci><ci id="S2.SS3.p7.3.m3.4.4.6.3.cmml" xref="S2.SS3.p7.3.m3.4.4.6.3">𝑡</ci></apply><apply id="S2.SS3.p7.3.m3.4.4.4.cmml" xref="S2.SS3.p7.3.m3.4.4.4"><minus id="S2.SS3.p7.3.m3.4.4.4.5.cmml" xref="S2.SS3.p7.3.m3.4.4.4.5"></minus><apply id="S2.SS3.p7.3.m3.3.3.3.3.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3"><plus id="S2.SS3.p7.3.m3.3.3.3.3.4.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.4"></plus><apply id="S2.SS3.p7.3.m3.2.2.2.2.2.cmml" xref="S2.SS3.p7.3.m3.2.2.2.2.2"><times id="S2.SS3.p7.3.m3.2.2.2.2.2.3.cmml" xref="S2.SS3.p7.3.m3.2.2.2.2.2.3"></times><ci id="S2.SS3.p7.3.m3.2.2.2.2.2.4.cmml" xref="S2.SS3.p7.3.m3.2.2.2.2.2.4">𝑅</ci><interval closure="open" id="S2.SS3.p7.3.m3.2.2.2.2.2.2.3.cmml" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.2"><apply id="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p7.3.m3.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.1.cmml" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.2.cmml" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.2">𝑎</ci><ci id="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.3.cmml" xref="S2.SS3.p7.3.m3.2.2.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S2.SS3.p7.3.m3.3.3.3.3.3.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.3"><times id="S2.SS3.p7.3.m3.3.3.3.3.3.2.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.3.2"></times><ci id="S2.SS3.p7.3.m3.3.3.3.3.3.3.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.3.3">𝛾</ci><ci id="S2.SS3.p7.3.m3.3.3.3.3.3.4.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.3.4">𝑉</ci><apply id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.1.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1">subscript</csymbol><ci id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.2.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.2">𝑠</ci><apply id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3"><plus id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.1.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.1"></plus><ci id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.2.cmml" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.2">𝑡</ci><cn id="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.3.cmml" type="integer" xref="S2.SS3.p7.3.m3.3.3.3.3.3.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S2.SS3.p7.3.m3.4.4.4.4.cmml" xref="S2.SS3.p7.3.m3.4.4.4.4"><times id="S2.SS3.p7.3.m3.4.4.4.4.2.cmml" xref="S2.SS3.p7.3.m3.4.4.4.4.2"></times><ci id="S2.SS3.p7.3.m3.4.4.4.4.3.cmml" xref="S2.SS3.p7.3.m3.4.4.4.4.3">𝑉</ci><apply id="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.cmml" xref="S2.SS3.p7.3.m3.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.1.cmml" xref="S2.SS3.p7.3.m3.4.4.4.4.1.1">subscript</csymbol><ci id="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.2.cmml" xref="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.2">𝑠</ci><ci id="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.3.cmml" xref="S2.SS3.p7.3.m3.4.4.4.4.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.3.m3.4c">\delta_{t}=R(s_{t},a_{t})+\gamma V(s_{t+1})-V(s_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.3.m3.4d">italic_δ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_R ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) + italic_γ italic_V ( italic_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT ) - italic_V ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is the temporal-difference (TD) error. Here, <math alttext="R(s_{t},a_{t})" class="ltx_Math" display="inline" id="S2.SS3.p7.4.m4.2"><semantics id="S2.SS3.p7.4.m4.2a"><mrow id="S2.SS3.p7.4.m4.2.2" xref="S2.SS3.p7.4.m4.2.2.cmml"><mi id="S2.SS3.p7.4.m4.2.2.4" xref="S2.SS3.p7.4.m4.2.2.4.cmml">R</mi><mo id="S2.SS3.p7.4.m4.2.2.3" xref="S2.SS3.p7.4.m4.2.2.3.cmml">⁢</mo><mrow id="S2.SS3.p7.4.m4.2.2.2.2" xref="S2.SS3.p7.4.m4.2.2.2.3.cmml"><mo id="S2.SS3.p7.4.m4.2.2.2.2.3" stretchy="false" xref="S2.SS3.p7.4.m4.2.2.2.3.cmml">(</mo><msub id="S2.SS3.p7.4.m4.1.1.1.1.1" xref="S2.SS3.p7.4.m4.1.1.1.1.1.cmml"><mi id="S2.SS3.p7.4.m4.1.1.1.1.1.2" xref="S2.SS3.p7.4.m4.1.1.1.1.1.2.cmml">s</mi><mi id="S2.SS3.p7.4.m4.1.1.1.1.1.3" xref="S2.SS3.p7.4.m4.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.SS3.p7.4.m4.2.2.2.2.4" xref="S2.SS3.p7.4.m4.2.2.2.3.cmml">,</mo><msub id="S2.SS3.p7.4.m4.2.2.2.2.2" xref="S2.SS3.p7.4.m4.2.2.2.2.2.cmml"><mi id="S2.SS3.p7.4.m4.2.2.2.2.2.2" xref="S2.SS3.p7.4.m4.2.2.2.2.2.2.cmml">a</mi><mi id="S2.SS3.p7.4.m4.2.2.2.2.2.3" xref="S2.SS3.p7.4.m4.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS3.p7.4.m4.2.2.2.2.5" stretchy="false" xref="S2.SS3.p7.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.4.m4.2b"><apply id="S2.SS3.p7.4.m4.2.2.cmml" xref="S2.SS3.p7.4.m4.2.2"><times id="S2.SS3.p7.4.m4.2.2.3.cmml" xref="S2.SS3.p7.4.m4.2.2.3"></times><ci id="S2.SS3.p7.4.m4.2.2.4.cmml" xref="S2.SS3.p7.4.m4.2.2.4">𝑅</ci><interval closure="open" id="S2.SS3.p7.4.m4.2.2.2.3.cmml" xref="S2.SS3.p7.4.m4.2.2.2.2"><apply id="S2.SS3.p7.4.m4.1.1.1.1.1.cmml" xref="S2.SS3.p7.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p7.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS3.p7.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p7.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS3.p7.4.m4.1.1.1.1.1.2">𝑠</ci><ci id="S2.SS3.p7.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS3.p7.4.m4.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.SS3.p7.4.m4.2.2.2.2.2.cmml" xref="S2.SS3.p7.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p7.4.m4.2.2.2.2.2.1.cmml" xref="S2.SS3.p7.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p7.4.m4.2.2.2.2.2.2.cmml" xref="S2.SS3.p7.4.m4.2.2.2.2.2.2">𝑎</ci><ci id="S2.SS3.p7.4.m4.2.2.2.2.2.3.cmml" xref="S2.SS3.p7.4.m4.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.4.m4.2c">R(s_{t},a_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.4.m4.2d">italic_R ( italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> is the reward at time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.p7.5.m5.1"><semantics id="S2.SS3.p7.5.m5.1a"><mi id="S2.SS3.p7.5.m5.1.1" xref="S2.SS3.p7.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.5.m5.1b"><ci id="S2.SS3.p7.5.m5.1.1.cmml" xref="S2.SS3.p7.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.5.m5.1d">italic_t</annotation></semantics></math>, and <math alttext="V(s)" class="ltx_Math" display="inline" id="S2.SS3.p7.6.m6.1"><semantics id="S2.SS3.p7.6.m6.1a"><mrow id="S2.SS3.p7.6.m6.1.2" xref="S2.SS3.p7.6.m6.1.2.cmml"><mi id="S2.SS3.p7.6.m6.1.2.2" xref="S2.SS3.p7.6.m6.1.2.2.cmml">V</mi><mo id="S2.SS3.p7.6.m6.1.2.1" xref="S2.SS3.p7.6.m6.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.p7.6.m6.1.2.3.2" xref="S2.SS3.p7.6.m6.1.2.cmml"><mo id="S2.SS3.p7.6.m6.1.2.3.2.1" stretchy="false" xref="S2.SS3.p7.6.m6.1.2.cmml">(</mo><mi id="S2.SS3.p7.6.m6.1.1" xref="S2.SS3.p7.6.m6.1.1.cmml">s</mi><mo id="S2.SS3.p7.6.m6.1.2.3.2.2" stretchy="false" xref="S2.SS3.p7.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.6.m6.1b"><apply id="S2.SS3.p7.6.m6.1.2.cmml" xref="S2.SS3.p7.6.m6.1.2"><times id="S2.SS3.p7.6.m6.1.2.1.cmml" xref="S2.SS3.p7.6.m6.1.2.1"></times><ci id="S2.SS3.p7.6.m6.1.2.2.cmml" xref="S2.SS3.p7.6.m6.1.2.2">𝑉</ci><ci id="S2.SS3.p7.6.m6.1.1.cmml" xref="S2.SS3.p7.6.m6.1.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.6.m6.1c">V(s)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.6.m6.1d">italic_V ( italic_s )</annotation></semantics></math> is the value function. Since it is a common practice to use discount factor <math alttext="\gamma=1.0" class="ltx_Math" display="inline" id="S2.SS3.p7.7.m7.1"><semantics id="S2.SS3.p7.7.m7.1a"><mrow id="S2.SS3.p7.7.m7.1.1" xref="S2.SS3.p7.7.m7.1.1.cmml"><mi id="S2.SS3.p7.7.m7.1.1.2" xref="S2.SS3.p7.7.m7.1.1.2.cmml">γ</mi><mo id="S2.SS3.p7.7.m7.1.1.1" xref="S2.SS3.p7.7.m7.1.1.1.cmml">=</mo><mn id="S2.SS3.p7.7.m7.1.1.3" xref="S2.SS3.p7.7.m7.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.7.m7.1b"><apply id="S2.SS3.p7.7.m7.1.1.cmml" xref="S2.SS3.p7.7.m7.1.1"><eq id="S2.SS3.p7.7.m7.1.1.1.cmml" xref="S2.SS3.p7.7.m7.1.1.1"></eq><ci id="S2.SS3.p7.7.m7.1.1.2.cmml" xref="S2.SS3.p7.7.m7.1.1.2">𝛾</ci><cn id="S2.SS3.p7.7.m7.1.1.3.cmml" type="float" xref="S2.SS3.p7.7.m7.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.7.m7.1c">\gamma=1.0</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.7.m7.1d">italic_γ = 1.0</annotation></semantics></math> in RLHF, to simplify our notation, we omit <math alttext="\gamma" class="ltx_Math" display="inline" id="S2.SS3.p7.8.m8.1"><semantics id="S2.SS3.p7.8.m8.1a"><mi id="S2.SS3.p7.8.m8.1.1" xref="S2.SS3.p7.8.m8.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p7.8.m8.1b"><ci id="S2.SS3.p7.8.m8.1.1.cmml" xref="S2.SS3.p7.8.m8.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p7.8.m8.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p7.8.m8.1d">italic_γ</annotation></semantics></math> in later sections of this paper.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S3" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Challenges in Long-CoT RL for Reasoning Tasks</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Long-CoT tasks present unique challenges to RL training, especially for methods that employ a value model to reduce variance. In this section, we systematically analyze the technical issues arising from sequence length dynamics, value function instability, and reward sparsity.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Value Model Bias over Long Sequences</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">As identified in VC-PPO <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib30" title="">30</a>]</cite>, initializing the value model with a reward model introduces significant initialization bias. This positive bias arises from an objective mismatch between the two models. The reward model is trained to score on the <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.1">&lt;EOS&gt;</span> token, incentivizing it to assign lower scores to earlier tokens due to their incomplete context. In contrast, the value model estimates the expected cumulative reward for all tokens preceding <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.1.2">&lt;EOS&gt;</span> under a given policy. During early training phases, given the backward computation of GAE, there will be a positive bias at every timestep <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_t</annotation></semantics></math> that accumulates along the trajectory.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.5">Another standard practice of using GAE with <math alttext="\lambda=0.95" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">λ</mi><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><eq id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></eq><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝜆</ci><cn id="S3.SS1.p2.1.m1.1.1.3.cmml" type="float" xref="S3.SS1.p2.1.m1.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\lambda=0.95</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_λ = 0.95</annotation></semantics></math> might exacerbates this issue. The reward signal <math alttext="R(s_{T},\text{&lt;EOS&gt;})" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.2"><semantics id="S3.SS1.p2.2.m2.2a"><mrow id="S3.SS1.p2.2.m2.2.2" xref="S3.SS1.p2.2.m2.2.2.cmml"><mi id="S3.SS1.p2.2.m2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.3.cmml">R</mi><mo id="S3.SS1.p2.2.m2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.cmml">⁢</mo><mrow id="S3.SS1.p2.2.m2.2.2.1.1" xref="S3.SS1.p2.2.m2.2.2.1.2.cmml"><mo id="S3.SS1.p2.2.m2.2.2.1.1.2" stretchy="false" xref="S3.SS1.p2.2.m2.2.2.1.2.cmml">(</mo><msub id="S3.SS1.p2.2.m2.2.2.1.1.1" xref="S3.SS1.p2.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.2.2.1.1.1.2" xref="S3.SS1.p2.2.m2.2.2.1.1.1.2.cmml">s</mi><mi id="S3.SS1.p2.2.m2.2.2.1.1.1.3" xref="S3.SS1.p2.2.m2.2.2.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS1.p2.2.m2.2.2.1.1.3" xref="S3.SS1.p2.2.m2.2.2.1.2.cmml">,</mo><mtext id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1a.cmml">&lt;EOS&gt;</mtext><mo id="S3.SS1.p2.2.m2.2.2.1.1.4" stretchy="false" xref="S3.SS1.p2.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.2b"><apply id="S3.SS1.p2.2.m2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2"><times id="S3.SS1.p2.2.m2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2"></times><ci id="S3.SS1.p2.2.m2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.2.3">𝑅</ci><interval closure="open" id="S3.SS1.p2.2.m2.2.2.1.2.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1"><apply id="S3.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1.1.2">𝑠</ci><ci id="S3.SS1.p2.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.2.2.1.1.1.3">𝑇</ci></apply><ci id="S3.SS1.p2.2.m2.1.1a.cmml" xref="S3.SS1.p2.2.m2.1.1"><mtext id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">&lt;EOS&gt;</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.2c">R(s_{T},\text{&lt;EOS&gt;})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.2d">italic_R ( italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , &lt;EOS&gt; )</annotation></semantics></math> at the termination token propagates backward as <math alttext="\lambda^{T-t}R(s_{T},\text{&lt;EOS&gt;})" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.2"><semantics id="S3.SS1.p2.3.m3.2a"><mrow id="S3.SS1.p2.3.m3.2.2" xref="S3.SS1.p2.3.m3.2.2.cmml"><msup id="S3.SS1.p2.3.m3.2.2.3" xref="S3.SS1.p2.3.m3.2.2.3.cmml"><mi id="S3.SS1.p2.3.m3.2.2.3.2" xref="S3.SS1.p2.3.m3.2.2.3.2.cmml">λ</mi><mrow id="S3.SS1.p2.3.m3.2.2.3.3" xref="S3.SS1.p2.3.m3.2.2.3.3.cmml"><mi id="S3.SS1.p2.3.m3.2.2.3.3.2" xref="S3.SS1.p2.3.m3.2.2.3.3.2.cmml">T</mi><mo id="S3.SS1.p2.3.m3.2.2.3.3.1" xref="S3.SS1.p2.3.m3.2.2.3.3.1.cmml">−</mo><mi id="S3.SS1.p2.3.m3.2.2.3.3.3" xref="S3.SS1.p2.3.m3.2.2.3.3.3.cmml">t</mi></mrow></msup><mo id="S3.SS1.p2.3.m3.2.2.2" xref="S3.SS1.p2.3.m3.2.2.2.cmml">⁢</mo><mi id="S3.SS1.p2.3.m3.2.2.4" xref="S3.SS1.p2.3.m3.2.2.4.cmml">R</mi><mo id="S3.SS1.p2.3.m3.2.2.2a" xref="S3.SS1.p2.3.m3.2.2.2.cmml">⁢</mo><mrow id="S3.SS1.p2.3.m3.2.2.1.1" xref="S3.SS1.p2.3.m3.2.2.1.2.cmml"><mo id="S3.SS1.p2.3.m3.2.2.1.1.2" stretchy="false" xref="S3.SS1.p2.3.m3.2.2.1.2.cmml">(</mo><msub id="S3.SS1.p2.3.m3.2.2.1.1.1" xref="S3.SS1.p2.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.3.m3.2.2.1.1.1.2" xref="S3.SS1.p2.3.m3.2.2.1.1.1.2.cmml">s</mi><mi id="S3.SS1.p2.3.m3.2.2.1.1.1.3" xref="S3.SS1.p2.3.m3.2.2.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS1.p2.3.m3.2.2.1.1.3" xref="S3.SS1.p2.3.m3.2.2.1.2.cmml">,</mo><mtext id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1a.cmml">&lt;EOS&gt;</mtext><mo id="S3.SS1.p2.3.m3.2.2.1.1.4" stretchy="false" xref="S3.SS1.p2.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.2b"><apply id="S3.SS1.p2.3.m3.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2"><times id="S3.SS1.p2.3.m3.2.2.2.cmml" xref="S3.SS1.p2.3.m3.2.2.2"></times><apply id="S3.SS1.p2.3.m3.2.2.3.cmml" xref="S3.SS1.p2.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.3.1.cmml" xref="S3.SS1.p2.3.m3.2.2.3">superscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.3.2.cmml" xref="S3.SS1.p2.3.m3.2.2.3.2">𝜆</ci><apply id="S3.SS1.p2.3.m3.2.2.3.3.cmml" xref="S3.SS1.p2.3.m3.2.2.3.3"><minus id="S3.SS1.p2.3.m3.2.2.3.3.1.cmml" xref="S3.SS1.p2.3.m3.2.2.3.3.1"></minus><ci id="S3.SS1.p2.3.m3.2.2.3.3.2.cmml" xref="S3.SS1.p2.3.m3.2.2.3.3.2">𝑇</ci><ci id="S3.SS1.p2.3.m3.2.2.3.3.3.cmml" xref="S3.SS1.p2.3.m3.2.2.3.3.3">𝑡</ci></apply></apply><ci id="S3.SS1.p2.3.m3.2.2.4.cmml" xref="S3.SS1.p2.3.m3.2.2.4">𝑅</ci><interval closure="open" id="S3.SS1.p2.3.m3.2.2.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1"><apply id="S3.SS1.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.2">𝑠</ci><ci id="S3.SS1.p2.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.3.m3.2.2.1.1.1.3">𝑇</ci></apply><ci id="S3.SS1.p2.3.m3.1.1a.cmml" xref="S3.SS1.p2.3.m3.1.1"><mtext id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">&lt;EOS&gt;</mtext></ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.2c">\lambda^{T-t}R(s_{T},\text{&lt;EOS&gt;})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.2d">italic_λ start_POSTSUPERSCRIPT italic_T - italic_t end_POSTSUPERSCRIPT italic_R ( italic_s start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT , &lt;EOS&gt; )</annotation></semantics></math> to the <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_t</annotation></semantics></math>-th token. For long sequences where <math alttext="T-t\gg 1" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mrow id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2.2" xref="S3.SS1.p2.5.m5.1.1.2.2.cmml">T</mi><mo id="S3.SS1.p2.5.m5.1.1.2.1" xref="S3.SS1.p2.5.m5.1.1.2.1.cmml">−</mo><mi id="S3.SS1.p2.5.m5.1.1.2.3" xref="S3.SS1.p2.5.m5.1.1.2.3.cmml">t</mi></mrow><mo id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">≫</mo><mn id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="latexml" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1">much-greater-than</csymbol><apply id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2"><minus id="S3.SS1.p2.5.m5.1.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.2.1"></minus><ci id="S3.SS1.p2.5.m5.1.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2.2">𝑇</ci><ci id="S3.SS1.p2.5.m5.1.1.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.2.3">𝑡</ci></apply><cn id="S3.SS1.p2.5.m5.1.1.3.cmml" type="integer" xref="S3.SS1.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">T-t\gg 1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_T - italic_t ≫ 1</annotation></semantics></math>, this discounting reduces the effective reward signal to near zero. Consequently, value updates become almost entirely bootstrapped, relying on highly biased estimates that undermine the value model’s role as a reliable variance-reduction baseline.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Heterogeneous Sequence Lengths during Training</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">In complex reasoning tasks where a long CoT is essential for arriving at the correct answer, models often generate responses with highly variable lengths. This variability requires algorithms to be robust enough to manage sequences that can range from very short to extremely long. As a result, the commonly-applied GAE method with a fixed <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_λ</annotation></semantics></math> parameter encounters significant challenges.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Even when the value model is perfect, a static <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_λ</annotation></semantics></math> may not effectively adapt to sequences of varying lengths. For short-length responses, the estimates obtained through GAE tend to suffer from high variance. This is because GAE represents a trade-off between bias and variance. In the case of short responses, the estimates are skewed towards the variance-dominated side. On the other hand, for long-length responses, GAE often leads to high bias due to bootstrapping. The recursive nature of GAE, which relies on future state values, accumulates errors over long sequences, exacerbating the bias issue. These limitations are deeply rooted in the exponentially-decaying nature of GAE’s computational framework.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Sparsity of Reward Signal in Verifier-based Tasks</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Complex reasoning tasks frequently deploy a verifier as a reward model <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib6" title="">6</a>]</cite>. Unlike traditional language-model-based reward models that provide a dense signal, such as a continuous value ranging from -4 to 4, verifier-based reward models typically offer binary feedback, such as 0 and 1. The sparsity of the reward signal is further compounded by long CoT reasoning. As CoT significantly elongates output lengths, it not only increases computational time but also reduces the frequency of receiving non-zero rewards. In policy optimization, the sampled responses with correct answer could be extremely scarce and valuable.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">This situation poses a distinct exploration-exploitation dilemma. On one hand, the model must maintain relatively high uncertainty. This enables it to sample a diverse range of responses, increasing the likelihood of generating the correct answer for a given prompt. On the other hand, algorithms need to effectively utilize the correctly sampled responses—obtained through painstaking exploration—to enhance learning efficiency. By failing to strike the right balance between exploration and exploitation, the model may either get stuck in suboptimal solutions due to excessive exploitation or waste computational resources on unproductive exploration.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S4" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>VAPO: Addressing the Challenges in Long-CoT RL</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Mitigating Value Model Bias over Long Sequences</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Building upon the analysis of value-model-based models presented in section <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S3.SS1" title="3.1 Value Model Bias over Long Sequences ‣ 3 Challenges in Long-CoT RL for Reasoning Tasks ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we propose to use Value-Pretraining and decoupled-GAE to address the critical challenges in value model bias over long sequences.
Both of these two techniques draw upon methodologies previously introduced in VC-PPO.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Value-Pretraining</span> is proposed to mitigate the value initialization bias. Naively applying PPO to long-CoT tasks leads to failures such as collapsed output lengths and degraded performance. The reason is that the value model is initialized from the reward model while the reward model shares a mismatched objective with the value model. This phenomenon is first identified and addressed in VC-PPO <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib30" title="">30</a>]</cite>. In this paper, we follow the Value-Pretraining technique and the specific steps are outlined as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">Continuously generate responses by sampling from a fixed policy, for instance, <math alttext="\pi_{\text{sft}}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><msub id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">π</mi><mtext id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3a.cmml">sft</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">𝜋</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3a.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3"><mtext id="S4.I1.i1.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.I1.i1.p1.1.m1.1.1.3">sft</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">\pi_{\text{sft}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT sft end_POSTSUBSCRIPT</annotation></semantics></math>, and update the value model with Monte-Carlo return.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">Train the value model until key training metrics, including value loss and explained variance <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib7" title="">7</a>]</cite>, attain sufficiently low values.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">Save the value checkpoint and load this checkpoint for subsequent experiments.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">Decoupled-GAE</span> is proven effective in VC-PPO <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib30" title="">30</a>]</cite>. This technique decouples the advantage computation for the value and the policy. For value updates, it is recommended to compute the value-update target with <math alttext="\lambda=1.0" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">λ</mi><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"></eq><ci id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">𝜆</ci><cn id="S4.SS1.p4.1.m1.1.1.3.cmml" type="float" xref="S4.SS1.p4.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\lambda=1.0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">italic_λ = 1.0</annotation></semantics></math>. This choice results in an unbiased gradient-descent optimization, effectively addressing the reward-decay issues in long CoT tasks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.3">However, for policy updates, using a smaller <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS1.p5.1.m1.1"><semantics id="S4.SS1.p5.1.m1.1a"><mi id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><ci id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.1.m1.1d">italic_λ</annotation></semantics></math> is advisable to accelerate policy convergence under computational and time constraints. In VC-PPO, this is achieved by employing different coefficients in advantage computation: <math alttext="\lambda_{\text{critic}}=1.0" class="ltx_Math" display="inline" id="S4.SS1.p5.2.m2.1"><semantics id="S4.SS1.p5.2.m2.1a"><mrow id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><msub id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml"><mi id="S4.SS1.p5.2.m2.1.1.2.2" xref="S4.SS1.p5.2.m2.1.1.2.2.cmml">λ</mi><mtext id="S4.SS1.p5.2.m2.1.1.2.3" xref="S4.SS1.p5.2.m2.1.1.2.3a.cmml">critic</mtext></msub><mo id="S4.SS1.p5.2.m2.1.1.1" xref="S4.SS1.p5.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><eq id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1.1"></eq><apply id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.2.1.cmml" xref="S4.SS1.p5.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p5.2.m2.1.1.2.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2.2">𝜆</ci><ci id="S4.SS1.p5.2.m2.1.1.2.3a.cmml" xref="S4.SS1.p5.2.m2.1.1.2.3"><mtext id="S4.SS1.p5.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S4.SS1.p5.2.m2.1.1.2.3">critic</mtext></ci></apply><cn id="S4.SS1.p5.2.m2.1.1.3.cmml" type="float" xref="S4.SS1.p5.2.m2.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">\lambda_{\text{critic}}=1.0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.2.m2.1d">italic_λ start_POSTSUBSCRIPT critic end_POSTSUBSCRIPT = 1.0</annotation></semantics></math> and <math alttext="\lambda_{\text{policy}}=0.95" class="ltx_Math" display="inline" id="S4.SS1.p5.3.m3.1"><semantics id="S4.SS1.p5.3.m3.1a"><mrow id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml"><msub id="S4.SS1.p5.3.m3.1.1.2" xref="S4.SS1.p5.3.m3.1.1.2.cmml"><mi id="S4.SS1.p5.3.m3.1.1.2.2" xref="S4.SS1.p5.3.m3.1.1.2.2.cmml">λ</mi><mtext id="S4.SS1.p5.3.m3.1.1.2.3" xref="S4.SS1.p5.3.m3.1.1.2.3a.cmml">policy</mtext></msub><mo id="S4.SS1.p5.3.m3.1.1.1" xref="S4.SS1.p5.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p5.3.m3.1.1.3" xref="S4.SS1.p5.3.m3.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><apply id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1"><eq id="S4.SS1.p5.3.m3.1.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1.1"></eq><apply id="S4.SS1.p5.3.m3.1.1.2.cmml" xref="S4.SS1.p5.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.1.1.2.1.cmml" xref="S4.SS1.p5.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS1.p5.3.m3.1.1.2.2.cmml" xref="S4.SS1.p5.3.m3.1.1.2.2">𝜆</ci><ci id="S4.SS1.p5.3.m3.1.1.2.3a.cmml" xref="S4.SS1.p5.3.m3.1.1.2.3"><mtext id="S4.SS1.p5.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S4.SS1.p5.3.m3.1.1.2.3">policy</mtext></ci></apply><cn id="S4.SS1.p5.3.m3.1.1.3.cmml" type="float" xref="S4.SS1.p5.3.m3.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">\lambda_{\text{policy}}=0.95</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p5.3.m3.1d">italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT = 0.95</annotation></semantics></math>. In this paper, we adopt the core idea of decoupling GAE computation.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Managing Heterogeneous Sequence Lengths during Training</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">To address the challenge of heterogeneous sequence lengths during training, we propose the <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">Length-Adaptive GAE</span>. This method dynamically adjusts the parameter in GAE according to the sequence length, enabling adaptive advantage estimation for sequences of varying lengths. Additionally, to enhance the training stability of mixed-length sequences, we replace the conventional sample-level policy gradient loss with a token-level policy gradient loss. The key technical details are elaborated as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.6"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.6.1">Length-Adaptive GAE</span> is specifically proposed to to address the inconsistency in optimal <math alttext="\lambda_{\text{policy}}" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><msub id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">λ</mi><mtext id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3a.cmml">policy</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝜆</ci><ci id="S4.SS2.p2.1.m1.1.1.3a.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><mtext id="S4.SS2.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p2.1.m1.1.1.3">policy</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\lambda_{\text{policy}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT</annotation></semantics></math> values across sequences of varying lengths. In VC-PPO, <math alttext="\lambda_{\text{policy}}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><msub id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">λ</mi><mtext id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3a.cmml">policy</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝜆</ci><ci id="S4.SS2.p2.2.m2.1.1.3a.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><mtext id="S4.SS2.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p2.2.m2.1.1.3">policy</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\lambda_{\text{policy}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT</annotation></semantics></math> is set to a constant value of <math alttext="\lambda_{\text{policy}}=0.95" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><msub id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2.2" xref="S4.SS2.p2.3.m3.1.1.2.2.cmml">λ</mi><mtext id="S4.SS2.p2.3.m3.1.1.2.3" xref="S4.SS2.p2.3.m3.1.1.2.3a.cmml">policy</mtext></msub><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><eq id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></eq><apply id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2.2">𝜆</ci><ci id="S4.SS2.p2.3.m3.1.1.2.3a.cmml" xref="S4.SS2.p2.3.m3.1.1.2.3"><mtext id="S4.SS2.p2.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S4.SS2.p2.3.m3.1.1.2.3">policy</mtext></ci></apply><cn id="S4.SS2.p2.3.m3.1.1.3.cmml" type="float" xref="S4.SS2.p2.3.m3.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">\lambda_{\text{policy}}=0.95</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT = 0.95</annotation></semantics></math>. However, when considering the GAE computation, for longer output sequences with lengths <math alttext="l&gt;100" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">l</mi><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><gt id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></gt><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝑙</ci><cn id="S4.SS2.p2.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p2.4.m4.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">l&gt;100</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">italic_l &gt; 100</annotation></semantics></math>, the coefficient of the TD-error corresponding to the reward is <math alttext="0.95^{100}\approx 0.006" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.1"><semantics id="S4.SS2.p2.5.m5.1a"><mrow id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><msup id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml"><mn id="S4.SS2.p2.5.m5.1.1.2.2" xref="S4.SS2.p2.5.m5.1.1.2.2.cmml">0.95</mn><mn id="S4.SS2.p2.5.m5.1.1.2.3" xref="S4.SS2.p2.5.m5.1.1.2.3.cmml">100</mn></msup><mo id="S4.SS2.p2.5.m5.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.cmml">≈</mo><mn id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">0.006</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><approx id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1"></approx><apply id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.2.1.cmml" xref="S4.SS2.p2.5.m5.1.1.2">superscript</csymbol><cn id="S4.SS2.p2.5.m5.1.1.2.2.cmml" type="float" xref="S4.SS2.p2.5.m5.1.1.2.2">0.95</cn><cn id="S4.SS2.p2.5.m5.1.1.2.3.cmml" type="integer" xref="S4.SS2.p2.5.m5.1.1.2.3">100</cn></apply><cn id="S4.SS2.p2.5.m5.1.1.3.cmml" type="float" xref="S4.SS2.p2.5.m5.1.1.3">0.006</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">0.95^{100}\approx 0.006</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.1d">0.95 start_POSTSUPERSCRIPT 100 end_POSTSUPERSCRIPT ≈ 0.006</annotation></semantics></math>, which is effectively zero. As a result, with a fixed <math alttext="\lambda_{\text{policy}}=0.95" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><mrow id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><msub id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2.2" xref="S4.SS2.p2.6.m6.1.1.2.2.cmml">λ</mi><mtext id="S4.SS2.p2.6.m6.1.1.2.3" xref="S4.SS2.p2.6.m6.1.1.2.3a.cmml">policy</mtext></msub><mo id="S4.SS2.p2.6.m6.1.1.1" xref="S4.SS2.p2.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><eq id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1.1"></eq><apply id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.2.1.cmml" xref="S4.SS2.p2.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2.2">𝜆</ci><ci id="S4.SS2.p2.6.m6.1.1.2.3a.cmml" xref="S4.SS2.p2.6.m6.1.1.2.3"><mtext id="S4.SS2.p2.6.m6.1.1.2.3.cmml" mathsize="70%" xref="S4.SS2.p2.6.m6.1.1.2.3">policy</mtext></ci></apply><cn id="S4.SS2.p2.6.m6.1.1.3.cmml" type="float" xref="S4.SS2.p2.6.m6.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">\lambda_{\text{policy}}=0.95</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT = 0.95</annotation></semantics></math>, the GAE computation becomes dominated by potentially biased bootstrapping TD-errors. This approach may not be optimal for handling extremely long output sequences.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.2">To address this shortcoming, we propose <span class="ltx_text ltx_font_bold" id="S4.SS2.p3.2.1">Length-Adaptive GAE</span> for policy updates. Our method aims to ensure a more uniform distribution of TD-errors across both short and long sequences. We design the sum of the coefficients <math alttext="\lambda_{\text{policy}}" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">λ</mi><mtext id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3a.cmml">policy</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝜆</ci><ci id="S4.SS2.p3.1.m1.1.1.3a.cmml" xref="S4.SS2.p3.1.m1.1.1.3"><mtext id="S4.SS2.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p3.1.m1.1.1.3">policy</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\lambda_{\text{policy}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT</annotation></semantics></math> to be proportional to the output length <math alttext="l" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_l</annotation></semantics></math>:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{t=0}^{\infty}\lambda_{\text{policy}}^{t}\approx\frac{1}{1-\lambda_{\text%
{policy}}}=\alpha l," class="ltx_Math" display="block" id="S4.E4.m1.1"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml"><munderover id="S4.E4.m1.1.1.1.1.2.1" xref="S4.E4.m1.1.1.1.1.2.1.cmml"><mo id="S4.E4.m1.1.1.1.1.2.1.2.2" movablelimits="false" xref="S4.E4.m1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="S4.E4.m1.1.1.1.1.2.1.2.3" xref="S4.E4.m1.1.1.1.1.2.1.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.2.1.2.3.2" xref="S4.E4.m1.1.1.1.1.2.1.2.3.2.cmml">t</mi><mo id="S4.E4.m1.1.1.1.1.2.1.2.3.1" xref="S4.E4.m1.1.1.1.1.2.1.2.3.1.cmml">=</mo><mn id="S4.E4.m1.1.1.1.1.2.1.2.3.3" xref="S4.E4.m1.1.1.1.1.2.1.2.3.3.cmml">0</mn></mrow><mi id="S4.E4.m1.1.1.1.1.2.1.3" mathvariant="normal" xref="S4.E4.m1.1.1.1.1.2.1.3.cmml">∞</mi></munderover><msubsup id="S4.E4.m1.1.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.2.2.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2.2.2" xref="S4.E4.m1.1.1.1.1.2.2.2.2.cmml">λ</mi><mtext id="S4.E4.m1.1.1.1.1.2.2.2.3" xref="S4.E4.m1.1.1.1.1.2.2.2.3a.cmml">policy</mtext><mi id="S4.E4.m1.1.1.1.1.2.2.3" xref="S4.E4.m1.1.1.1.1.2.2.3.cmml">t</mi></msubsup></mrow><mo id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml">≈</mo><mfrac id="S4.E4.m1.1.1.1.1.4" xref="S4.E4.m1.1.1.1.1.4.cmml"><mn id="S4.E4.m1.1.1.1.1.4.2" xref="S4.E4.m1.1.1.1.1.4.2.cmml">1</mn><mrow id="S4.E4.m1.1.1.1.1.4.3" xref="S4.E4.m1.1.1.1.1.4.3.cmml"><mn id="S4.E4.m1.1.1.1.1.4.3.2" xref="S4.E4.m1.1.1.1.1.4.3.2.cmml">1</mn><mo id="S4.E4.m1.1.1.1.1.4.3.1" xref="S4.E4.m1.1.1.1.1.4.3.1.cmml">−</mo><msub id="S4.E4.m1.1.1.1.1.4.3.3" xref="S4.E4.m1.1.1.1.1.4.3.3.cmml"><mi id="S4.E4.m1.1.1.1.1.4.3.3.2" xref="S4.E4.m1.1.1.1.1.4.3.3.2.cmml">λ</mi><mtext id="S4.E4.m1.1.1.1.1.4.3.3.3" xref="S4.E4.m1.1.1.1.1.4.3.3.3a.cmml">policy</mtext></msub></mrow></mfrac><mo id="S4.E4.m1.1.1.1.1.5" xref="S4.E4.m1.1.1.1.1.5.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.6" xref="S4.E4.m1.1.1.1.1.6.cmml"><mi id="S4.E4.m1.1.1.1.1.6.2" xref="S4.E4.m1.1.1.1.1.6.2.cmml">α</mi><mo id="S4.E4.m1.1.1.1.1.6.1" xref="S4.E4.m1.1.1.1.1.6.1.cmml">⁢</mo><mi id="S4.E4.m1.1.1.1.1.6.3" xref="S4.E4.m1.1.1.1.1.6.3.cmml">l</mi></mrow></mrow><mo id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><and id="S4.E4.m1.1.1.1.1a.cmml" xref="S4.E4.m1.1.1.1"></and><apply id="S4.E4.m1.1.1.1.1b.cmml" xref="S4.E4.m1.1.1.1"><approx id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"></approx><apply id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2"><apply id="S4.E4.m1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.1.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.2.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1">subscript</csymbol><sum id="S4.E4.m1.1.1.1.1.2.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.2.2"></sum><apply id="S4.E4.m1.1.1.1.1.2.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.2.3"><eq id="S4.E4.m1.1.1.1.1.2.1.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.2.3.1"></eq><ci id="S4.E4.m1.1.1.1.1.2.1.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.2.3.2">𝑡</ci><cn id="S4.E4.m1.1.1.1.1.2.1.2.3.3.cmml" type="integer" xref="S4.E4.m1.1.1.1.1.2.1.2.3.3">0</cn></apply></apply><infinity id="S4.E4.m1.1.1.1.1.2.1.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.3"></infinity></apply><apply id="S4.E4.m1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.2">𝜆</ci><ci id="S4.E4.m1.1.1.1.1.2.2.2.3a.cmml" xref="S4.E4.m1.1.1.1.1.2.2.2.3"><mtext id="S4.E4.m1.1.1.1.1.2.2.2.3.cmml" mathsize="70%" xref="S4.E4.m1.1.1.1.1.2.2.2.3">policy</mtext></ci></apply><ci id="S4.E4.m1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.2.3">𝑡</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.4.cmml" xref="S4.E4.m1.1.1.1.1.4"><divide id="S4.E4.m1.1.1.1.1.4.1.cmml" xref="S4.E4.m1.1.1.1.1.4"></divide><cn id="S4.E4.m1.1.1.1.1.4.2.cmml" type="integer" xref="S4.E4.m1.1.1.1.1.4.2">1</cn><apply id="S4.E4.m1.1.1.1.1.4.3.cmml" xref="S4.E4.m1.1.1.1.1.4.3"><minus id="S4.E4.m1.1.1.1.1.4.3.1.cmml" xref="S4.E4.m1.1.1.1.1.4.3.1"></minus><cn id="S4.E4.m1.1.1.1.1.4.3.2.cmml" type="integer" xref="S4.E4.m1.1.1.1.1.4.3.2">1</cn><apply id="S4.E4.m1.1.1.1.1.4.3.3.cmml" xref="S4.E4.m1.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.4.3.3.1.cmml" xref="S4.E4.m1.1.1.1.1.4.3.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.4.3.3.2.cmml" xref="S4.E4.m1.1.1.1.1.4.3.3.2">𝜆</ci><ci id="S4.E4.m1.1.1.1.1.4.3.3.3a.cmml" xref="S4.E4.m1.1.1.1.1.4.3.3.3"><mtext id="S4.E4.m1.1.1.1.1.4.3.3.3.cmml" mathsize="70%" xref="S4.E4.m1.1.1.1.1.4.3.3.3">policy</mtext></ci></apply></apply></apply></apply><apply id="S4.E4.m1.1.1.1.1c.cmml" xref="S4.E4.m1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.5.cmml" xref="S4.E4.m1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2504.05118v3#S4.E4.m1.1.1.1.1.4.cmml" id="S4.E4.m1.1.1.1.1d.cmml" xref="S4.E4.m1.1.1.1"></share><apply id="S4.E4.m1.1.1.1.1.6.cmml" xref="S4.E4.m1.1.1.1.1.6"><times id="S4.E4.m1.1.1.1.1.6.1.cmml" xref="S4.E4.m1.1.1.1.1.6.1"></times><ci id="S4.E4.m1.1.1.1.1.6.2.cmml" xref="S4.E4.m1.1.1.1.1.6.2">𝛼</ci><ci id="S4.E4.m1.1.1.1.1.6.3.cmml" xref="S4.E4.m1.1.1.1.1.6.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\sum_{t=0}^{\infty}\lambda_{\text{policy}}^{t}\approx\frac{1}{1-\lambda_{\text%
{policy}}}=\alpha l,</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.1d">∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ≈ divide start_ARG 1 end_ARG start_ARG 1 - italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT end_ARG = italic_α italic_l ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p3.4">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m1.1"><semantics id="S4.SS2.p3.3.m1.1a"><mi id="S4.SS2.p3.3.m1.1.1" xref="S4.SS2.p3.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m1.1b"><ci id="S4.SS2.p3.3.m1.1.1.cmml" xref="S4.SS2.p3.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m1.1d">italic_α</annotation></semantics></math> is a hyper-parameter controlling the overall bias-variance trade-off. By solving Equation <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S4.E4" title="Equation 4 ‣ 4.2 Managing Heterogeneous Sequence Lengths during Training ‣ 4 VAPO: Addressing the Challenges in Long-CoT RL ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_tag">4</span></a> for <math alttext="\lambda_{\text{policy}}" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m2.1"><semantics id="S4.SS2.p3.4.m2.1a"><msub id="S4.SS2.p3.4.m2.1.1" xref="S4.SS2.p3.4.m2.1.1.cmml"><mi id="S4.SS2.p3.4.m2.1.1.2" xref="S4.SS2.p3.4.m2.1.1.2.cmml">λ</mi><mtext id="S4.SS2.p3.4.m2.1.1.3" xref="S4.SS2.p3.4.m2.1.1.3a.cmml">policy</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m2.1b"><apply id="S4.SS2.p3.4.m2.1.1.cmml" xref="S4.SS2.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m2.1.1.1.cmml" xref="S4.SS2.p3.4.m2.1.1">subscript</csymbol><ci id="S4.SS2.p3.4.m2.1.1.2.cmml" xref="S4.SS2.p3.4.m2.1.1.2">𝜆</ci><ci id="S4.SS2.p3.4.m2.1.1.3a.cmml" xref="S4.SS2.p3.4.m2.1.1.3"><mtext id="S4.SS2.p3.4.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p3.4.m2.1.1.3">policy</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m2.1c">\lambda_{\text{policy}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m2.1d">italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT</annotation></semantics></math>, we derive a length-adaptive formula:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\lambda_{\text{policy}}=1-\frac{1}{\alpha l}" class="ltx_Math" display="block" id="S4.E5.m1.1"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><msub id="S4.E5.m1.1.1.2" xref="S4.E5.m1.1.1.2.cmml"><mi id="S4.E5.m1.1.1.2.2" xref="S4.E5.m1.1.1.2.2.cmml">λ</mi><mtext id="S4.E5.m1.1.1.2.3" xref="S4.E5.m1.1.1.2.3a.cmml">policy</mtext></msub><mo id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml"><mn id="S4.E5.m1.1.1.3.2" xref="S4.E5.m1.1.1.3.2.cmml">1</mn><mo id="S4.E5.m1.1.1.3.1" xref="S4.E5.m1.1.1.3.1.cmml">−</mo><mfrac id="S4.E5.m1.1.1.3.3" xref="S4.E5.m1.1.1.3.3.cmml"><mn id="S4.E5.m1.1.1.3.3.2" xref="S4.E5.m1.1.1.3.3.2.cmml">1</mn><mrow id="S4.E5.m1.1.1.3.3.3" xref="S4.E5.m1.1.1.3.3.3.cmml"><mi id="S4.E5.m1.1.1.3.3.3.2" xref="S4.E5.m1.1.1.3.3.3.2.cmml">α</mi><mo id="S4.E5.m1.1.1.3.3.3.1" xref="S4.E5.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S4.E5.m1.1.1.3.3.3.3" xref="S4.E5.m1.1.1.3.3.3.3.cmml">l</mi></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><eq id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"></eq><apply id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.2">subscript</csymbol><ci id="S4.E5.m1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.2.2">𝜆</ci><ci id="S4.E5.m1.1.1.2.3a.cmml" xref="S4.E5.m1.1.1.2.3"><mtext id="S4.E5.m1.1.1.2.3.cmml" mathsize="70%" xref="S4.E5.m1.1.1.2.3">policy</mtext></ci></apply><apply id="S4.E5.m1.1.1.3.cmml" xref="S4.E5.m1.1.1.3"><minus id="S4.E5.m1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.3.1"></minus><cn id="S4.E5.m1.1.1.3.2.cmml" type="integer" xref="S4.E5.m1.1.1.3.2">1</cn><apply id="S4.E5.m1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.3.3"><divide id="S4.E5.m1.1.1.3.3.1.cmml" xref="S4.E5.m1.1.1.3.3"></divide><cn id="S4.E5.m1.1.1.3.3.2.cmml" type="integer" xref="S4.E5.m1.1.1.3.3.2">1</cn><apply id="S4.E5.m1.1.1.3.3.3.cmml" xref="S4.E5.m1.1.1.3.3.3"><times id="S4.E5.m1.1.1.3.3.3.1.cmml" xref="S4.E5.m1.1.1.3.3.3.1"></times><ci id="S4.E5.m1.1.1.3.3.3.2.cmml" xref="S4.E5.m1.1.1.3.3.3.2">𝛼</ci><ci id="S4.E5.m1.1.1.3.3.3.3.cmml" xref="S4.E5.m1.1.1.3.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\lambda_{\text{policy}}=1-\frac{1}{\alpha l}</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.1d">italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT = 1 - divide start_ARG 1 end_ARG start_ARG italic_α italic_l end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1">This length-adaptive approach to <math alttext="\lambda_{\text{policy}}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><msub id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">λ</mi><mtext id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3a.cmml">policy</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝜆</ci><ci id="S4.SS2.p4.1.m1.1.1.3a.cmml" xref="S4.SS2.p4.1.m1.1.1.3"><mtext id="S4.SS2.p4.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS2.p4.1.m1.1.1.3">policy</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\lambda_{\text{policy}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT</annotation></semantics></math> in GAE calculation allows for a more effective handling of sequences of varying lengths.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.4"><span class="ltx_text ltx_font_bold" id="S4.SS2.p5.4.1">Token-Level Policy Gradient Loss</span>.
Following DAPO&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib29" title="">29</a>]</cite>, we have also modified the computation method of the policy gradient loss to adjust the loss weight allocation in long COT scenarios. Specifically, in previous implementations, the policy gradient loss was computed as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx2">
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{PPO}}(\theta)=-\frac{1}{G}\sum_{i=1}^{G}\frac{%
1}{|o_{i}|}\sum_{t=1}^{|o_{i}|}\min\left(r_{i,t}(\theta)\hat{A}_{i,t},\text{%
clip}\left(r_{i,t}(\theta),1-\varepsilon,1+\varepsilon\right)\hat{A}_{i,t}%
\right)," class="ltx_Math" display="inline" id="S4.E6.m1.15"><semantics id="S4.E6.m1.15a"><mrow id="S4.E6.m1.15.15.1" xref="S4.E6.m1.15.15.1.1.cmml"><mrow id="S4.E6.m1.15.15.1.1" xref="S4.E6.m1.15.15.1.1.cmml"><mrow id="S4.E6.m1.15.15.1.1.4" xref="S4.E6.m1.15.15.1.1.4.cmml"><msub id="S4.E6.m1.15.15.1.1.4.2" xref="S4.E6.m1.15.15.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.15.15.1.1.4.2.2" xref="S4.E6.m1.15.15.1.1.4.2.2.cmml">ℒ</mi><mtext id="S4.E6.m1.15.15.1.1.4.2.3" xref="S4.E6.m1.15.15.1.1.4.2.3a.cmml">PPO</mtext></msub><mo id="S4.E6.m1.15.15.1.1.4.1" xref="S4.E6.m1.15.15.1.1.4.1.cmml">⁢</mo><mrow id="S4.E6.m1.15.15.1.1.4.3.2" xref="S4.E6.m1.15.15.1.1.4.cmml"><mo id="S4.E6.m1.15.15.1.1.4.3.2.1" stretchy="false" xref="S4.E6.m1.15.15.1.1.4.cmml">(</mo><mi id="S4.E6.m1.11.11" xref="S4.E6.m1.11.11.cmml">θ</mi><mo id="S4.E6.m1.15.15.1.1.4.3.2.2" stretchy="false" xref="S4.E6.m1.15.15.1.1.4.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.15.15.1.1.3" xref="S4.E6.m1.15.15.1.1.3.cmml">=</mo><mrow id="S4.E6.m1.15.15.1.1.2" xref="S4.E6.m1.15.15.1.1.2.cmml"><mo id="S4.E6.m1.15.15.1.1.2a" xref="S4.E6.m1.15.15.1.1.2.cmml">−</mo><mrow id="S4.E6.m1.15.15.1.1.2.2" xref="S4.E6.m1.15.15.1.1.2.2.cmml"><mstyle displaystyle="true" id="S4.E6.m1.15.15.1.1.2.2.4" xref="S4.E6.m1.15.15.1.1.2.2.4.cmml"><mfrac id="S4.E6.m1.15.15.1.1.2.2.4a" xref="S4.E6.m1.15.15.1.1.2.2.4.cmml"><mn id="S4.E6.m1.15.15.1.1.2.2.4.2" xref="S4.E6.m1.15.15.1.1.2.2.4.2.cmml">1</mn><mi id="S4.E6.m1.15.15.1.1.2.2.4.3" xref="S4.E6.m1.15.15.1.1.2.2.4.3.cmml">G</mi></mfrac></mstyle><mo id="S4.E6.m1.15.15.1.1.2.2.3" xref="S4.E6.m1.15.15.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2" xref="S4.E6.m1.15.15.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E6.m1.15.15.1.1.2.2.2.3" xref="S4.E6.m1.15.15.1.1.2.2.2.3.cmml"><munderover id="S4.E6.m1.15.15.1.1.2.2.2.3a" xref="S4.E6.m1.15.15.1.1.2.2.2.3.cmml"><mo id="S4.E6.m1.15.15.1.1.2.2.2.3.2.2" movablelimits="false" xref="S4.E6.m1.15.15.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2.3.2.3" xref="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.cmml"><mi id="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.2" xref="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.2.cmml">i</mi><mo id="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.1" xref="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.3" xref="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.15.15.1.1.2.2.2.3.3" xref="S4.E6.m1.15.15.1.1.2.2.2.3.3.cmml">G</mi></munderover></mstyle><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><mfrac id="S4.E6.m1.1.1a" xref="S4.E6.m1.1.1.cmml"><mn id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml">1</mn><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.2.cmml"><mo id="S4.E6.m1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.1.1.1.2.1.cmml">|</mo><msub id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.2.cmml">o</mi><mi id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E6.m1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.3" xref="S4.E6.m1.15.15.1.1.2.2.2.2.3.cmml">⁢</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.cmml"><munderover id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3a" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.cmml"><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.2" movablelimits="false" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.cmml"><mi id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.2.cmml">t</mi><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.1" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.3" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S4.E6.m1.2.2.1.1" xref="S4.E6.m1.2.2.1.2.cmml"><mo id="S4.E6.m1.2.2.1.1.2" stretchy="false" xref="S4.E6.m1.2.2.1.2.1.cmml">|</mo><msub id="S4.E6.m1.2.2.1.1.1" xref="S4.E6.m1.2.2.1.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.2.cmml">o</mi><mi id="S4.E6.m1.2.2.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.E6.m1.2.2.1.1.3" stretchy="false" xref="S4.E6.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.3.cmml"><mi id="S4.E6.m1.14.14" xref="S4.E6.m1.14.14.cmml">min</mi><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2a" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.3.cmml">⁡</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.3.cmml"><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.3" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.3.cmml">(</mo><mrow id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mrow id="S4.E6.m1.4.4.2.4" xref="S4.E6.m1.4.4.2.3.cmml"><mi id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml">i</mi><mo id="S4.E6.m1.4.4.2.4.1" xref="S4.E6.m1.4.4.2.3.cmml">,</mo><mi id="S4.E6.m1.4.4.2.2" xref="S4.E6.m1.4.4.2.2.cmml">t</mi></mrow></msub><mo id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E6.m1.12.12" xref="S4.E6.m1.12.12.cmml">θ</mi><mo id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1a" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2.2" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml">A</mi><mo id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2.1" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml">^</mo></mover><mrow id="S4.E6.m1.6.6.2.4" xref="S4.E6.m1.6.6.2.3.cmml"><mi id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml">i</mi><mo id="S4.E6.m1.6.6.2.4.1" xref="S4.E6.m1.6.6.2.3.cmml">,</mo><mi id="S4.E6.m1.6.6.2.2" xref="S4.E6.m1.6.6.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.4" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.3.cmml">,</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.cmml"><mtext id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.5" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.5a.cmml">clip</mtext><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.4" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.4.cmml">⁢</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.4.cmml"><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.4" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.4.cmml">(</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.cmml"><msub id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.2.cmml"><mi id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.2.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.2.2.cmml">r</mi><mrow id="S4.E6.m1.8.8.2.4" xref="S4.E6.m1.8.8.2.3.cmml"><mi id="S4.E6.m1.7.7.1.1" xref="S4.E6.m1.7.7.1.1.cmml">i</mi><mo id="S4.E6.m1.8.8.2.4.1" xref="S4.E6.m1.8.8.2.3.cmml">,</mo><mi id="S4.E6.m1.8.8.2.2" xref="S4.E6.m1.8.8.2.2.cmml">t</mi></mrow></msub><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.1" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.3.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.cmml"><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.cmml">(</mo><mi id="S4.E6.m1.13.13" xref="S4.E6.m1.13.13.cmml">θ</mi><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.5" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.4.cmml">,</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.cmml"><mn id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml">1</mn><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.1" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.1.cmml">−</mo><mi id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.3" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.3.cmml">ε</mi></mrow><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.6" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.4.cmml">,</mo><mrow id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.cmml"><mn id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.2.cmml">1</mn><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.1" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.1.cmml">+</mo><mi id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.3" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.3.cmml">ε</mi></mrow><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.7" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.4.cmml">)</mo></mrow><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.4a" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.4.cmml">⁢</mo><msub id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.cmml"><mover accent="true" id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2.cmml"><mi id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2.2" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2.2.cmml">A</mi><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2.1" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2.1.cmml">^</mo></mover><mrow id="S4.E6.m1.10.10.2.4" xref="S4.E6.m1.10.10.2.3.cmml"><mi id="S4.E6.m1.9.9.1.1" xref="S4.E6.m1.9.9.1.1.cmml">i</mi><mo id="S4.E6.m1.10.10.2.4.1" xref="S4.E6.m1.10.10.2.3.cmml">,</mo><mi id="S4.E6.m1.10.10.2.2" xref="S4.E6.m1.10.10.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.5" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E6.m1.15.15.1.2" xref="S4.E6.m1.15.15.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.15b"><apply id="S4.E6.m1.15.15.1.1.cmml" xref="S4.E6.m1.15.15.1"><eq id="S4.E6.m1.15.15.1.1.3.cmml" xref="S4.E6.m1.15.15.1.1.3"></eq><apply id="S4.E6.m1.15.15.1.1.4.cmml" xref="S4.E6.m1.15.15.1.1.4"><times id="S4.E6.m1.15.15.1.1.4.1.cmml" xref="S4.E6.m1.15.15.1.1.4.1"></times><apply id="S4.E6.m1.15.15.1.1.4.2.cmml" xref="S4.E6.m1.15.15.1.1.4.2"><csymbol cd="ambiguous" id="S4.E6.m1.15.15.1.1.4.2.1.cmml" xref="S4.E6.m1.15.15.1.1.4.2">subscript</csymbol><ci id="S4.E6.m1.15.15.1.1.4.2.2.cmml" xref="S4.E6.m1.15.15.1.1.4.2.2">ℒ</ci><ci id="S4.E6.m1.15.15.1.1.4.2.3a.cmml" xref="S4.E6.m1.15.15.1.1.4.2.3"><mtext id="S4.E6.m1.15.15.1.1.4.2.3.cmml" mathsize="70%" xref="S4.E6.m1.15.15.1.1.4.2.3">PPO</mtext></ci></apply><ci id="S4.E6.m1.11.11.cmml" xref="S4.E6.m1.11.11">𝜃</ci></apply><apply id="S4.E6.m1.15.15.1.1.2.cmml" xref="S4.E6.m1.15.15.1.1.2"><minus id="S4.E6.m1.15.15.1.1.2.3.cmml" xref="S4.E6.m1.15.15.1.1.2"></minus><apply id="S4.E6.m1.15.15.1.1.2.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2"><times id="S4.E6.m1.15.15.1.1.2.2.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.3"></times><apply id="S4.E6.m1.15.15.1.1.2.2.4.cmml" xref="S4.E6.m1.15.15.1.1.2.2.4"><divide id="S4.E6.m1.15.15.1.1.2.2.4.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.4"></divide><cn id="S4.E6.m1.15.15.1.1.2.2.4.2.cmml" type="integer" xref="S4.E6.m1.15.15.1.1.2.2.4.2">1</cn><ci id="S4.E6.m1.15.15.1.1.2.2.4.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.4.3">𝐺</ci></apply><apply id="S4.E6.m1.15.15.1.1.2.2.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2"><apply id="S4.E6.m1.15.15.1.1.2.2.2.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.15.15.1.1.2.2.2.3.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.3">superscript</csymbol><apply id="S4.E6.m1.15.15.1.1.2.2.2.3.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.15.15.1.1.2.2.2.3.2.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.3">subscript</csymbol><sum id="S4.E6.m1.15.15.1.1.2.2.2.3.2.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.3.2.2"></sum><apply id="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.3.2.3"><eq id="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.1"></eq><ci id="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.2">𝑖</ci><cn id="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.E6.m1.15.15.1.1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.15.15.1.1.2.2.2.3.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.3.3">𝐺</ci></apply><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2"><times id="S4.E6.m1.15.15.1.1.2.2.2.2.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.3"></times><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><divide id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1"></divide><cn id="S4.E6.m1.1.1.3.cmml" type="integer" xref="S4.E6.m1.1.1.3">1</cn><apply id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1"><abs id="S4.E6.m1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.2"></abs><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.2">𝑜</ci><ci id="S4.E6.m1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2"><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3">superscript</csymbol><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3">subscript</csymbol><sum id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.2"></sum><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3"><eq id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.1"></eq><ci id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.2">𝑡</ci><cn id="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S4.E6.m1.2.2.1.2.cmml" xref="S4.E6.m1.2.2.1.1"><abs id="S4.E6.m1.2.2.1.2.1.cmml" xref="S4.E6.m1.2.2.1.1.2"></abs><apply id="S4.E6.m1.2.2.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.2">𝑜</ci><ci id="S4.E6.m1.2.2.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2"><min id="S4.E6.m1.14.14.cmml" xref="S4.E6.m1.14.14"></min><apply id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><list id="S4.E6.m1.4.4.2.3.cmml" xref="S4.E6.m1.4.4.2.4"><ci id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1.1">𝑖</ci><ci id="S4.E6.m1.4.4.2.2.cmml" xref="S4.E6.m1.4.4.2.2">𝑡</ci></list></apply><ci id="S4.E6.m1.12.12.cmml" xref="S4.E6.m1.12.12">𝜃</ci><apply id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2"><ci id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2.1">^</ci><ci id="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E6.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.4.2.2">𝐴</ci></apply><list id="S4.E6.m1.6.6.2.3.cmml" xref="S4.E6.m1.6.6.2.4"><ci id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1.1">𝑖</ci><ci id="S4.E6.m1.6.6.2.2.cmml" xref="S4.E6.m1.6.6.2.2">𝑡</ci></list></apply></apply><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2"><times id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.4.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.4"></times><ci id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.5a.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.5"><mtext id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.5.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.5">clip</mtext></ci><vector id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.4.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3"><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1"><times id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.1"></times><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.1.1.1.2.2">𝑟</ci><list id="S4.E6.m1.8.8.2.3.cmml" xref="S4.E6.m1.8.8.2.4"><ci id="S4.E6.m1.7.7.1.1.cmml" xref="S4.E6.m1.7.7.1.1">𝑖</ci><ci id="S4.E6.m1.8.8.2.2.cmml" xref="S4.E6.m1.8.8.2.2">𝑡</ci></list></apply><ci id="S4.E6.m1.13.13.cmml" xref="S4.E6.m1.13.13">𝜃</ci></apply><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2"><minus id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.1"></minus><cn id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml" type="integer" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.2">1</cn><ci id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.3">𝜀</ci></apply><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3"><plus id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.1"></plus><cn id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.2.cmml" type="integer" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.2">1</cn><ci id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.3.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.3.3.3.3">𝜀</ci></apply></vector><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6">subscript</csymbol><apply id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2"><ci id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2.1.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2.1">^</ci><ci id="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2.2.cmml" xref="S4.E6.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.6.2.2">𝐴</ci></apply><list id="S4.E6.m1.10.10.2.3.cmml" xref="S4.E6.m1.10.10.2.4"><ci id="S4.E6.m1.9.9.1.1.cmml" xref="S4.E6.m1.9.9.1.1">𝑖</ci><ci id="S4.E6.m1.10.10.2.2.cmml" xref="S4.E6.m1.10.10.2.2">𝑡</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.15c">\displaystyle\mathcal{L}_{\text{PPO}}(\theta)=-\frac{1}{G}\sum_{i=1}^{G}\frac{%
1}{|o_{i}|}\sum_{t=1}^{|o_{i}|}\min\left(r_{i,t}(\theta)\hat{A}_{i,t},\text{%
clip}\left(r_{i,t}(\theta),1-\varepsilon,1+\varepsilon\right)\hat{A}_{i,t}%
\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.15d">caligraphic_L start_POSTSUBSCRIPT PPO end_POSTSUBSCRIPT ( italic_θ ) = - divide start_ARG 1 end_ARG start_ARG italic_G end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG | italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT roman_min ( italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ( italic_θ ) over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT , clip ( italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ( italic_θ ) , 1 - italic_ε , 1 + italic_ε ) over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p5.3">where <math alttext="G" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">italic_G</annotation></semantics></math> is the size of training batch, <math alttext="o_{i}" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><msub id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mi id="S4.SS2.p5.2.m2.1.1.2" xref="S4.SS2.p5.2.m2.1.1.2.cmml">o</mi><mi id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2">𝑜</ci><ci id="S4.SS2.p5.2.m2.1.1.3.cmml" xref="S4.SS2.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">o_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the trajectory of the <math alttext="i" class="ltx_Math" display="inline" id="S4.SS2.p5.3.m3.1"><semantics id="S4.SS2.p5.3.m3.1a"><mi id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><ci id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.3.m3.1d">italic_i</annotation></semantics></math>th sample.
In this loss formulation, the losses of all tokens are first averaged at the sequence level before being further averaged at the batch level. This approach results in tokens from longer sequences contributing less to the final loss value. Consequently, if the model encounters critical issues in processing long sequences, a scenario that is prone to occur during the exploration phase of RL training, the insufficient suppression caused by their diminished weighting may lead to training instability or even collapse. To address this imbalance in token-level contribution to the final loss, we revise the loss function into the following form:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx3">
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{PPO}}(\theta)=-\frac{1}{\sum_{i=1}^{G}|o_{i}|}%
\sum_{i=1}^{G}\sum_{t=1}^{|o_{i}|}\min\left(r_{i,t}(\theta)\hat{A}_{i,t},\text%
{clip}\left(r_{i,t}(\theta),1-\varepsilon,1+\varepsilon\right)\hat{A}_{i,t}%
\right)," class="ltx_Math" display="inline" id="S4.E7.m1.15"><semantics id="S4.E7.m1.15a"><mrow id="S4.E7.m1.15.15.1" xref="S4.E7.m1.15.15.1.1.cmml"><mrow id="S4.E7.m1.15.15.1.1" xref="S4.E7.m1.15.15.1.1.cmml"><mrow id="S4.E7.m1.15.15.1.1.4" xref="S4.E7.m1.15.15.1.1.4.cmml"><msub id="S4.E7.m1.15.15.1.1.4.2" xref="S4.E7.m1.15.15.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.15.15.1.1.4.2.2" xref="S4.E7.m1.15.15.1.1.4.2.2.cmml">ℒ</mi><mtext id="S4.E7.m1.15.15.1.1.4.2.3" xref="S4.E7.m1.15.15.1.1.4.2.3a.cmml">PPO</mtext></msub><mo id="S4.E7.m1.15.15.1.1.4.1" xref="S4.E7.m1.15.15.1.1.4.1.cmml">⁢</mo><mrow id="S4.E7.m1.15.15.1.1.4.3.2" xref="S4.E7.m1.15.15.1.1.4.cmml"><mo id="S4.E7.m1.15.15.1.1.4.3.2.1" stretchy="false" xref="S4.E7.m1.15.15.1.1.4.cmml">(</mo><mi id="S4.E7.m1.11.11" xref="S4.E7.m1.11.11.cmml">θ</mi><mo id="S4.E7.m1.15.15.1.1.4.3.2.2" stretchy="false" xref="S4.E7.m1.15.15.1.1.4.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.15.15.1.1.3" xref="S4.E7.m1.15.15.1.1.3.cmml">=</mo><mrow id="S4.E7.m1.15.15.1.1.2" xref="S4.E7.m1.15.15.1.1.2.cmml"><mo id="S4.E7.m1.15.15.1.1.2a" xref="S4.E7.m1.15.15.1.1.2.cmml">−</mo><mrow id="S4.E7.m1.15.15.1.1.2.2" xref="S4.E7.m1.15.15.1.1.2.2.cmml"><mstyle displaystyle="true" id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><mfrac id="S4.E7.m1.1.1a" xref="S4.E7.m1.1.1.cmml"><mn id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml">1</mn><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.cmml"><msubsup id="S4.E7.m1.1.1.1.2" xref="S4.E7.m1.1.1.1.2.cmml"><mo id="S4.E7.m1.1.1.1.2.2.2" xref="S4.E7.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E7.m1.1.1.1.2.2.3" xref="S4.E7.m1.1.1.1.2.2.3.cmml"><mi id="S4.E7.m1.1.1.1.2.2.3.2" xref="S4.E7.m1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E7.m1.1.1.1.2.2.3.1" xref="S4.E7.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E7.m1.1.1.1.2.2.3.3" xref="S4.E7.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.1.1.1.2.3" xref="S4.E7.m1.1.1.1.2.3.cmml">G</mi></msubsup><mrow id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.2.cmml"><mo id="S4.E7.m1.1.1.1.1.1.2" lspace="0em" stretchy="false" xref="S4.E7.m1.1.1.1.1.2.1.cmml">|</mo><msub id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S4.E7.m1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mstyle><mo id="S4.E7.m1.15.15.1.1.2.2.3" xref="S4.E7.m1.15.15.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.E7.m1.15.15.1.1.2.2.2" xref="S4.E7.m1.15.15.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E7.m1.15.15.1.1.2.2.2.3" xref="S4.E7.m1.15.15.1.1.2.2.2.3.cmml"><munderover id="S4.E7.m1.15.15.1.1.2.2.2.3a" xref="S4.E7.m1.15.15.1.1.2.2.2.3.cmml"><mo id="S4.E7.m1.15.15.1.1.2.2.2.3.2.2" movablelimits="false" xref="S4.E7.m1.15.15.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E7.m1.15.15.1.1.2.2.2.3.2.3" xref="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.cmml"><mi id="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.2" xref="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.2.cmml">i</mi><mo id="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.1" xref="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.3" xref="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.15.15.1.1.2.2.2.3.3" xref="S4.E7.m1.15.15.1.1.2.2.2.3.3.cmml">G</mi></munderover></mstyle><mrow id="S4.E7.m1.15.15.1.1.2.2.2.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E7.m1.15.15.1.1.2.2.2.2.3" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.cmml"><munderover id="S4.E7.m1.15.15.1.1.2.2.2.2.3a" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.cmml"><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.2" movablelimits="false" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.cmml"><mi id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.2.cmml">t</mi><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.1" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.3" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S4.E7.m1.2.2.1.1" xref="S4.E7.m1.2.2.1.2.cmml"><mo id="S4.E7.m1.2.2.1.1.2" stretchy="false" xref="S4.E7.m1.2.2.1.2.1.cmml">|</mo><msub id="S4.E7.m1.2.2.1.1.1" xref="S4.E7.m1.2.2.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.2.cmml">o</mi><mi id="S4.E7.m1.2.2.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.2.2.1.1.3" stretchy="false" xref="S4.E7.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.3.cmml"><mi id="S4.E7.m1.14.14" xref="S4.E7.m1.14.14.cmml">min</mi><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2a" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.3.cmml">⁡</mo><mrow id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.3.cmml"><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.3" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.3.cmml">(</mo><mrow id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mrow id="S4.E7.m1.4.4.2.4" xref="S4.E7.m1.4.4.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml">i</mi><mo id="S4.E7.m1.4.4.2.4.1" xref="S4.E7.m1.4.4.2.3.cmml">,</mo><mi id="S4.E7.m1.4.4.2.2" xref="S4.E7.m1.4.4.2.2.cmml">t</mi></mrow></msub><mo id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E7.m1.12.12" xref="S4.E7.m1.12.12.cmml">θ</mi><mo id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1a" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.2" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml">A</mi><mo id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.1" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml">^</mo></mover><mrow id="S4.E7.m1.6.6.2.4" xref="S4.E7.m1.6.6.2.3.cmml"><mi id="S4.E7.m1.5.5.1.1" xref="S4.E7.m1.5.5.1.1.cmml">i</mi><mo id="S4.E7.m1.6.6.2.4.1" xref="S4.E7.m1.6.6.2.3.cmml">,</mo><mi id="S4.E7.m1.6.6.2.2" xref="S4.E7.m1.6.6.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.4" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.3.cmml">,</mo><mrow id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.cmml"><mtext id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.5" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.5a.cmml">clip</mtext><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.4" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.4.cmml">⁢</mo><mrow id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml"><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.4" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml">(</mo><mrow id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.cmml"><msub id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.cmml"><mi id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.2.cmml">r</mi><mrow id="S4.E7.m1.8.8.2.4" xref="S4.E7.m1.8.8.2.3.cmml"><mi id="S4.E7.m1.7.7.1.1" xref="S4.E7.m1.7.7.1.1.cmml">i</mi><mo id="S4.E7.m1.8.8.2.4.1" xref="S4.E7.m1.8.8.2.3.cmml">,</mo><mi id="S4.E7.m1.8.8.2.2" xref="S4.E7.m1.8.8.2.2.cmml">t</mi></mrow></msub><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.1" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.3.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.cmml"><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.cmml">(</mo><mi id="S4.E7.m1.13.13" xref="S4.E7.m1.13.13.cmml">θ</mi><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.5" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml">,</mo><mrow id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml"><mn id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.cmml">1</mn><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.1" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.1.cmml">−</mo><mi id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.cmml">ε</mi></mrow><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.6" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml">,</mo><mrow id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.cmml"><mn id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.2.cmml">1</mn><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.1" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.1.cmml">+</mo><mi id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.cmml">ε</mi></mrow><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.7" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml">)</mo></mrow><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.4a" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.4.cmml">⁢</mo><msub id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.cmml"><mover accent="true" id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.cmml"><mi id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.2" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.2.cmml">A</mi><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.1" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.1.cmml">^</mo></mover><mrow id="S4.E7.m1.10.10.2.4" xref="S4.E7.m1.10.10.2.3.cmml"><mi id="S4.E7.m1.9.9.1.1" xref="S4.E7.m1.9.9.1.1.cmml">i</mi><mo id="S4.E7.m1.10.10.2.4.1" xref="S4.E7.m1.10.10.2.3.cmml">,</mo><mi id="S4.E7.m1.10.10.2.2" xref="S4.E7.m1.10.10.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.5" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.15.15.1.2" xref="S4.E7.m1.15.15.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.15b"><apply id="S4.E7.m1.15.15.1.1.cmml" xref="S4.E7.m1.15.15.1"><eq id="S4.E7.m1.15.15.1.1.3.cmml" xref="S4.E7.m1.15.15.1.1.3"></eq><apply id="S4.E7.m1.15.15.1.1.4.cmml" xref="S4.E7.m1.15.15.1.1.4"><times id="S4.E7.m1.15.15.1.1.4.1.cmml" xref="S4.E7.m1.15.15.1.1.4.1"></times><apply id="S4.E7.m1.15.15.1.1.4.2.cmml" xref="S4.E7.m1.15.15.1.1.4.2"><csymbol cd="ambiguous" id="S4.E7.m1.15.15.1.1.4.2.1.cmml" xref="S4.E7.m1.15.15.1.1.4.2">subscript</csymbol><ci id="S4.E7.m1.15.15.1.1.4.2.2.cmml" xref="S4.E7.m1.15.15.1.1.4.2.2">ℒ</ci><ci id="S4.E7.m1.15.15.1.1.4.2.3a.cmml" xref="S4.E7.m1.15.15.1.1.4.2.3"><mtext id="S4.E7.m1.15.15.1.1.4.2.3.cmml" mathsize="70%" xref="S4.E7.m1.15.15.1.1.4.2.3">PPO</mtext></ci></apply><ci id="S4.E7.m1.11.11.cmml" xref="S4.E7.m1.11.11">𝜃</ci></apply><apply id="S4.E7.m1.15.15.1.1.2.cmml" xref="S4.E7.m1.15.15.1.1.2"><minus id="S4.E7.m1.15.15.1.1.2.3.cmml" xref="S4.E7.m1.15.15.1.1.2"></minus><apply id="S4.E7.m1.15.15.1.1.2.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2"><times id="S4.E7.m1.15.15.1.1.2.2.3.cmml" xref="S4.E7.m1.15.15.1.1.2.2.3"></times><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><divide id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1"></divide><cn id="S4.E7.m1.1.1.3.cmml" type="integer" xref="S4.E7.m1.1.1.3">1</cn><apply id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><apply id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.2">superscript</csymbol><apply id="S4.E7.m1.1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.1.1.1.2">subscript</csymbol><sum id="S4.E7.m1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.1.1.1.2.2.2"></sum><apply id="S4.E7.m1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.1.1.1.2.2.3"><eq id="S4.E7.m1.1.1.1.2.2.3.1.cmml" xref="S4.E7.m1.1.1.1.2.2.3.1"></eq><ci id="S4.E7.m1.1.1.1.2.2.3.2.cmml" xref="S4.E7.m1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.E7.m1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E7.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.1.1.1.2.3.cmml" xref="S4.E7.m1.1.1.1.2.3">𝐺</ci></apply><apply id="S4.E7.m1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1"><abs id="S4.E7.m1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.1.2"></abs><apply id="S4.E7.m1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.2">𝑜</ci><ci id="S4.E7.m1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E7.m1.15.15.1.1.2.2.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2"><apply id="S4.E7.m1.15.15.1.1.2.2.2.3.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.15.15.1.1.2.2.2.3.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.3">superscript</csymbol><apply id="S4.E7.m1.15.15.1.1.2.2.2.3.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.15.15.1.1.2.2.2.3.2.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.3">subscript</csymbol><sum id="S4.E7.m1.15.15.1.1.2.2.2.3.2.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.3.2.2"></sum><apply id="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.3.2.3"><eq id="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.1"></eq><ci id="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.2">𝑖</ci><cn id="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.E7.m1.15.15.1.1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E7.m1.15.15.1.1.2.2.2.3.3.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.3.3">𝐺</ci></apply><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2"><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.3.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.15.15.1.1.2.2.2.2.3.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3">superscript</csymbol><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3">subscript</csymbol><sum id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.2"></sum><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3"><eq id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.1"></eq><ci id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.2">𝑡</ci><cn id="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.E7.m1.15.15.1.1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S4.E7.m1.2.2.1.2.cmml" xref="S4.E7.m1.2.2.1.1"><abs id="S4.E7.m1.2.2.1.2.1.cmml" xref="S4.E7.m1.2.2.1.1.2"></abs><apply id="S4.E7.m1.2.2.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E7.m1.2.2.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.2">𝑜</ci><ci id="S4.E7.m1.2.2.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.2.3.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2"><min id="S4.E7.m1.14.14.cmml" xref="S4.E7.m1.14.14"></min><apply id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1"><times id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><list id="S4.E7.m1.4.4.2.3.cmml" xref="S4.E7.m1.4.4.2.4"><ci id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1.1">𝑖</ci><ci id="S4.E7.m1.4.4.2.2.cmml" xref="S4.E7.m1.4.4.2.2">𝑡</ci></list></apply><ci id="S4.E7.m1.12.12.cmml" xref="S4.E7.m1.12.12">𝜃</ci><apply id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2"><ci id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.1">^</ci><ci id="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E7.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.2">𝐴</ci></apply><list id="S4.E7.m1.6.6.2.3.cmml" xref="S4.E7.m1.6.6.2.4"><ci id="S4.E7.m1.5.5.1.1.cmml" xref="S4.E7.m1.5.5.1.1">𝑖</ci><ci id="S4.E7.m1.6.6.2.2.cmml" xref="S4.E7.m1.6.6.2.2">𝑡</ci></list></apply></apply><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2"><times id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.4.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.4"></times><ci id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.5a.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.5"><mtext id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.5.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.5">clip</mtext></ci><vector id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3"><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1"><times id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.1"></times><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.2">𝑟</ci><list id="S4.E7.m1.8.8.2.3.cmml" xref="S4.E7.m1.8.8.2.4"><ci id="S4.E7.m1.7.7.1.1.cmml" xref="S4.E7.m1.7.7.1.1">𝑖</ci><ci id="S4.E7.m1.8.8.2.2.cmml" xref="S4.E7.m1.8.8.2.2">𝑡</ci></list></apply><ci id="S4.E7.m1.13.13.cmml" xref="S4.E7.m1.13.13">𝜃</ci></apply><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2"><minus id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.1"></minus><cn id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.cmml" type="integer" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2">1</cn><ci id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3">𝜀</ci></apply><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3"><plus id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.1"></plus><cn id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.2.cmml" type="integer" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.2">1</cn><ci id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3">𝜀</ci></apply></vector><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6">subscript</csymbol><apply id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2"><ci id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.1.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.1">^</ci><ci id="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.2.cmml" xref="S4.E7.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.2">𝐴</ci></apply><list id="S4.E7.m1.10.10.2.3.cmml" xref="S4.E7.m1.10.10.2.4"><ci id="S4.E7.m1.9.9.1.1.cmml" xref="S4.E7.m1.9.9.1.1">𝑖</ci><ci id="S4.E7.m1.10.10.2.2.cmml" xref="S4.E7.m1.10.10.2.2">𝑡</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.15c">\displaystyle\mathcal{L}_{\text{PPO}}(\theta)=-\frac{1}{\sum_{i=1}^{G}|o_{i}|}%
\sum_{i=1}^{G}\sum_{t=1}^{|o_{i}|}\min\left(r_{i,t}(\theta)\hat{A}_{i,t},\text%
{clip}\left(r_{i,t}(\theta),1-\varepsilon,1+\varepsilon\right)\hat{A}_{i,t}%
\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.15d">caligraphic_L start_POSTSUBSCRIPT PPO end_POSTSUBSCRIPT ( italic_θ ) = - divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT | italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT roman_min ( italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ( italic_θ ) over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT , clip ( italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ( italic_θ ) , 1 - italic_ε , 1 + italic_ε ) over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p5.5">where all tokens within a single training batch are assigned uniform weights, thereby enabling the problems posed by long sequences to be addressed with enhanced efficiency.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Dealing with Sparsity of Reward Signal in Verifier-based Tasks</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">As analyzed in Section <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S3.SS3" title="3.3 Sparsity of Reward Signal in Verifier-based Tasks ‣ 3 Challenges in Long-CoT RL for Reasoning Tasks ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_tag">3.3</span></a>, enhancing the efficiency of exploration-exploitation tradeoff in RL training becomes critically challenging under scenarios with highly sparse reward signals. To address this key issue, we adopt three methods: Clip-Higher, Positive Example LM Loss and Group-Sampling. The technical details are elaborated as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.2"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.2.1">Clip-Higher</span> is used to mitigate the entropy collapse issue encountered in PPO and GRPO training process, which is first proposed in DAPO <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib29" title="">29</a>]</cite>. We decouple the lower and higher clipping range as <math alttext="\varepsilon_{\text{low}}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><msub id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">ε</mi><mtext id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3a.cmml">low</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝜀</ci><ci id="S4.SS3.p2.1.m1.1.1.3a.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><mtext id="S4.SS3.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS3.p2.1.m1.1.1.3">low</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\varepsilon_{\text{low}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_ε start_POSTSUBSCRIPT low end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\varepsilon_{\text{high}}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">ε</mi><mtext id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3a.cmml">high</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝜀</ci><ci id="S4.SS3.p2.2.m2.1.1.3a.cmml" xref="S4.SS3.p2.2.m2.1.1.3"><mtext id="S4.SS3.p2.2.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS3.p2.2.m2.1.1.3">high</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\varepsilon_{\text{high}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_ε start_POSTSUBSCRIPT high end_POSTSUBSCRIPT</annotation></semantics></math></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx4">
<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{PPO}}(\theta)=-\frac{1}{\sum_{i=1}^{G}|o_{i}|}%
\sum_{i=1}^{G}\sum_{t=1}^{|o_{i}|}\min\left(r_{i,t}(\theta)\hat{A}_{i,t},\text%
{clip}\left(r_{i,t}(\theta),1-{\color[rgb]{1,0,0}\definecolor[named]{%
pgfstrokecolor}{rgb}{1,0,0}\varepsilon_{\text{low}}},1+{\color[rgb]{1,0,0}%
\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}\varepsilon_{\text{high}}}%
\right)\hat{A}_{i,t}\right)," class="ltx_Math" display="inline" id="S4.E8.m1.15"><semantics id="S4.E8.m1.15a"><mrow id="S4.E8.m1.15.15.1" xref="S4.E8.m1.15.15.1.1.cmml"><mrow id="S4.E8.m1.15.15.1.1" xref="S4.E8.m1.15.15.1.1.cmml"><mrow id="S4.E8.m1.15.15.1.1.4" xref="S4.E8.m1.15.15.1.1.4.cmml"><msub id="S4.E8.m1.15.15.1.1.4.2" xref="S4.E8.m1.15.15.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.15.15.1.1.4.2.2" xref="S4.E8.m1.15.15.1.1.4.2.2.cmml">ℒ</mi><mtext id="S4.E8.m1.15.15.1.1.4.2.3" xref="S4.E8.m1.15.15.1.1.4.2.3a.cmml">PPO</mtext></msub><mo id="S4.E8.m1.15.15.1.1.4.1" xref="S4.E8.m1.15.15.1.1.4.1.cmml">⁢</mo><mrow id="S4.E8.m1.15.15.1.1.4.3.2" xref="S4.E8.m1.15.15.1.1.4.cmml"><mo id="S4.E8.m1.15.15.1.1.4.3.2.1" stretchy="false" xref="S4.E8.m1.15.15.1.1.4.cmml">(</mo><mi id="S4.E8.m1.11.11" xref="S4.E8.m1.11.11.cmml">θ</mi><mo id="S4.E8.m1.15.15.1.1.4.3.2.2" stretchy="false" xref="S4.E8.m1.15.15.1.1.4.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.15.15.1.1.3" xref="S4.E8.m1.15.15.1.1.3.cmml">=</mo><mrow id="S4.E8.m1.15.15.1.1.2" xref="S4.E8.m1.15.15.1.1.2.cmml"><mo id="S4.E8.m1.15.15.1.1.2a" xref="S4.E8.m1.15.15.1.1.2.cmml">−</mo><mrow id="S4.E8.m1.15.15.1.1.2.2" xref="S4.E8.m1.15.15.1.1.2.2.cmml"><mstyle displaystyle="true" id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><mfrac id="S4.E8.m1.1.1a" xref="S4.E8.m1.1.1.cmml"><mn id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml">1</mn><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.cmml"><mo id="S4.E8.m1.1.1.1.2.2.2" xref="S4.E8.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E8.m1.1.1.1.2.2.3" xref="S4.E8.m1.1.1.1.2.2.3.cmml"><mi id="S4.E8.m1.1.1.1.2.2.3.2" xref="S4.E8.m1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E8.m1.1.1.1.2.2.3.1" xref="S4.E8.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E8.m1.1.1.1.2.2.3.3" xref="S4.E8.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.2.3.cmml">G</mi></msubsup><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.2.cmml"><mo id="S4.E8.m1.1.1.1.1.1.2" lspace="0em" stretchy="false" xref="S4.E8.m1.1.1.1.1.2.1.cmml">|</mo><msub id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S4.E8.m1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E8.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mstyle><mo id="S4.E8.m1.15.15.1.1.2.2.3" xref="S4.E8.m1.15.15.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.E8.m1.15.15.1.1.2.2.2" xref="S4.E8.m1.15.15.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E8.m1.15.15.1.1.2.2.2.3" xref="S4.E8.m1.15.15.1.1.2.2.2.3.cmml"><munderover id="S4.E8.m1.15.15.1.1.2.2.2.3a" xref="S4.E8.m1.15.15.1.1.2.2.2.3.cmml"><mo id="S4.E8.m1.15.15.1.1.2.2.2.3.2.2" movablelimits="false" xref="S4.E8.m1.15.15.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E8.m1.15.15.1.1.2.2.2.3.2.3" xref="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.cmml"><mi id="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.2" xref="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.2.cmml">i</mi><mo id="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.1" xref="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.3" xref="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.15.15.1.1.2.2.2.3.3" xref="S4.E8.m1.15.15.1.1.2.2.2.3.3.cmml">G</mi></munderover></mstyle><mrow id="S4.E8.m1.15.15.1.1.2.2.2.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E8.m1.15.15.1.1.2.2.2.2.3" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.cmml"><munderover id="S4.E8.m1.15.15.1.1.2.2.2.2.3a" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.cmml"><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.2" movablelimits="false" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.cmml"><mi id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.2.cmml">t</mi><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.1" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.3" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mrow id="S4.E8.m1.2.2.1.1" xref="S4.E8.m1.2.2.1.2.cmml"><mo id="S4.E8.m1.2.2.1.1.2" stretchy="false" xref="S4.E8.m1.2.2.1.2.1.cmml">|</mo><msub id="S4.E8.m1.2.2.1.1.1" xref="S4.E8.m1.2.2.1.1.1.cmml"><mi id="S4.E8.m1.2.2.1.1.1.2" xref="S4.E8.m1.2.2.1.1.1.2.cmml">o</mi><mi id="S4.E8.m1.2.2.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.E8.m1.2.2.1.1.3" stretchy="false" xref="S4.E8.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.3.cmml"><mi id="S4.E8.m1.14.14" xref="S4.E8.m1.14.14.cmml">min</mi><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2a" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.3.cmml">⁡</mo><mrow id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.3.cmml"><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.3" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.3.cmml">(</mo><mrow id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mrow id="S4.E8.m1.4.4.2.4" xref="S4.E8.m1.4.4.2.3.cmml"><mi id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml">i</mi><mo id="S4.E8.m1.4.4.2.4.1" xref="S4.E8.m1.4.4.2.3.cmml">,</mo><mi id="S4.E8.m1.4.4.2.2" xref="S4.E8.m1.4.4.2.2.cmml">t</mi></mrow></msub><mo id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E8.m1.12.12" xref="S4.E8.m1.12.12.cmml">θ</mi><mo id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.1a" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.2" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml">A</mi><mo id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.1" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml">^</mo></mover><mrow id="S4.E8.m1.6.6.2.4" xref="S4.E8.m1.6.6.2.3.cmml"><mi id="S4.E8.m1.5.5.1.1" xref="S4.E8.m1.5.5.1.1.cmml">i</mi><mo id="S4.E8.m1.6.6.2.4.1" xref="S4.E8.m1.6.6.2.3.cmml">,</mo><mi id="S4.E8.m1.6.6.2.2" xref="S4.E8.m1.6.6.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.4" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.3.cmml">,</mo><mrow id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.cmml"><mtext id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.5" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.5a.cmml">clip</mtext><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.4" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.4.cmml">⁢</mo><mrow id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml"><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.4" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml">(</mo><mrow id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.cmml"><msub id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.cmml"><mi id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.2.cmml">r</mi><mrow id="S4.E8.m1.8.8.2.4" xref="S4.E8.m1.8.8.2.3.cmml"><mi id="S4.E8.m1.7.7.1.1" xref="S4.E8.m1.7.7.1.1.cmml">i</mi><mo id="S4.E8.m1.8.8.2.4.1" xref="S4.E8.m1.8.8.2.3.cmml">,</mo><mi id="S4.E8.m1.8.8.2.2" xref="S4.E8.m1.8.8.2.2.cmml">t</mi></mrow></msub><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.1" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.3.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.cmml"><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.cmml">(</mo><mi id="S4.E8.m1.13.13" xref="S4.E8.m1.13.13.cmml">θ</mi><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.5" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml">,</mo><mrow id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml"><mn id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.cmml">1</mn><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.1" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.1.cmml">−</mo><msub id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.cmml"><mi id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.2" mathcolor="#FF0000" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.2.cmml">ε</mi><mtext id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.3" mathcolor="#FF0000" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.3a.cmml">low</mtext></msub></mrow><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.6" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml">,</mo><mrow id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.cmml"><mn id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.2.cmml">1</mn><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.1" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.1.cmml">+</mo><msub id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.cmml"><mi id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.2" mathcolor="#FF0000" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.2.cmml">ε</mi><mtext id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.3" mathcolor="#FF0000" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.3a.cmml">high</mtext></msub></mrow><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.7" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml">)</mo></mrow><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.4a" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.4.cmml">⁢</mo><msub id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.cmml"><mover accent="true" id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.cmml"><mi id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.2" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.2.cmml">A</mi><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.1" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.1.cmml">^</mo></mover><mrow id="S4.E8.m1.10.10.2.4" xref="S4.E8.m1.10.10.2.3.cmml"><mi id="S4.E8.m1.9.9.1.1" xref="S4.E8.m1.9.9.1.1.cmml">i</mi><mo id="S4.E8.m1.10.10.2.4.1" xref="S4.E8.m1.10.10.2.3.cmml">,</mo><mi id="S4.E8.m1.10.10.2.2" xref="S4.E8.m1.10.10.2.2.cmml">t</mi></mrow></msub></mrow><mo id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.5" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.15.15.1.2" xref="S4.E8.m1.15.15.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.15b"><apply id="S4.E8.m1.15.15.1.1.cmml" xref="S4.E8.m1.15.15.1"><eq id="S4.E8.m1.15.15.1.1.3.cmml" xref="S4.E8.m1.15.15.1.1.3"></eq><apply id="S4.E8.m1.15.15.1.1.4.cmml" xref="S4.E8.m1.15.15.1.1.4"><times id="S4.E8.m1.15.15.1.1.4.1.cmml" xref="S4.E8.m1.15.15.1.1.4.1"></times><apply id="S4.E8.m1.15.15.1.1.4.2.cmml" xref="S4.E8.m1.15.15.1.1.4.2"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.4.2.1.cmml" xref="S4.E8.m1.15.15.1.1.4.2">subscript</csymbol><ci id="S4.E8.m1.15.15.1.1.4.2.2.cmml" xref="S4.E8.m1.15.15.1.1.4.2.2">ℒ</ci><ci id="S4.E8.m1.15.15.1.1.4.2.3a.cmml" xref="S4.E8.m1.15.15.1.1.4.2.3"><mtext id="S4.E8.m1.15.15.1.1.4.2.3.cmml" mathsize="70%" xref="S4.E8.m1.15.15.1.1.4.2.3">PPO</mtext></ci></apply><ci id="S4.E8.m1.11.11.cmml" xref="S4.E8.m1.11.11">𝜃</ci></apply><apply id="S4.E8.m1.15.15.1.1.2.cmml" xref="S4.E8.m1.15.15.1.1.2"><minus id="S4.E8.m1.15.15.1.1.2.3.cmml" xref="S4.E8.m1.15.15.1.1.2"></minus><apply id="S4.E8.m1.15.15.1.1.2.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2"><times id="S4.E8.m1.15.15.1.1.2.2.3.cmml" xref="S4.E8.m1.15.15.1.1.2.2.3"></times><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><divide id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1"></divide><cn id="S4.E8.m1.1.1.3.cmml" type="integer" xref="S4.E8.m1.1.1.3">1</cn><apply id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><apply id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.2">superscript</csymbol><apply id="S4.E8.m1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.1.1.1.2">subscript</csymbol><sum id="S4.E8.m1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.1.1.1.2.2.2"></sum><apply id="S4.E8.m1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.1.1.1.2.2.3"><eq id="S4.E8.m1.1.1.1.2.2.3.1.cmml" xref="S4.E8.m1.1.1.1.2.2.3.1"></eq><ci id="S4.E8.m1.1.1.1.2.2.3.2.cmml" xref="S4.E8.m1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.E8.m1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E8.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E8.m1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.2.3">𝐺</ci></apply><apply id="S4.E8.m1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1"><abs id="S4.E8.m1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.2"></abs><apply id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2">𝑜</ci><ci id="S4.E8.m1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E8.m1.15.15.1.1.2.2.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2"><apply id="S4.E8.m1.15.15.1.1.2.2.2.3.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.2.2.2.3.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.3">superscript</csymbol><apply id="S4.E8.m1.15.15.1.1.2.2.2.3.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.2.2.2.3.2.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.3">subscript</csymbol><sum id="S4.E8.m1.15.15.1.1.2.2.2.3.2.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.3.2.2"></sum><apply id="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.3.2.3"><eq id="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.1"></eq><ci id="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.2">𝑖</ci><cn id="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.E8.m1.15.15.1.1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E8.m1.15.15.1.1.2.2.2.3.3.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.3.3">𝐺</ci></apply><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2"><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.2.2.2.2.3.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3">superscript</csymbol><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3">subscript</csymbol><sum id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.2"></sum><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3"><eq id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.1"></eq><ci id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.2">𝑡</ci><cn id="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.3.cmml" type="integer" xref="S4.E8.m1.15.15.1.1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S4.E8.m1.2.2.1.2.cmml" xref="S4.E8.m1.2.2.1.1"><abs id="S4.E8.m1.2.2.1.2.1.cmml" xref="S4.E8.m1.2.2.1.1.2"></abs><apply id="S4.E8.m1.2.2.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E8.m1.2.2.1.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.1.2">𝑜</ci><ci id="S4.E8.m1.2.2.1.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.2.3.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2"><min id="S4.E8.m1.14.14.cmml" xref="S4.E8.m1.14.14"></min><apply id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1"><times id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.2.2">𝑟</ci><list id="S4.E8.m1.4.4.2.3.cmml" xref="S4.E8.m1.4.4.2.4"><ci id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1.1">𝑖</ci><ci id="S4.E8.m1.4.4.2.2.cmml" xref="S4.E8.m1.4.4.2.2">𝑡</ci></list></apply><ci id="S4.E8.m1.12.12.cmml" xref="S4.E8.m1.12.12">𝜃</ci><apply id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><apply id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2"><ci id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.1">^</ci><ci id="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E8.m1.15.15.1.1.1.1.1.1.1.1.1.1.4.2.2">𝐴</ci></apply><list id="S4.E8.m1.6.6.2.3.cmml" xref="S4.E8.m1.6.6.2.4"><ci id="S4.E8.m1.5.5.1.1.cmml" xref="S4.E8.m1.5.5.1.1">𝑖</ci><ci id="S4.E8.m1.6.6.2.2.cmml" xref="S4.E8.m1.6.6.2.2">𝑡</ci></list></apply></apply><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2"><times id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.4.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.4"></times><ci id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.5a.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.5"><mtext id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.5.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.5">clip</mtext></ci><vector id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.4.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3"><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1"><times id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.1"></times><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.1.1.1.2.2">𝑟</ci><list id="S4.E8.m1.8.8.2.3.cmml" xref="S4.E8.m1.8.8.2.4"><ci id="S4.E8.m1.7.7.1.1.cmml" xref="S4.E8.m1.7.7.1.1">𝑖</ci><ci id="S4.E8.m1.8.8.2.2.cmml" xref="S4.E8.m1.8.8.2.2">𝑡</ci></list></apply><ci id="S4.E8.m1.13.13.cmml" xref="S4.E8.m1.13.13">𝜃</ci></apply><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2"><minus id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.1"></minus><cn id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2.cmml" type="integer" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.2">1</cn><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.2">𝜀</ci><ci id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.3a.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.3"><mtext id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.3.cmml" mathcolor="#FF0000" mathsize="70%" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.2.2.2.3.3">low</mtext></ci></apply></apply><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3"><plus id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.1"></plus><cn id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.2.cmml" type="integer" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.2">1</cn><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3">subscript</csymbol><ci id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.2">𝜀</ci><ci id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.3a.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.3"><mtext id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.3.cmml" mathcolor="#FF0000" mathsize="70%" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.3.3.3.3.3">high</mtext></ci></apply></apply></vector><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6">subscript</csymbol><apply id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2"><ci id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.1.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.1">^</ci><ci id="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.2.cmml" xref="S4.E8.m1.15.15.1.1.2.2.2.2.2.2.2.2.6.2.2">𝐴</ci></apply><list id="S4.E8.m1.10.10.2.3.cmml" xref="S4.E8.m1.10.10.2.4"><ci id="S4.E8.m1.9.9.1.1.cmml" xref="S4.E8.m1.9.9.1.1">𝑖</ci><ci id="S4.E8.m1.10.10.2.2.cmml" xref="S4.E8.m1.10.10.2.2">𝑡</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.15c">\displaystyle\mathcal{L}_{\text{PPO}}(\theta)=-\frac{1}{\sum_{i=1}^{G}|o_{i}|}%
\sum_{i=1}^{G}\sum_{t=1}^{|o_{i}|}\min\left(r_{i,t}(\theta)\hat{A}_{i,t},\text%
{clip}\left(r_{i,t}(\theta),1-{\color[rgb]{1,0,0}\definecolor[named]{%
pgfstrokecolor}{rgb}{1,0,0}\varepsilon_{\text{low}}},1+{\color[rgb]{1,0,0}%
\definecolor[named]{pgfstrokecolor}{rgb}{1,0,0}\varepsilon_{\text{high}}}%
\right)\hat{A}_{i,t}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.15d">caligraphic_L start_POSTSUBSCRIPT PPO end_POSTSUBSCRIPT ( italic_θ ) = - divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT | italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_G end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT roman_min ( italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ( italic_θ ) over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT , clip ( italic_r start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ( italic_θ ) , 1 - italic_ε start_POSTSUBSCRIPT low end_POSTSUBSCRIPT , 1 + italic_ε start_POSTSUBSCRIPT high end_POSTSUBSCRIPT ) over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_i , italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p2.4">We increase the value of <math alttext="\varepsilon_{\text{high}}" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m1.1"><semantics id="S4.SS3.p2.3.m1.1a"><msub id="S4.SS3.p2.3.m1.1.1" xref="S4.SS3.p2.3.m1.1.1.cmml"><mi id="S4.SS3.p2.3.m1.1.1.2" xref="S4.SS3.p2.3.m1.1.1.2.cmml">ε</mi><mtext id="S4.SS3.p2.3.m1.1.1.3" xref="S4.SS3.p2.3.m1.1.1.3a.cmml">high</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m1.1b"><apply id="S4.SS3.p2.3.m1.1.1.cmml" xref="S4.SS3.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m1.1.1.1.cmml" xref="S4.SS3.p2.3.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m1.1.1.2.cmml" xref="S4.SS3.p2.3.m1.1.1.2">𝜀</ci><ci id="S4.SS3.p2.3.m1.1.1.3a.cmml" xref="S4.SS3.p2.3.m1.1.1.3"><mtext id="S4.SS3.p2.3.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS3.p2.3.m1.1.1.3">high</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m1.1c">\varepsilon_{\text{high}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m1.1d">italic_ε start_POSTSUBSCRIPT high end_POSTSUBSCRIPT</annotation></semantics></math> to leave more room for the increase of low-probability tokens. We opt to keep <math alttext="\varepsilon_{\text{low}}" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m2.1"><semantics id="S4.SS3.p2.4.m2.1a"><msub id="S4.SS3.p2.4.m2.1.1" xref="S4.SS3.p2.4.m2.1.1.cmml"><mi id="S4.SS3.p2.4.m2.1.1.2" xref="S4.SS3.p2.4.m2.1.1.2.cmml">ε</mi><mtext id="S4.SS3.p2.4.m2.1.1.3" xref="S4.SS3.p2.4.m2.1.1.3a.cmml">low</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m2.1b"><apply id="S4.SS3.p2.4.m2.1.1.cmml" xref="S4.SS3.p2.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m2.1.1.1.cmml" xref="S4.SS3.p2.4.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.4.m2.1.1.2.cmml" xref="S4.SS3.p2.4.m2.1.1.2">𝜀</ci><ci id="S4.SS3.p2.4.m2.1.1.3a.cmml" xref="S4.SS3.p2.4.m2.1.1.3"><mtext id="S4.SS3.p2.4.m2.1.1.3.cmml" mathsize="70%" xref="S4.SS3.p2.4.m2.1.1.3">low</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m2.1c">\varepsilon_{\text{low}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m2.1d">italic_ε start_POSTSUBSCRIPT low end_POSTSUBSCRIPT</annotation></semantics></math> relatively small, because increasing it will suppress the probability of these tokens to 0, resulting in the collapse of the sampling space.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.3"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.3.1">Positive Example LM Loss</span> is designed to enhance the utilization efficiency of positive samples during RL training process. In the context of RL for complex reasoning tasks, some tasks demonstrate remarkably low accuracy, with the majority of training samples yielding incorrect answers. Traditional policy optimization strategies that suppress the generation probability of erroneous samples suffer from inefficiency during RL training, as the trial-and-error mechanism incurs substantial computational costs. Given this challenge, it is critical to maximize the utility of correct answers when they are sampled by the policy model. To address this challenge, we adopt an imitation learning approach by incorporating an additional negative log-likelihood (NLL) loss for the correct outcomes sampled during RL training. The corresponding formula is as follows:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx5">
<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{NLL}}(\theta)=-\frac{1}{\sum_{o_{i}\in\mathcal%
{T}}|o_{i}|}\sum_{o_{i}\in\mathcal{T}}\sum_{t=1}^{|o_{i}|}\log\pi_{\theta}%
\left(a_{t}|s_{t}\right)," class="ltx_Math" display="inline" id="S4.E9.m1.4"><semantics id="S4.E9.m1.4a"><mrow id="S4.E9.m1.4.4.1" xref="S4.E9.m1.4.4.1.1.cmml"><mrow id="S4.E9.m1.4.4.1.1" xref="S4.E9.m1.4.4.1.1.cmml"><mrow id="S4.E9.m1.4.4.1.1.3" xref="S4.E9.m1.4.4.1.1.3.cmml"><msub id="S4.E9.m1.4.4.1.1.3.2" xref="S4.E9.m1.4.4.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.4.4.1.1.3.2.2" xref="S4.E9.m1.4.4.1.1.3.2.2.cmml">ℒ</mi><mtext id="S4.E9.m1.4.4.1.1.3.2.3" xref="S4.E9.m1.4.4.1.1.3.2.3a.cmml">NLL</mtext></msub><mo id="S4.E9.m1.4.4.1.1.3.1" xref="S4.E9.m1.4.4.1.1.3.1.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.1.1.3.3.2" xref="S4.E9.m1.4.4.1.1.3.cmml"><mo id="S4.E9.m1.4.4.1.1.3.3.2.1" stretchy="false" xref="S4.E9.m1.4.4.1.1.3.cmml">(</mo><mi id="S4.E9.m1.3.3" xref="S4.E9.m1.3.3.cmml">θ</mi><mo id="S4.E9.m1.4.4.1.1.3.3.2.2" stretchy="false" xref="S4.E9.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.4.4.1.1.2" xref="S4.E9.m1.4.4.1.1.2.cmml">=</mo><mrow id="S4.E9.m1.4.4.1.1.1" xref="S4.E9.m1.4.4.1.1.1.cmml"><mo id="S4.E9.m1.4.4.1.1.1a" xref="S4.E9.m1.4.4.1.1.1.cmml">−</mo><mrow id="S4.E9.m1.4.4.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml"><mfrac id="S4.E9.m1.1.1a" xref="S4.E9.m1.1.1.cmml"><mn id="S4.E9.m1.1.1.3" xref="S4.E9.m1.1.1.3.cmml">1</mn><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.cmml"><msub id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.2.cmml"><mo id="S4.E9.m1.1.1.1.2.2" xref="S4.E9.m1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.2.3.cmml"><msub id="S4.E9.m1.1.1.1.2.3.2" xref="S4.E9.m1.1.1.1.2.3.2.cmml"><mi id="S4.E9.m1.1.1.1.2.3.2.2" xref="S4.E9.m1.1.1.1.2.3.2.2.cmml">o</mi><mi id="S4.E9.m1.1.1.1.2.3.2.3" xref="S4.E9.m1.1.1.1.2.3.2.3.cmml">i</mi></msub><mo id="S4.E9.m1.1.1.1.2.3.1" xref="S4.E9.m1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.1.1.1.2.3.3" xref="S4.E9.m1.1.1.1.2.3.3.cmml">𝒯</mi></mrow></msub><mrow id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.2.cmml"><mo id="S4.E9.m1.1.1.1.1.1.2" lspace="0em" stretchy="false" xref="S4.E9.m1.1.1.1.1.2.1.cmml">|</mo><msub id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.2.cmml">o</mi><mi id="S4.E9.m1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E9.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mfrac></mstyle><mo id="S4.E9.m1.4.4.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E9.m1.4.4.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.2.cmml"><munder id="S4.E9.m1.4.4.1.1.1.1.1.2a" xref="S4.E9.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S4.E9.m1.4.4.1.1.1.1.1.2.2" movablelimits="false" xref="S4.E9.m1.4.4.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.cmml"><msub id="S4.E9.m1.4.4.1.1.1.1.1.2.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.2" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.2.cmml">o</mi><mi id="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.3.cmml">i</mi></msub><mo id="S4.E9.m1.4.4.1.1.1.1.1.2.3.1" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.4.4.1.1.1.1.1.2.3.3" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.3.cmml">𝒯</mi></mrow></munder></mstyle><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E9.m1.4.4.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.cmml"><munderover id="S4.E9.m1.4.4.1.1.1.1.1.1.2a" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E9.m1.2.2.1.1" xref="S4.E9.m1.2.2.1.2.cmml"><mo id="S4.E9.m1.2.2.1.1.2" stretchy="false" xref="S4.E9.m1.2.2.1.2.1.cmml">|</mo><msub id="S4.E9.m1.2.2.1.1.1" xref="S4.E9.m1.2.2.1.1.1.cmml"><mi id="S4.E9.m1.2.2.1.1.1.2" xref="S4.E9.m1.2.2.1.1.1.2.cmml">o</mi><mi id="S4.E9.m1.2.2.1.1.1.3" xref="S4.E9.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S4.E9.m1.2.2.1.1.3" stretchy="false" xref="S4.E9.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.2.cmml">π</mi><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E9.m1.4.4.1.2" xref="S4.E9.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.4b"><apply id="S4.E9.m1.4.4.1.1.cmml" xref="S4.E9.m1.4.4.1"><eq id="S4.E9.m1.4.4.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.2"></eq><apply id="S4.E9.m1.4.4.1.1.3.cmml" xref="S4.E9.m1.4.4.1.1.3"><times id="S4.E9.m1.4.4.1.1.3.1.cmml" xref="S4.E9.m1.4.4.1.1.3.1"></times><apply id="S4.E9.m1.4.4.1.1.3.2.cmml" xref="S4.E9.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.3.2.1.cmml" xref="S4.E9.m1.4.4.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.3.2.2.cmml" xref="S4.E9.m1.4.4.1.1.3.2.2">ℒ</ci><ci id="S4.E9.m1.4.4.1.1.3.2.3a.cmml" xref="S4.E9.m1.4.4.1.1.3.2.3"><mtext id="S4.E9.m1.4.4.1.1.3.2.3.cmml" mathsize="70%" xref="S4.E9.m1.4.4.1.1.3.2.3">NLL</mtext></ci></apply><ci id="S4.E9.m1.3.3.cmml" xref="S4.E9.m1.3.3">𝜃</ci></apply><apply id="S4.E9.m1.4.4.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1"><minus id="S4.E9.m1.4.4.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1"></minus><apply id="S4.E9.m1.4.4.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1"><times id="S4.E9.m1.4.4.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.2"></times><apply id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1"><divide id="S4.E9.m1.1.1.2.cmml" xref="S4.E9.m1.1.1"></divide><cn id="S4.E9.m1.1.1.3.cmml" type="integer" xref="S4.E9.m1.1.1.3">1</cn><apply id="S4.E9.m1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><apply id="S4.E9.m1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.2">subscript</csymbol><sum id="S4.E9.m1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.2.2"></sum><apply id="S4.E9.m1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.2.3"><in id="S4.E9.m1.1.1.1.2.3.1.cmml" xref="S4.E9.m1.1.1.1.2.3.1"></in><apply id="S4.E9.m1.1.1.1.2.3.2.cmml" xref="S4.E9.m1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.2.3.2.1.cmml" xref="S4.E9.m1.1.1.1.2.3.2">subscript</csymbol><ci id="S4.E9.m1.1.1.1.2.3.2.2.cmml" xref="S4.E9.m1.1.1.1.2.3.2.2">𝑜</ci><ci id="S4.E9.m1.1.1.1.2.3.2.3.cmml" xref="S4.E9.m1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S4.E9.m1.1.1.1.2.3.3.cmml" xref="S4.E9.m1.1.1.1.2.3.3">𝒯</ci></apply></apply><apply id="S4.E9.m1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1"><abs id="S4.E9.m1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.2"></abs><apply id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2">𝑜</ci><ci id="S4.E9.m1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1"><apply id="S4.E9.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E9.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.2.2"></sum><apply id="S4.E9.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3"><in id="S4.E9.m1.4.4.1.1.1.1.1.2.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.1"></in><apply id="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.2">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.2">𝑜</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S4.E9.m1.4.4.1.1.1.1.1.2.3.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.2.3.3">𝒯</ci></apply></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1"><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3"><eq id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E9.m1.4.4.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E9.m1.2.2.1.2.cmml" xref="S4.E9.m1.2.2.1.1"><abs id="S4.E9.m1.2.2.1.2.1.cmml" xref="S4.E9.m1.2.2.1.1.2"></abs><apply id="S4.E9.m1.2.2.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.1.1.1.1.cmml" xref="S4.E9.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E9.m1.2.2.1.1.1.2.cmml" xref="S4.E9.m1.2.2.1.1.1.2">𝑜</ci><ci id="S4.E9.m1.2.2.1.1.1.3.cmml" xref="S4.E9.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1"><times id="S4.E9.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.2"></times><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3"><log id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.1"></log><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.2">𝜋</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.4c">\displaystyle\mathcal{L}_{\text{NLL}}(\theta)=-\frac{1}{\sum_{o_{i}\in\mathcal%
{T}}|o_{i}|}\sum_{o_{i}\in\mathcal{T}}\sum_{t=1}^{|o_{i}|}\log\pi_{\theta}%
\left(a_{t}|s_{t}\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.4d">caligraphic_L start_POSTSUBSCRIPT NLL end_POSTSUBSCRIPT ( italic_θ ) = - divide start_ARG 1 end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_T end_POSTSUBSCRIPT | italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_T end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_o start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p3.2">where <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">𝒯</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝒯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\mathcal{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">caligraphic_T</annotation></semantics></math> denotes the set of correct answers. The final NLL loss is combined with the policy gradient loss through a weighting coefficient <math alttext="\mu" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_μ</annotation></semantics></math>, which collectively serves as the objective for updating the policy model:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx6">
<tbody id="S4.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}(\theta)=\mathcal{L}_{\text{PPO}}(\theta)+\mu*\mathcal%
{L}_{\text{NLL}}(\theta)." class="ltx_Math" display="inline" id="S4.E10.m1.4"><semantics id="S4.E10.m1.4a"><mrow id="S4.E10.m1.4.4.1" xref="S4.E10.m1.4.4.1.1.cmml"><mrow id="S4.E10.m1.4.4.1.1" xref="S4.E10.m1.4.4.1.1.cmml"><mrow id="S4.E10.m1.4.4.1.1.2" xref="S4.E10.m1.4.4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.4.4.1.1.2.2" xref="S4.E10.m1.4.4.1.1.2.2.cmml">ℒ</mi><mo id="S4.E10.m1.4.4.1.1.2.1" xref="S4.E10.m1.4.4.1.1.2.1.cmml">⁢</mo><mrow id="S4.E10.m1.4.4.1.1.2.3.2" xref="S4.E10.m1.4.4.1.1.2.cmml"><mo id="S4.E10.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="S4.E10.m1.4.4.1.1.2.cmml">(</mo><mi id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml">θ</mi><mo id="S4.E10.m1.4.4.1.1.2.3.2.2" stretchy="false" xref="S4.E10.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.4.4.1.1.1" xref="S4.E10.m1.4.4.1.1.1.cmml">=</mo><mrow id="S4.E10.m1.4.4.1.1.3" xref="S4.E10.m1.4.4.1.1.3.cmml"><mrow id="S4.E10.m1.4.4.1.1.3.2" xref="S4.E10.m1.4.4.1.1.3.2.cmml"><msub id="S4.E10.m1.4.4.1.1.3.2.2" xref="S4.E10.m1.4.4.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.4.4.1.1.3.2.2.2" xref="S4.E10.m1.4.4.1.1.3.2.2.2.cmml">ℒ</mi><mtext id="S4.E10.m1.4.4.1.1.3.2.2.3" xref="S4.E10.m1.4.4.1.1.3.2.2.3a.cmml">PPO</mtext></msub><mo id="S4.E10.m1.4.4.1.1.3.2.1" xref="S4.E10.m1.4.4.1.1.3.2.1.cmml">⁢</mo><mrow id="S4.E10.m1.4.4.1.1.3.2.3.2" xref="S4.E10.m1.4.4.1.1.3.2.cmml"><mo id="S4.E10.m1.4.4.1.1.3.2.3.2.1" stretchy="false" xref="S4.E10.m1.4.4.1.1.3.2.cmml">(</mo><mi id="S4.E10.m1.2.2" xref="S4.E10.m1.2.2.cmml">θ</mi><mo id="S4.E10.m1.4.4.1.1.3.2.3.2.2" stretchy="false" xref="S4.E10.m1.4.4.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.4.4.1.1.3.1" xref="S4.E10.m1.4.4.1.1.3.1.cmml">+</mo><mrow id="S4.E10.m1.4.4.1.1.3.3" xref="S4.E10.m1.4.4.1.1.3.3.cmml"><mrow id="S4.E10.m1.4.4.1.1.3.3.2" xref="S4.E10.m1.4.4.1.1.3.3.2.cmml"><mi id="S4.E10.m1.4.4.1.1.3.3.2.2" xref="S4.E10.m1.4.4.1.1.3.3.2.2.cmml">μ</mi><mo id="S4.E10.m1.4.4.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E10.m1.4.4.1.1.3.3.2.1.cmml">∗</mo><msub id="S4.E10.m1.4.4.1.1.3.3.2.3" xref="S4.E10.m1.4.4.1.1.3.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.4.4.1.1.3.3.2.3.2" xref="S4.E10.m1.4.4.1.1.3.3.2.3.2.cmml">ℒ</mi><mtext id="S4.E10.m1.4.4.1.1.3.3.2.3.3" xref="S4.E10.m1.4.4.1.1.3.3.2.3.3a.cmml">NLL</mtext></msub></mrow><mo id="S4.E10.m1.4.4.1.1.3.3.1" xref="S4.E10.m1.4.4.1.1.3.3.1.cmml">⁢</mo><mrow id="S4.E10.m1.4.4.1.1.3.3.3.2" xref="S4.E10.m1.4.4.1.1.3.3.cmml"><mo id="S4.E10.m1.4.4.1.1.3.3.3.2.1" stretchy="false" xref="S4.E10.m1.4.4.1.1.3.3.cmml">(</mo><mi id="S4.E10.m1.3.3" xref="S4.E10.m1.3.3.cmml">θ</mi><mo id="S4.E10.m1.4.4.1.1.3.3.3.2.2" stretchy="false" xref="S4.E10.m1.4.4.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E10.m1.4.4.1.2" lspace="0em" xref="S4.E10.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.4b"><apply id="S4.E10.m1.4.4.1.1.cmml" xref="S4.E10.m1.4.4.1"><eq id="S4.E10.m1.4.4.1.1.1.cmml" xref="S4.E10.m1.4.4.1.1.1"></eq><apply id="S4.E10.m1.4.4.1.1.2.cmml" xref="S4.E10.m1.4.4.1.1.2"><times id="S4.E10.m1.4.4.1.1.2.1.cmml" xref="S4.E10.m1.4.4.1.1.2.1"></times><ci id="S4.E10.m1.4.4.1.1.2.2.cmml" xref="S4.E10.m1.4.4.1.1.2.2">ℒ</ci><ci id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1">𝜃</ci></apply><apply id="S4.E10.m1.4.4.1.1.3.cmml" xref="S4.E10.m1.4.4.1.1.3"><plus id="S4.E10.m1.4.4.1.1.3.1.cmml" xref="S4.E10.m1.4.4.1.1.3.1"></plus><apply id="S4.E10.m1.4.4.1.1.3.2.cmml" xref="S4.E10.m1.4.4.1.1.3.2"><times id="S4.E10.m1.4.4.1.1.3.2.1.cmml" xref="S4.E10.m1.4.4.1.1.3.2.1"></times><apply id="S4.E10.m1.4.4.1.1.3.2.2.cmml" xref="S4.E10.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.1.1.3.2.2.1.cmml" xref="S4.E10.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S4.E10.m1.4.4.1.1.3.2.2.2.cmml" xref="S4.E10.m1.4.4.1.1.3.2.2.2">ℒ</ci><ci id="S4.E10.m1.4.4.1.1.3.2.2.3a.cmml" xref="S4.E10.m1.4.4.1.1.3.2.2.3"><mtext id="S4.E10.m1.4.4.1.1.3.2.2.3.cmml" mathsize="70%" xref="S4.E10.m1.4.4.1.1.3.2.2.3">PPO</mtext></ci></apply><ci id="S4.E10.m1.2.2.cmml" xref="S4.E10.m1.2.2">𝜃</ci></apply><apply id="S4.E10.m1.4.4.1.1.3.3.cmml" xref="S4.E10.m1.4.4.1.1.3.3"><times id="S4.E10.m1.4.4.1.1.3.3.1.cmml" xref="S4.E10.m1.4.4.1.1.3.3.1"></times><apply id="S4.E10.m1.4.4.1.1.3.3.2.cmml" xref="S4.E10.m1.4.4.1.1.3.3.2"><times id="S4.E10.m1.4.4.1.1.3.3.2.1.cmml" xref="S4.E10.m1.4.4.1.1.3.3.2.1"></times><ci id="S4.E10.m1.4.4.1.1.3.3.2.2.cmml" xref="S4.E10.m1.4.4.1.1.3.3.2.2">𝜇</ci><apply id="S4.E10.m1.4.4.1.1.3.3.2.3.cmml" xref="S4.E10.m1.4.4.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.1.1.3.3.2.3.1.cmml" xref="S4.E10.m1.4.4.1.1.3.3.2.3">subscript</csymbol><ci id="S4.E10.m1.4.4.1.1.3.3.2.3.2.cmml" xref="S4.E10.m1.4.4.1.1.3.3.2.3.2">ℒ</ci><ci id="S4.E10.m1.4.4.1.1.3.3.2.3.3a.cmml" xref="S4.E10.m1.4.4.1.1.3.3.2.3.3"><mtext id="S4.E10.m1.4.4.1.1.3.3.2.3.3.cmml" mathsize="70%" xref="S4.E10.m1.4.4.1.1.3.3.2.3.3">NLL</mtext></ci></apply></apply><ci id="S4.E10.m1.3.3.cmml" xref="S4.E10.m1.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.4c">\displaystyle\mathcal{L}(\theta)=\mathcal{L}_{\text{PPO}}(\theta)+\mu*\mathcal%
{L}_{\text{NLL}}(\theta).</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.4d">caligraphic_L ( italic_θ ) = caligraphic_L start_POSTSUBSCRIPT PPO end_POSTSUBSCRIPT ( italic_θ ) + italic_μ ∗ caligraphic_L start_POSTSUBSCRIPT NLL end_POSTSUBSCRIPT ( italic_θ ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p4.1.1">Group-Sampling</span> is used to sample discriminative positive and negative samples within the same prompt.
Given a fixed computational budget, there exist two primary approaches to allocating computational resources. The first approach utilizes as many prompts as possible, with each prompt sampled only once. The second approach reduces the number of distinct prompts per batch and redirects computational resources toward repeated generations. We observed that the latter approach yields marginally better performance, attributed to the richer contrastive signals it introduces, which enhance the policy model’s learning capability.

</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
</section>
<section class="ltx_section" id="S5" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Training Details</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.5">In this work we enhanced the model’s mathematical performance by introducing various modifications to the PPO algorithm based on the Qwen-32B model. These techniques are also effective for other reasoning tasks, such as code-related tasks. For the basic PPO, we used AdamW as the optimizer, setting the actor learning rate to <math alttext="1\times 10^{-6}" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">1</mn><mo id="S5.SS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.1.m1.1.1.1.cmml">×</mo><msup id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml"><mn id="S5.SS1.p1.1.m1.1.1.3.2" xref="S5.SS1.p1.1.m1.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.p1.1.m1.1.1.3.3" xref="S5.SS1.p1.1.m1.1.1.3.3.cmml"><mo id="S5.SS1.p1.1.m1.1.1.3.3a" xref="S5.SS1.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="S5.SS1.p1.1.m1.1.1.3.3.2" xref="S5.SS1.p1.1.m1.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><times id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></times><cn id="S5.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.2">1</cn><apply id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.1.m1.1.1.3.1.cmml" xref="S5.SS1.p1.1.m1.1.1.3">superscript</csymbol><cn id="S5.SS1.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.3.2">10</cn><apply id="S5.SS1.p1.1.m1.1.1.3.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3.3"><minus id="S5.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S5.SS1.p1.1.m1.1.1.3.3"></minus><cn id="S5.SS1.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">1\times 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">1 × 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math> and the critic learning rate to <math alttext="2\times 10^{-6}" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mn id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">2</mn><mo id="S5.SS1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.2.m2.1.1.1.cmml">×</mo><msup id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml"><mn id="S5.SS1.p1.2.m2.1.1.3.2" xref="S5.SS1.p1.2.m2.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.p1.2.m2.1.1.3.3" xref="S5.SS1.p1.2.m2.1.1.3.3.cmml"><mo id="S5.SS1.p1.2.m2.1.1.3.3a" xref="S5.SS1.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="S5.SS1.p1.2.m2.1.1.3.3.2" xref="S5.SS1.p1.2.m2.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><times id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></times><cn id="S5.SS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.2">2</cn><apply id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.1.3.1.cmml" xref="S5.SS1.p1.2.m2.1.1.3">superscript</csymbol><cn id="S5.SS1.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.3.2">10</cn><apply id="S5.SS1.p1.2.m2.1.1.3.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3.3"><minus id="S5.SS1.p1.2.m2.1.1.3.3.1.cmml" xref="S5.SS1.p1.2.m2.1.1.3.3"></minus><cn id="S5.SS1.p1.2.m2.1.1.3.3.2.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">2\times 10^{-6}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">2 × 10 start_POSTSUPERSCRIPT - 6 end_POSTSUPERSCRIPT</annotation></semantics></math>, as the critic needs to update faster to keep pace with policy changes. The learning rate employed a warmup-constant scheduler. The batch size was 8192 prompts, with each prompt sampled once, and each mini-batch size set to 512. The value network was initialized using a reward model, with the GAE <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><mi id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><ci id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">italic_λ</annotation></semantics></math> set to 0.95 and <math alttext="\gamma" class="ltx_Math" display="inline" id="S5.SS1.p1.4.m4.1"><semantics id="S5.SS1.p1.4.m4.1a"><mi id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><ci id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.4.m4.1d">italic_γ</annotation></semantics></math> set to 1.0. Sample-level loss was used, and the clip <math alttext="\epsilon" class="ltx_Math" display="inline" id="S5.SS1.p1.5.m5.1"><semantics id="S5.SS1.p1.5.m5.1a"><mi id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><ci id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.5.m5.1d">italic_ϵ</annotation></semantics></math> was set to 0.2.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">Compared to vanilla PPO, VAPO made the following parameter adjustments:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1">Implemented a value network warmup for 50 steps based on the reward model (RM) before initiating policy training.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1">Utilized decoupled GAE, where the value network learns from returns estimated with <math alttext="\lambda" class="ltx_Math" display="inline" id="S5.I1.i2.p1.1.m1.1"><semantics id="S5.I1.i2.p1.1.m1.1a"><mi id="S5.I1.i2.p1.1.m1.1.1" xref="S5.I1.i2.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.I1.i2.p1.1.m1.1b"><ci id="S5.I1.i2.p1.1.m1.1.1.cmml" xref="S5.I1.i2.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i2.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i2.p1.1.m1.1d">italic_λ</annotation></semantics></math>=1.0, while the policy network learns from advantages obtained using a separate lambda.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.2">Adaptively set the lambda for advantage estimation based on sequence length, following the formula: <math alttext="\lambda_{\text{policy}}=1-\frac{1}{\alpha l}" class="ltx_Math" display="inline" id="S5.I1.i3.p1.1.m1.1"><semantics id="S5.I1.i3.p1.1.m1.1a"><mrow id="S5.I1.i3.p1.1.m1.1.1" xref="S5.I1.i3.p1.1.m1.1.1.cmml"><msub id="S5.I1.i3.p1.1.m1.1.1.2" xref="S5.I1.i3.p1.1.m1.1.1.2.cmml"><mi id="S5.I1.i3.p1.1.m1.1.1.2.2" xref="S5.I1.i3.p1.1.m1.1.1.2.2.cmml">λ</mi><mtext id="S5.I1.i3.p1.1.m1.1.1.2.3" xref="S5.I1.i3.p1.1.m1.1.1.2.3a.cmml">policy</mtext></msub><mo id="S5.I1.i3.p1.1.m1.1.1.1" xref="S5.I1.i3.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S5.I1.i3.p1.1.m1.1.1.3" xref="S5.I1.i3.p1.1.m1.1.1.3.cmml"><mn id="S5.I1.i3.p1.1.m1.1.1.3.2" xref="S5.I1.i3.p1.1.m1.1.1.3.2.cmml">1</mn><mo id="S5.I1.i3.p1.1.m1.1.1.3.1" xref="S5.I1.i3.p1.1.m1.1.1.3.1.cmml">−</mo><mfrac id="S5.I1.i3.p1.1.m1.1.1.3.3" xref="S5.I1.i3.p1.1.m1.1.1.3.3.cmml"><mn id="S5.I1.i3.p1.1.m1.1.1.3.3.2" xref="S5.I1.i3.p1.1.m1.1.1.3.3.2.cmml">1</mn><mrow id="S5.I1.i3.p1.1.m1.1.1.3.3.3" xref="S5.I1.i3.p1.1.m1.1.1.3.3.3.cmml"><mi id="S5.I1.i3.p1.1.m1.1.1.3.3.3.2" xref="S5.I1.i3.p1.1.m1.1.1.3.3.3.2.cmml">α</mi><mo id="S5.I1.i3.p1.1.m1.1.1.3.3.3.1" xref="S5.I1.i3.p1.1.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S5.I1.i3.p1.1.m1.1.1.3.3.3.3" xref="S5.I1.i3.p1.1.m1.1.1.3.3.3.3.cmml">l</mi></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i3.p1.1.m1.1b"><apply id="S5.I1.i3.p1.1.m1.1.1.cmml" xref="S5.I1.i3.p1.1.m1.1.1"><eq id="S5.I1.i3.p1.1.m1.1.1.1.cmml" xref="S5.I1.i3.p1.1.m1.1.1.1"></eq><apply id="S5.I1.i3.p1.1.m1.1.1.2.cmml" xref="S5.I1.i3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.I1.i3.p1.1.m1.1.1.2.1.cmml" xref="S5.I1.i3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S5.I1.i3.p1.1.m1.1.1.2.2.cmml" xref="S5.I1.i3.p1.1.m1.1.1.2.2">𝜆</ci><ci id="S5.I1.i3.p1.1.m1.1.1.2.3a.cmml" xref="S5.I1.i3.p1.1.m1.1.1.2.3"><mtext id="S5.I1.i3.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S5.I1.i3.p1.1.m1.1.1.2.3">policy</mtext></ci></apply><apply id="S5.I1.i3.p1.1.m1.1.1.3.cmml" xref="S5.I1.i3.p1.1.m1.1.1.3"><minus id="S5.I1.i3.p1.1.m1.1.1.3.1.cmml" xref="S5.I1.i3.p1.1.m1.1.1.3.1"></minus><cn id="S5.I1.i3.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S5.I1.i3.p1.1.m1.1.1.3.2">1</cn><apply id="S5.I1.i3.p1.1.m1.1.1.3.3.cmml" xref="S5.I1.i3.p1.1.m1.1.1.3.3"><divide id="S5.I1.i3.p1.1.m1.1.1.3.3.1.cmml" xref="S5.I1.i3.p1.1.m1.1.1.3.3"></divide><cn id="S5.I1.i3.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="S5.I1.i3.p1.1.m1.1.1.3.3.2">1</cn><apply id="S5.I1.i3.p1.1.m1.1.1.3.3.3.cmml" xref="S5.I1.i3.p1.1.m1.1.1.3.3.3"><times id="S5.I1.i3.p1.1.m1.1.1.3.3.3.1.cmml" xref="S5.I1.i3.p1.1.m1.1.1.3.3.3.1"></times><ci id="S5.I1.i3.p1.1.m1.1.1.3.3.3.2.cmml" xref="S5.I1.i3.p1.1.m1.1.1.3.3.3.2">𝛼</ci><ci id="S5.I1.i3.p1.1.m1.1.1.3.3.3.3.cmml" xref="S5.I1.i3.p1.1.m1.1.1.3.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i3.p1.1.m1.1c">\lambda_{\text{policy}}=1-\frac{1}{\alpha l}</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i3.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT policy end_POSTSUBSCRIPT = 1 - divide start_ARG 1 end_ARG start_ARG italic_α italic_l end_ARG</annotation></semantics></math>, where <math alttext="\alpha=0.05" class="ltx_Math" display="inline" id="S5.I1.i3.p1.2.m2.1"><semantics id="S5.I1.i3.p1.2.m2.1a"><mrow id="S5.I1.i3.p1.2.m2.1.1" xref="S5.I1.i3.p1.2.m2.1.1.cmml"><mi id="S5.I1.i3.p1.2.m2.1.1.2" xref="S5.I1.i3.p1.2.m2.1.1.2.cmml">α</mi><mo id="S5.I1.i3.p1.2.m2.1.1.1" xref="S5.I1.i3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.I1.i3.p1.2.m2.1.1.3" xref="S5.I1.i3.p1.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.I1.i3.p1.2.m2.1b"><apply id="S5.I1.i3.p1.2.m2.1.1.cmml" xref="S5.I1.i3.p1.2.m2.1.1"><eq id="S5.I1.i3.p1.2.m2.1.1.1.cmml" xref="S5.I1.i3.p1.2.m2.1.1.1"></eq><ci id="S5.I1.i3.p1.2.m2.1.1.2.cmml" xref="S5.I1.i3.p1.2.m2.1.1.2">𝛼</ci><cn id="S5.I1.i3.p1.2.m2.1.1.3.cmml" type="float" xref="S5.I1.i3.p1.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i3.p1.2.m2.1c">\alpha=0.05</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i3.p1.2.m2.1d">italic_α = 0.05</annotation></semantics></math>.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.2">Adjusted the clip range to <math alttext="\epsilon_{\text{high}}" class="ltx_Math" display="inline" id="S5.I1.i4.p1.1.m1.1"><semantics id="S5.I1.i4.p1.1.m1.1a"><msub id="S5.I1.i4.p1.1.m1.1.1" xref="S5.I1.i4.p1.1.m1.1.1.cmml"><mi id="S5.I1.i4.p1.1.m1.1.1.2" xref="S5.I1.i4.p1.1.m1.1.1.2.cmml">ϵ</mi><mtext id="S5.I1.i4.p1.1.m1.1.1.3" xref="S5.I1.i4.p1.1.m1.1.1.3a.cmml">high</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.I1.i4.p1.1.m1.1b"><apply id="S5.I1.i4.p1.1.m1.1.1.cmml" xref="S5.I1.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.I1.i4.p1.1.m1.1.1.1.cmml" xref="S5.I1.i4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.I1.i4.p1.1.m1.1.1.2.cmml" xref="S5.I1.i4.p1.1.m1.1.1.2">italic-ϵ</ci><ci id="S5.I1.i4.p1.1.m1.1.1.3a.cmml" xref="S5.I1.i4.p1.1.m1.1.1.3"><mtext id="S5.I1.i4.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.I1.i4.p1.1.m1.1.1.3">high</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i4.p1.1.m1.1c">\epsilon_{\text{high}}</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i4.p1.1.m1.1d">italic_ϵ start_POSTSUBSCRIPT high end_POSTSUBSCRIPT</annotation></semantics></math>=0.28 and <math alttext="\epsilon_{\text{low}}" class="ltx_Math" display="inline" id="S5.I1.i4.p1.2.m2.1"><semantics id="S5.I1.i4.p1.2.m2.1a"><msub id="S5.I1.i4.p1.2.m2.1.1" xref="S5.I1.i4.p1.2.m2.1.1.cmml"><mi id="S5.I1.i4.p1.2.m2.1.1.2" xref="S5.I1.i4.p1.2.m2.1.1.2.cmml">ϵ</mi><mtext id="S5.I1.i4.p1.2.m2.1.1.3" xref="S5.I1.i4.p1.2.m2.1.1.3a.cmml">low</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.I1.i4.p1.2.m2.1b"><apply id="S5.I1.i4.p1.2.m2.1.1.cmml" xref="S5.I1.i4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.I1.i4.p1.2.m2.1.1.1.cmml" xref="S5.I1.i4.p1.2.m2.1.1">subscript</csymbol><ci id="S5.I1.i4.p1.2.m2.1.1.2.cmml" xref="S5.I1.i4.p1.2.m2.1.1.2">italic-ϵ</ci><ci id="S5.I1.i4.p1.2.m2.1.1.3a.cmml" xref="S5.I1.i4.p1.2.m2.1.1.3"><mtext id="S5.I1.i4.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S5.I1.i4.p1.2.m2.1.1.3">low</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I1.i4.p1.2.m2.1c">\epsilon_{\text{low}}</annotation><annotation encoding="application/x-llamapun" id="S5.I1.i4.p1.2.m2.1d">italic_ϵ start_POSTSUBSCRIPT low end_POSTSUBSCRIPT</annotation></semantics></math>=0.2.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="S5.I1.i5.p1">
<p class="ltx_p" id="S5.I1.i5.p1.1">Employed token-level policy gradient loss.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span>
<div class="ltx_para" id="S5.I1.i6.p1">
<p class="ltx_p" id="S5.I1.i6.p1.1">Added a positive-example language model (LM) loss to the policy gradient loss, with a weight of 0.1.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">7.</span>
<div class="ltx_para" id="S5.I1.i7.p1">
<p class="ltx_p" id="S5.I1.i7.p1.1">Used 512 prompts per sampling, with each prompt sampled 16 times, and set the mini-batch size to 512.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">We will also demonstrate the final effects of removing each of these seven modifications from VAPO individually. For the evaluation metric, we use the average pass rate of AIME24 over 32 times, with sampling parameters set to topp=0.7 and temperature=1.0.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Ablation Results</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.4.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S5.T1.5.2" style="font-size:90%;">Abalation results of <span class="ltx_text ltx_font_bold" id="S5.T1.5.2.1">VAPO</span></span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.2.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1"><math alttext="\textbf{AIME24}_{\text{avg@32}}" class="ltx_Math" display="inline" id="S5.T1.1.1.1.m1.1"><semantics id="S5.T1.1.1.1.m1.1a"><msub id="S5.T1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S5.T1.1.1.1.m1.1.1.2" xref="S5.T1.1.1.1.m1.1.1.2a.cmml">AIME24</mtext><mtext id="S5.T1.1.1.1.m1.1.1.3" xref="S5.T1.1.1.1.m1.1.1.3a.cmml">avg@32</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><apply id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.1.1.1.m1.1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1">subscript</csymbol><ci id="S5.T1.1.1.1.m1.1.1.2a.cmml" xref="S5.T1.1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S5.T1.1.1.1.m1.1.1.2.cmml" xref="S5.T1.1.1.1.m1.1.1.2">AIME24</mtext></ci><ci id="S5.T1.1.1.1.m1.1.1.3a.cmml" xref="S5.T1.1.1.1.m1.1.1.3"><mtext id="S5.T1.1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.T1.1.1.1.m1.1.1.3">avg@32</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">\textbf{AIME24}_{\text{avg@32}}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.m1.1d">AIME24 start_POSTSUBSCRIPT avg@32 end_POSTSUBSCRIPT</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.2.1.1">Vanilla PPO</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.2">5</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.3.2">
<td class="ltx_td ltx_align_left" id="S5.T1.1.3.2.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.3.2.1.1">DeepSeek-R1-Zero-Qwen-32B</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.2">47</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.4.3">
<td class="ltx_td ltx_align_left" id="S5.T1.1.4.3.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.4.3.1.1">DAPO</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.3.2">50</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T1.1.5.4.1">VAPO w/o Value-Pretraining</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.5.4.2">11</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.6.5">
<td class="ltx_td ltx_align_left" id="S5.T1.1.6.5.1">VAPO w/o Decoupled-GAE</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.6.5.2">33</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.7.6">
<td class="ltx_td ltx_align_left" id="S5.T1.1.7.6.1">VAPO w/o Length-adaptive GAE</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.7.6.2">45</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.8.7">
<td class="ltx_td ltx_align_left" id="S5.T1.1.8.7.1">VAPO w/o Clip-Higher</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.8.7.2">46</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.9.8">
<td class="ltx_td ltx_align_left" id="S5.T1.1.9.8.1">VAPO w/o Token-level Loss</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.9.8.2">53</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.10.9">
<td class="ltx_td ltx_align_left" id="S5.T1.1.10.9.1">VAPO w/o Positive Example LM Loss</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.10.9.2">54</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.11.10">
<td class="ltx_td ltx_align_left" id="S5.T1.1.11.10.1">VAPO w/o Group-Sampling</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.11.10.2">55</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.12.11">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T1.1.12.11.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.12.11.1.1">VAPO</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.12.11.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.12.11.2.1">60</span></td>
</tr>
</tbody>
</table>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">On Qwen-32b, DeepSeek R1 using GRPO achieves 47 points on AIME24, while DAPO reaches 50 points with 50% of the update steps. In Figure&nbsp;<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S0.F1" title="Figure 1 ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_tag">1</span></a>, our proposed VAPO matches this performance using only 60% of DAPO’s steps and achieves a new SOTA score of 60.4 within just 5,000 steps, demonstrating VAPO’s efficiency. Additionally, VAPO maintains stable entropy—neither collapsing nor becoming excessively high—and consistently achieves peak scores of 60-61 across three repeated experiments, highlighting the reliability of our algorithm.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S5.T1" title="In 5.2 Ablation Results ‣ 5 Experiments ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_tag">Table</span>&nbsp;<span class="ltx_text ltx_ref_tag">1</span></a> systematically presents our experimental results. The Vanilla PPO method, hindered by value model learning collapse, only achieves 5 points in the later stages of training, characterized by a drastic reduction in response length and the model directly answering questions without reasoning.
Our VAPO method finally achieves 60 points, which is a significant improvement. We further validated the effectiveness of the seven proposed modifications by ablating them individually:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ol class="ltx_enumerate" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1">Without Value-Pretraining, the model experiences the same collapse as Vanilla PPO during training, converging to a maximum of approximately 11 points.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1">Removing the decoupled GAE causes reward signals to exponentially decay during backpropagation, preventing the model from fully optimizing long-form responses and leading to a 27-point drop.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S5.I2.i3.p1">
<p class="ltx_p" id="S5.I2.i3.p1.1">Adaptive GAE balances optimization for both short and long responses, yielding a 15-point improvement.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S5.I2.i4.p1">
<p class="ltx_p" id="S5.I2.i4.p1.1">Clip higher encourages thorough exploration and exploitation; its removal limited the model’s maximum convergence to 46 points.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="S5.I2.i5.p1">
<p class="ltx_p" id="S5.I2.i5.p1.1">Token-level loss implicitly increased the weight of long responses, contributing to a 7-point gain.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span>
<div class="ltx_para" id="S5.I2.i6.p1">
<p class="ltx_p" id="S5.I2.i6.p1.1">Incorporating positive-example LM loss boosted the model by nearly 6 points.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I2.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">7.</span>
<div class="ltx_para" id="S5.I2.i7.p1">
<p class="ltx_p" id="S5.I2.i7.p1.1">Using Group-Sampling to generate fewer prompts but with more repetitions also resulted in a 5-point improvement.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Training Dynamics</h3><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<figure class="ltx_figure" id="S5.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="399" id="S5.F2.sf1.g1" src="./vapo_files/length.png" width="598">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S5.F2.sf1.3.2" style="font-size:90%;">Mean response length.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="399" id="S5.F2.sf2.g1" src="./vapo_files/reward.png" width="598">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S5.F2.sf2.3.2" style="font-size:90%;">Reward score.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="399" id="S5.F2.sf3.g1" src="./vapo_files/entropy.png" width="598">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S5.F2.sf3.3.2" style="font-size:90%;">Generation entropy.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S5.F2.3.2" style="font-size:90%;">VAPO’s metric curves for response length, reward score, and generation entropy.</span></figcaption>
</figure><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">The curves generated during RL training provide real-time insights into training stability, and comparisons between different curves can highlight algorithmic differences. It is generally believed that smoother changes and faster growth are the desirable characteristics of these curves. Through a comparison of the training processes of VAPO and DAPO, we made the following observations:</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_itemize" id="S5.I3">
<li class="ltx_item" id="S5.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i1.p1">
<p class="ltx_p" id="S5.I3.i1.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S5.F2" title="In 5.3 Training Dynamics ‣ 5 Experiments ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">2</span></a> shows that VAPO’s training curve is smoother than DAPO’s, indicating more stable algorithmic optimization in VAPO.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i2.p1">
<p class="ltx_p" id="S5.I3.i2.p1.1">As depicted in <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S5.F2.sf1" title="In Figure 2 ‣ 5.3 Training Dynamics ‣ 5 Experiments ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">2(a)</span></a>, VAPO exhibits superior length scaling compared to DAPO. In modern contexts, better length scaling is widely recognized as a marker of improved model performance, as it enhances the model’s generalization capabilities.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i3.p1">
<p class="ltx_p" id="S5.I3.i3.p1.1"><a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S5.F2.sf2" title="In Figure 2 ‣ 5.3 Training Dynamics ‣ 5 Experiments ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">2(b)</span></a> demonstrates that VAPO’s score grows faster than DAPO’s, as the value model provides the model with more granular signals to accelerate optimization.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
<li class="ltx_item" id="S5.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i4.p1">
<p class="ltx_p" id="S5.I3.i4.p1.1">According to <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#S5.F2.sf3" title="In Figure 2 ‣ 5.3 Training Dynamics ‣ 5 Experiments ‣ VAPO: Efficient and Reliable Reinforcement Learning for Advanced Reasoning Tasks"><span class="ltx_text ltx_ref_tag">Figure</span>&nbsp;<span class="ltx_text ltx_ref_tag">2(c)</span></a>, VAPO’s entropy drops lower than DAPO’s in the later stages of training. This is two sides of the coin: on one hand, it may hinder exploration, but on the other hand, it improves the model stability. From VAPO’s final results, the lower entropy has minimal negative impact on performance, while the reproducibility and stability proves highly advantageous.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_section" id="S6" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Work</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">OpenAI O1 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib16" title="">16</a>]</cite> introduces a profound paradigm shift in LLMs, characterized by extended reasoning before delivering a final response&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib5" title="">5</a>]</cite>.
DeepSeek R1 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib6" title="">6</a>]</cite> open-sources both its training algorithm (the value-model-free GRPO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib22" title="">22</a>]</cite>) and its model weights, which are comparable in performance to O1. DAPO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib29" title="">29</a>]</cite> identifies previously undisclosed challenges such as entropy collapse encountered during the scaling of value-model-free LLM RL, and proposes four effective techniques to overcome these challenges, achieving SOTA industry-level performance. Recently, Dr. GRPO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib12" title="">12</a>]</cite> removes both the length and std normalization terms in GRPO.
On the other hand, ORZ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2504.05118v3#bib.bib9" title="">9</a>]</cite> follows PPO and utilizes a value model for advantage estimation, proposing Monte Carlo estimation instead of Generalized Advantage Estimation. However, they could just achieves a comparable performance to value-model-free method like GRPO and DAPO. In this paper, we also follow the value-model-based approach and propose VAPO, which outperforms the SOTA value-model-free algorithm DAPO.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
</section>
<section class="ltx_section" id="S7" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this paper, we propose an algorithm named VAPO, which leveraging the Qwen2.5-32B model, achieves the SOTA performance on the AIME24 benchmark. By introducing seven novel techniques atop PPO, which focus on refining value learning and balancing exploration, our value-model-based approach outperforms contemporary value-model-free methods like GRPO and DAPO. The work provides a robust framework for advancing large language models in reasoning-intensive tasks.</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_section" id="Sx1" lang="en">
<h2 class="ltx_title ltx_title_section">Contributions</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1"><span class="ltx_text ltx_font_bold" id="Sx1.p1.1.1">Project Lead</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p2">
<p class="ltx_p" id="Sx1.p2.1">Yu Yue<sup class="ltx_sup" id="Sx1.p2.1.1"><span class="ltx_text ltx_font_italic" id="Sx1.p2.1.1.1">1</span></sup></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p3">
<p class="ltx_p" id="Sx1.p3.1"><span class="ltx_text ltx_font_bold" id="Sx1.p3.1.1">Algorithm</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p4">
<p class="ltx_p" id="Sx1.p4.12">Yu Yue<sup class="ltx_sup" id="Sx1.p4.12.1"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.1.1">1</span></sup>, Yufeng Yuan<sup class="ltx_sup" id="Sx1.p4.12.2"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.2.1">1</span></sup>, Qiying Yu<sup class="ltx_sup" id="Sx1.p4.12.3"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.3.1">1,2</span></sup>, Xiaochen Zuo<sup class="ltx_sup" id="Sx1.p4.12.4"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.4.1">1</span></sup>, Ruofei Zhu<sup class="ltx_sup" id="Sx1.p4.12.5"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.5.1">1</span></sup>, Wenyuan Xu<sup class="ltx_sup" id="Sx1.p4.12.6"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.6.1">1</span></sup>, Jiaze Chen<sup class="ltx_sup" id="Sx1.p4.12.7"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.7.1">1</span></sup>, Chengyi Wang<sup class="ltx_sup" id="Sx1.p4.12.8"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.8.1">1</span></sup>, TianTian Fan<sup class="ltx_sup" id="Sx1.p4.12.9"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.9.1">1</span></sup>, Zhengyin Du<sup class="ltx_sup" id="Sx1.p4.12.10"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.10.1">1</span></sup>, Xiangpeng Wei<sup class="ltx_sup" id="Sx1.p4.12.11"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.11.1">1</span></sup>, Xiangyu Yu<sup class="ltx_sup" id="Sx1.p4.12.12"><span class="ltx_text ltx_font_italic" id="Sx1.p4.12.12.1">1</span></sup></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p5">
<p class="ltx_p" id="Sx1.p5.1"><span class="ltx_text ltx_font_bold" id="Sx1.p5.1.1">Infrastructure<sup class="ltx_sup" id="Sx1.p5.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="Sx1.p5.1.1.1.1">∗</span></sup></span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p6">
<p class="ltx_p" id="Sx1.p6.11">Gaohong Liu<sup class="ltx_sup" id="Sx1.p6.11.1"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.1.1">1</span></sup>, Juncai Liu<sup class="ltx_sup" id="Sx1.p6.11.2"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.2.1">1</span></sup>, Lingjun Liu<sup class="ltx_sup" id="Sx1.p6.11.3"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.3.1">1</span></sup>, Haibin Lin<sup class="ltx_sup" id="Sx1.p6.11.4"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.4.1">1</span></sup>, Zhiqi Lin<sup class="ltx_sup" id="Sx1.p6.11.5"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.5.1">1</span></sup>, Bole Ma<sup class="ltx_sup" id="Sx1.p6.11.6"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.6.1">1</span></sup>, Chi Zhang<sup class="ltx_sup" id="Sx1.p6.11.7"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.7.1">1</span></sup>, Mofan Zhang<sup class="ltx_sup" id="Sx1.p6.11.8"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.8.1">1</span></sup>, Wang Zhang<sup class="ltx_sup" id="Sx1.p6.11.9"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.9.1">1</span></sup>, Hang Zhu<sup class="ltx_sup" id="Sx1.p6.11.10"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.10.1">1</span></sup>, Ru Zhang<sup class="ltx_sup" id="Sx1.p6.11.11"><span class="ltx_text ltx_font_italic" id="Sx1.p6.11.11.1">1</span></sup></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p7">
<p class="ltx_p" id="Sx1.p7.1"><sup class="ltx_sup" id="Sx1.p7.1.1"><span class="ltx_text ltx_font_italic" id="Sx1.p7.1.1.1">∗</span></sup>Last-Name in Alphabetical Order</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p8">
<p class="ltx_p" id="Sx1.p8.1"><span class="ltx_text ltx_font_bold" id="Sx1.p8.1.1">Supervision</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p9">
<p class="ltx_p" id="Sx1.p9.4">Xin Liu<sup class="ltx_sup" id="Sx1.p9.4.1"><span class="ltx_text ltx_font_italic" id="Sx1.p9.4.1.1">1</span></sup>, Mingxuan Wang<sup class="ltx_sup" id="Sx1.p9.4.2"><span class="ltx_text ltx_font_italic" id="Sx1.p9.4.2.1">1</span></sup>, Yonghui Wu<sup class="ltx_sup" id="Sx1.p9.4.3"><span class="ltx_text ltx_font_italic" id="Sx1.p9.4.3.1">1</span></sup>, Lin Yan<sup class="ltx_sup" id="Sx1.p9.4.4"><span class="ltx_text ltx_font_italic" id="Sx1.p9.4.4.1">1</span></sup></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p10">
<p class="ltx_p" id="Sx1.p10.1"><span class="ltx_text ltx_font_bold" id="Sx1.p10.1.1">Affiliation</span></p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p11">
<p class="ltx_p" id="Sx1.p11.1"><sup class="ltx_sup" id="Sx1.p11.1.1">1</sup> ByteDance Seed</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_para" id="Sx1.p12">
<p class="ltx_p" id="Sx1.p12.1"><sup class="ltx_sup" id="Sx1.p12.1.1">2</sup> SIA-Lab of Tsinghua AIR and ByteDance Seed</p><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib" lang="en">
<h2 class="ltx_title ltx_title_bibliography">References</h2><button class="sr-only button" style="display: none;">Report issue for preceding element</button>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ahmadian et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Arash Ahmadian, Chris Cremer, Matthias Gallé, Marzieh Fadaee, Julia Kreutzer, Olivier Pietquin, Ahmet Üstün, and Sara Hooker.

</span>
<span class="ltx_bibblock">Back to basics: Revisiting reinforce style optimization for learning from human feedback in llms, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.14740" title="">https://arxiv.org/abs/2402.14740</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anthropic [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Anthropic.

</span>
<span class="ltx_bibblock">Claude 3.5 sonnet, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.anthropic.com/news/claude-3-5-sonnet" title="">https://www.anthropic.com/news/claude-3-5-sonnet</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et&nbsp;al. [2020]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared&nbsp;D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et&nbsp;al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances in neural information processing systems</em>, 33:1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chowdhery et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aakanksha Chowdhery, Sharan Narang, Jacob Devlin, Maarten Bosma, Gaurav Mishra, Adam Roberts, Paul Barham, Hyung&nbsp;Won Chung, Charles Sutton, Sebastian Gehrmann, et&nbsp;al.

</span>
<span class="ltx_bibblock">Palm: Scaling language modeling with pathways.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Journal of Machine Learning Research</em>, 24(240):1–113, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">DeepMind [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Google DeepMind.

</span>
<span class="ltx_bibblock">Gemini 2.0 flash thinking, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://deepmind.google/technologies/gemini/flash-thinking/" title="">https://deepmind.google/technologies/gemini/flash-thinking/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">DeepSeek-AI [2025]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
DeepSeek-AI.

</span>
<span class="ltx_bibblock">Deepseek-r1: Incentivizing reasoning capability in llms via reinforcement learning, 2025.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2501.12948" title="">https://arxiv.org/abs/2501.12948</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Good and Fletcher [1981]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Ron Good and Harold&nbsp;J. Fletcher.

</span>
<span class="ltx_bibblock">Reporting explained variance.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Journal of Research in Science Teaching</em>, 18(1):1–7, 1981.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https://arxiv.org/doi.org/https://doi.org/10.1002/tea.3660180102" title="">https://doi.org/10.1002/tea.3660180102</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/tea.3660180102" title="">https://onlinelibrary.wiley.com/doi/abs/10.1002/tea.3660180102</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu [2025]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jian Hu.

</span>
<span class="ltx_bibblock">Reinforce++: A simple and efficient approach for aligning large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2501.03262</em>, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et&nbsp;al. [2025]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jingcheng Hu, Yinmin Zhang, Qi&nbsp;Han, Daxin Jiang, Xiangyu Zhang, and Heung-Yeung Shum.

</span>
<span class="ltx_bibblock">Open-reasoner-zero: An open source approach to scaling up reinforcement learning on the base model, 2025.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2503.24290" title="">https://arxiv.org/abs/2503.24290</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kool et&nbsp;al. [2019]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wouter Kool, Herke van Hoof, and Max Welling.

</span>
<span class="ltx_bibblock">Buy 4 REINFORCE samples, get a baseline for free!

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Deep Reinforcement Learning Meets Structured Prediction, ICLR 2019 Workshop, New Orleans, Louisiana, United States, May 6, 2019</em>. OpenReview.net, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=r1lgTGL5DE" title="">https://openreview.net/forum?id=r1lgTGL5DE</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Aixin Liu, Bei Feng, Bing Xue, Bingxuan Wang, Bochao Wu, Chengda Lu, Chenggang Zhao, Chengqi Deng, Chenyu Zhang, Chong Ruan, et&nbsp;al.

</span>
<span class="ltx_bibblock">Deepseek-v3 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2412.19437</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et&nbsp;al. [2025]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zichen Liu, Changyu Chen, Wenjun Li, Penghui Qi, Tianyu Pang, Chao Du, Wee&nbsp;Sun Lee, and Min Lin.

</span>
<span class="ltx_bibblock">Understanding r1-zero-like training: A critical perspective, 2025.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2503.20783" title="">https://arxiv.org/abs/2503.20783</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mei et&nbsp;al. [2025]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhiyu Mei, Wei Fu, Kaiwei Li, Guangju Wang, Huanchen Zhang, and Yi&nbsp;Wu.

</span>
<span class="ltx_bibblock">Real: Efficient rlhf training of large language models with parameter reallocation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the Eighth Conference on Machine Learning and Systems, MLSys 2025, Santa Clara, CA, USA, May 12-15, 2025</em>. mlsys.org, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et&nbsp;al. [2018]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Junhyuk Oh, Yijie Guo, Satinder Singh, and Honglak Lee.

</span>
<span class="ltx_bibblock">Self-imitation learning.

</span>
<span class="ltx_bibblock">In Jennifer Dy and Andreas Krause, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 35th International Conference on Machine Learning</em>, volume&nbsp;80 of <em class="ltx_emph ltx_font_italic" id="bib.bib14.2.2">Proceedings of Machine Learning Research</em>, pages 3878–3887. PMLR, 10–15 Jul 2018.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v80/oh18b.html" title="">https://proceedings.mlr.press/v80/oh18b.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">GPT4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Learning to reason with llms, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/index/learning-to-reason-with-llms/" title="">https://openai.com/index/learning-to-reason-with-llms/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et&nbsp;al. [2022a]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu&nbsp;Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Advances in neural information processing systems</em>, 35:27730–27744, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et&nbsp;al. [2022b]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu&nbsp;Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et&nbsp;al.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Advances in neural information processing systems</em>, 35:27730–27744, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qwen [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qwen.

</span>
<span class="ltx_bibblock">Qwq-32b: Embracing the power of reinforcement learning, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://qwenlm.github.io/blog/qwq-32b/" title="">https://qwenlm.github.io/blog/qwq-32b/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et&nbsp;al. [2015]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
John Schulman, Philipp Moritz, Sergey Levine, Michael Jordan, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">High-dimensional continuous control using generalized advantage estimation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:1506.02438</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et&nbsp;al. [2017]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:1707.06347</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et&nbsp;al. [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Zhihong Shao, Peiyi Wang, Qihao Zhu, Runxin Xu, Junxiao Song, Mingchuan Zhang, YK&nbsp;Li, Yu&nbsp;Wu, and Daya Guo.

</span>
<span class="ltx_bibblock">Deepseekmath: Pushing the limits of mathematical reasoning in open language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2402.03300</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et&nbsp;al. [2025]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Wei Shen, Guanlin Liu, Zheng Wu, Ruofei Zhu, Qingping Yang, Chao Xin, Yu&nbsp;Yue, and Lin Yan.

</span>
<span class="ltx_bibblock">Exploring data scaling trends and effects in reinforcement learning from human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2503.22230</em>, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutton et&nbsp;al. [1998]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Richard&nbsp;S Sutton, Andrew&nbsp;G Barto, et&nbsp;al.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Reinforcement learning: An introduction</em>, volume&nbsp;1.

</span>
<span class="ltx_bibblock">MIT press Cambridge, 1998.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Team et&nbsp;al. [2023]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Gemini Team, Rohan Anil, Sebastian Borgeaud, Yonghui Wu, Jean-Baptiste Alayrac, Jiahui Yu, Radu Soricut, Johan Schalkwyk, Andrew&nbsp;M Dai, Anja Hauth, et&nbsp;al.

</span>
<span class="ltx_bibblock">Gemini: a family of highly capable multimodal models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2312.11805</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Team et&nbsp;al. [2025]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Kimi Team, Angang Du, Bofei Gao, Bowei Xing, Changjiu Jiang, Cheng Chen, Cheng Li, Chenjun Xiao, Chenzhuang Du, Chonghua Liao, et&nbsp;al.

</span>
<span class="ltx_bibblock">Kimi k1. 5: Scaling reinforcement learning with llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2501.12599</em>, 2025.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et&nbsp;al. [2022]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Brian Ichter, Fei Xia, Ed&nbsp;H. Chi, Quoc&nbsp;V. Le, and Denny Zhou.

</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in large language models.

</span>
<span class="ltx_bibblock">In Sanmi Koyejo, S.&nbsp;Mohamed, A.&nbsp;Agarwal, Danielle Belgrave, K.&nbsp;Cho, and A.&nbsp;Oh, editors, <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Advances in Neural Information Processing Systems 35: Annual Conference on Neural Information Processing Systems 2022, NeurIPS 2022, New Orleans, LA, USA, November 28 - December 9, 2022</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">XAI [2024]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
XAI.

</span>
<span class="ltx_bibblock">Grok 3 beta — the age of reasoning agents, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://x.ai/news/grok-3" title="">https://x.ai/news/grok-3</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et&nbsp;al. [2025]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Qiying Yu, Zheng Zhang, Ruofei Zhu, Yufeng Yuan, Xiaochen Zuo, Yu&nbsp;Yue, Tiantian Fan, Gaohong Liu, Lingjun Liu, Xin Liu, Haibin Lin, Zhiqi Lin, Bole Ma, Guangming Sheng, Yuxuan Tong, Chi Zhang, Mofan Zhang, Wang Zhang, Hang Zhu, Jinhua Zhu, Jiaze Chen, Jiangjie Chen, Chengyi Wang, Hongli Yu, Weinan Dai, Yuxuan Song, Xiangpeng Wei, Hao Zhou, Jingjing Liu, Wei-Ying Ma, Ya-Qin Zhang, Lin Yan, Mu&nbsp;Qiao, Yonghui Wu, and Mingxuan Wang.

</span>
<span class="ltx_bibblock">Dapo: An open-source llm reinforcement learning system at scale, 2025.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2503.14476" title="">https://arxiv.org/abs/2503.14476</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et&nbsp;al. [2025]<button class="back-to-reference-btn" aria-label="Back to the article">↑</button></span>
<span class="ltx_bibblock">
Yufeng Yuan, Yu&nbsp;Yue, Ruofei Zhu, Tiantian Fan, and Lin Yan.

</span>
<span class="ltx_bibblock">What’s behind ppo’s collapse in long-cot? value optimization holds the secret, 2025.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2503.01491" title="">https://arxiv.org/abs/2503.01491</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>

</div>


<button type="button" class="btn btn-primary hover-rp-button" id="openForm">Report Issue</button><div class="modal" id="myForm" role="dialog" aria-labelledby="modal-title"><div class="modal-dialog"><form class="modal-content" id="myFormContent" enctype="multipart/form-data"><div class="modal-header" id="modal-header"><h5 class="modal-title">Report Github Issue</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><label for="form_title" id="modalTitle">Title:</label><input class="form-control" id="form_title" name="form_title" required="required" placeholder="Enter title"><label for="description" id="selectedTextModalDescription" style="display: none;">Content selection saved. Describe the issue below:</label><label for="description" id="nomralModalDescription">Description:</label><textarea class="form-control" id="description" name="description" required="required" style="height: 80px;" maxlength="500" placeholder="500 characters maximum"></textarea></div><div class="modal-footer d-flex justify-content-end"><button type="submit" class="sr-only button" id="modal-submit-sr">Submit without Github</button><button type="submit" class="btn btn-primary" id="modal-submit">Submit in Github</button></div></form></div></div><button id="small-report-button" type="button" class="btn btn-secondary btn-sm" style="background-color: rgb(179, 27, 27); position: fixed;">Report Issue for Selection</button><div class="ltx_page_footer">
        <div class="ltx_page_logo">
            Generated by
            <a href="https://math.nist.gov/~BMiller/LaTeXML/" class="ltx_LaTeXML_logo">
                <span style="letter-spacing: -0.2em; margin-right: 0.1em;">
                    L
                    <span style="font-size: 70%; position: relative; bottom: 2.2pt;">A</span>
                    T
                    <span style="position: relative; bottom: -0.4ex;">E</span>
                </span>
                <span class="ltx_font_smallcaps">xml</span>
                <img alt="[LOGO]" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==">
            </a>
        </div></div><footer id="footer" class="ltx_document">
        <div class="keyboard-glossary">
            <h2>Instructions for reporting errors</h2>
            <p>We are continuing to improve HTML versions of papers, and your feedback helps enhance accessibility and mobile support. To report errors in the HTML that will help us improve conversion and rendering, choose any of the methods listed below:</p>
            <ul>
                <li>Click the "Report Issue" button.</li>
                <li>Open a report feedback form via keyboard, use "<strong>Ctrl + ?</strong>".</li>
                <li>Make a text selection and click the "Report Issue for Selection" button near your cursor.</li>
                <li class="sr-only">You can use Alt+Y to toggle on and Alt+Shift+Y to toggle off accessible reporting links at each section.</li>
            </ul>
            <p>Our team has already identified <a class="ltx_ref" href="https://github.com/arXiv/html_feedback/issues" target="_blank">the following issues</a>. We appreciate your time reviewing and reporting rendering errors we may not have found yet. Your efforts will help us improve the HTML versions for all readers, because disability should not be a barrier to accessing research. Thank you for your continued support in championing open access for all.</p>
            <p>Have a free development cycle? Help support accessibility at arXiv! Our collaborators at LaTeXML maintain a <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/wiki/Porting-LaTeX-packages-for-LaTeXML" target="_blank">list of packages that need conversion</a>, and welcome <a class="ltx_ref" href="https://github.com/brucemiller/LaTeXML/issues" target="_blank">developer contributions</a>.</p>
        </div>
    </footer></body></html>